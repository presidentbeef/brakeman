
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/20/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/07/31/brakeman-1-dot-7-0-released">Brakeman 1.7.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-07-31 17:44:00 -0700" pubdate  updated >2012-07-31 17:44:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release includes improvements to Rails 3 route processing, better performance, several bug fixes, and more!</p>

<p><em>Changes since 1.6.2</em>:</p>

<ul>
  <li>Add check for CVE-2012-3424</li>
  <li>Link report types to descriptions on website</li>
  <li>Report errors raised while running check</li>
  <li>Improve processing of Rails 3 routes</li>
  <li>Improve file access check</li>
  <li>Avoid warning on non-ActiveModel models</li>
  <li>Fix how <code class="language-plaintext highlighter-rouge">params[:x] ||=</code> is handled</li>
  <li>Treat user input in <code class="language-plaintext highlighter-rouge">or</code> expressions as immediate values</li>
  <li>Fix processing of negative array indexes</li>
  <li>Fix “empty char-class” error</li>
  <li>Speed improvements by stripping down SexpProcessor</li>
  <li>Add line breaks to truncated table rows</li>
</ul>

<h3 id="check-for-http-auth-digest-dos">Check for HTTP Auth Digest DoS</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/vxJjrc15qYM/discussion">CVE-2012-3424</a>, a potential denial of service vulnerability in how Rails handles HTTP authentication digest parameters, was recently announced. It affects Rails 3.x, and is fixed in 3.0.16, 3.1.7, and 3.2.7.</p>

<p>Brakeman will generate a warning for the Rails versions affected, but will only report a high confidence warning if <code class="language-plaintext highlighter-rouge">authenticate_or_request_with_http_digest</code> or <code class="language-plaintext highlighter-rouge">authenticate_with_http_digest</code> methods are called.</p>

<h3 id="links-to-warning-information">Links to Warning Information</h3>

<p>HTML reports now link warning types to descriptions on the Brakeman website. JSON reports will also include the link information. Due to this change, it is not possible to compare JSON reports from previous versions using the <code class="language-plaintext highlighter-rouge">--compare</code> option.</p>

<p>Suggestions and <a href="https://github.com/presidentbeef/brakeman-site">pull requests</a> for improving the documention are welcome!</p>

<h3 id="report-check-errors">Report Check Errors</h3>

<p>Previously, errors encounted while running checks were not included in reports. This has been fixed.</p>

<h3 id="better-rails-3-route-processing">Better Rails 3 Route Processing</h3>

<p>Even the simple information Brakeman uses (which methods are routes) is difficult to extract from Rails 3 routes due to all the different options it offers. This release should decrease the number of “Error while processing routes” messages that come up.</p>

<p>See <a href="https://github.com/presidentbeef/brakeman/pull/116">this pull request</a> for more information about specific fixes.</p>

<h3 id="improved-file-access-check">Improved File Access Check</h3>

<p>The check for user input in file access calls has been improved so the confidence of the warnings will vary according to how the user input is used, like most other checks.</p>

<p>Additionally, the check will now respect the <code class="language-plaintext highlighter-rouge">--report-direct</code> option.</p>

<h3 id="no-sqli-warnings-for-non-activemodel">No SQLi Warnings for Non-ActiveModel</h3>

<p>Models which do not inherit from <code class="language-plaintext highlighter-rouge">ActiveRecord::Base</code> will no longer be reported in SQL injection warnings.</p>

<h3 id="default-assignment-to-params">Default Assignment to <code class="language-plaintext highlighter-rouge">params</code></h3>

<p>Normally, when Brakeman processes an assignment like <code class="language-plaintext highlighter-rouge">x ||= y</code>, it will assign <code class="language-plaintext highlighter-rouge">y</code> to <code class="language-plaintext highlighter-rouge">x</code> if no previous value is found for <code class="language-plaintext highlighter-rouge">x</code>.</p>

<p>However, in this case:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>params[:x] ||= y
</code></pre></div></div>

<p>The information that the left hand side is a <code class="language-plaintext highlighter-rouge">params</code> hash is lost.</p>

<p>This has been changed so default assignment to a <code class="language-plaintext highlighter-rouge">params</code> hash will not replace the entire value, but will handle it as <code class="language-plaintext highlighter-rouge">params[:x] || y</code>.</p>

<h3 id="user-input-in-or-expressions">User Input in <code class="language-plaintext highlighter-rouge">or</code> Expressions</h3>

<p>Previously, unescaped output like</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= params[:x] || z %&gt;
</code></pre></div></div>

<p>would have been reported as a weak confidence warning. This has been changed so that any user input in an <code class="language-plaintext highlighter-rouge">or</code> expression will be considered immediate (versus “indirect”) output and will likely result in high confidence warnings.</p>

<h3 id="speed-improvements">Speed Improvements</h3>

<p>Scan times should decrease by 15-25% with this release. This is mostly due to stripping unused bits out of SexpProcessor.</p>

<h3 id="bug-fixes">Bug Fixes</h3>

<p>Besides errors raised when processing Rails 3 routes, the <code class="language-plaintext highlighter-rouge">Result must be a Sexp, was Symbol::array</code> and <code class="language-plaintext highlighter-rouge">empty char-class</code> errors should be resolved now.</p>

<p>Please report any errors raised when performing scans, as they are usually bugs.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/06/12/brakeman-1-dot-6-2-released">Brakeman 1.6.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-06-12 17:07:00 -0700" pubdate  updated >2012-06-12 17:07:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>Besides checks for the latest CVEs, this release includes a slightly improved redirect check, noiser output with <code class="language-plaintext highlighter-rouge">--compare</code>, and better handling of <code class="language-plaintext highlighter-rouge">before_filter</code>.</p>

<p><em>Changes since 1.6.1</em>:</p>

<ul>
  <li>Add checks for CVE-2012-2660, CVE-2012-2661, CVE-2012-2694, CVE-2012-2695 (Dave Worth)</li>
  <li>Avoid warning when redirecting to a model instance</li>
  <li>Raise confidence level for model attributes in redirects</li>
  <li>Add <code class="language-plaintext highlighter-rouge">request.parameters</code> as a parameters hash</li>
  <li>Return non-zero exit code when missing dependencies</li>
  <li>Fix <code class="language-plaintext highlighter-rouge">before_filter :except</code> logic</li>
  <li>Only accept symbol literals as before_filter names</li>
  <li>Cache before_filter lookups</li>
  <li>Turn off quiet mode by default for <code class="language-plaintext highlighter-rouge">--compare</code></li>
</ul>

<h3 id="latest-cves">Latest CVEs</h3>

<p>A number of Rails vulnerabilities were announced recently, although there are really only two issues.</p>

<p>One issue is that query parameters like <code class="language-plaintext highlighter-rouge">?name[]</code> and <code class="language-plaintext highlighter-rouge">?name[]=1&amp;name[]</code> get converted to <code class="language-plaintext highlighter-rouge">{"name" =&gt; [nil]}</code> and <code class="language-plaintext highlighter-rouge">{"name" =&gt; ["1", nil]}</code>. This, in turn, causes ActiveRecord to produce SQL queries with either <code class="language-plaintext highlighter-rouge">IS NULL</code> or <code class="language-plaintext highlighter-rouge">IN ('1', NULL)</code>. This is probably unexpected behavior.</p>

<p>The other issue is that query parameters like <code class="language-plaintext highlighter-rouge">?name[users.id]=1</code> or <code class="language-plaintext highlighter-rouge">?name[users][id]=1</code> get converted to <code class="language-plaintext highlighter-rouge">{"name" =&gt; { "users.id" =&gt; 1 }}</code> or <code class="language-plaintext highlighter-rouge">{"name" =&gt; { "users" =&gt; { "id" =&gt; 1 }}}</code>. ActiveRecord interprets <code class="language-plaintext highlighter-rouge">"users.id"</code> and <code class="language-plaintext highlighter-rouge">"users" =&gt; { "id" ...}</code> as <code class="language-plaintext highlighter-rouge">"users"."id"</code> in the WHERE clause, allowing an attacker to control the table/columns being queried.</p>

<p>Updated versions for Rails 3.x have been released.</p>

<p>For Rails 2.3, I believe <a href="https://github.com/presidentbeef/rails/pull/1/files">these changes</a> will fix the first issue, and there is another <a href="https://rubyonrails-security.googlegroups.com/attach/aee3413fb038bf56/2-3-sql-injection.patch?view=1&amp;part=3">patch available</a> for the second issue.</p>

<p>Older versions of Rails 2.x may be vulnerable to the “NULL” issue, but not to the nested hashes problem.</p>

<h3 id="unprotected-redirect-check">Unprotected Redirect Check</h3>

<p>There have been some minor changes to <code class="language-plaintext highlighter-rouge">CheckRedirect</code>. In most cases, it should no longer warn when redirecting to a model instance. If there are still false positives with this scenario, please report them.</p>

<p>The other change is that redirects to model attributes will now be marked as high confidence, instead of weak.</p>

<h3 id="exit-code-on-missing-dependencies">Exit Code on Missing Dependencies</h3>

<p>Brakeman catches errors from missing dependencies in order to show a nicer error message. Unfortunately, it was also returning <code class="language-plaintext highlighter-rouge">0</code> on exit. This is undesirable behavior when chaining commands together.</p>

<p>This has been changed to return a non-zero exit code.</p>

<h3 id="before-filter-changes">Before Filter Changes</h3>

<p>There were some isues with how <code class="language-plaintext highlighter-rouge">before_filter</code> was being handled. The logic when using <code class="language-plaintext highlighter-rouge">:except</code> was broken, causing Brakeman to treat it like <code class="language-plaintext highlighter-rouge">:only</code>.</p>

<p>The other issue caused Brakeman to interpret arguments such as method calls as method names. For example, <code class="language-plaintext highlighter-rouge">before_filter blah</code> would be treated like <code class="language-plaintext highlighter-rouge">before_filter :blah</code>.</p>

<p>While dealing with this, caching of filter lookups was also added for a minor performance improvement.</p>

<h3 id="noisier---compare">Noisier <code class="language-plaintext highlighter-rouge">--compare</code></h3>

<p>Using the <code class="language-plaintext highlighter-rouge">--compare</code> option now shows the same output as a regular scan. If you are piping the output of <code class="language-plaintext highlighter-rouge">--compare</code> to a file or elsewhere, you may wish to use the <code class="language-plaintext highlighter-rouge">--quiet</code> option.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/05/23/brakeman-1-dot-6-1-released">Brakeman 1.6.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-05-23 12:45:00 -0700" pubdate  updated >2012-05-23 12:45:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>Wow, it’s been over a month since the last release!</p>

<p>The major change in this version is a rewrite of the SQL injection check. Many more methods are covered, and there should be a reduction of false positives as well.</p>

<p><em>Changes since 1.6.0</em>:</p>

<ul>
  <li>Major rewrite of CheckSQL</li>
  <li>Process actions mixed into controllers</li>
  <li>Check for inherited <code class="language-plaintext highlighter-rouge">attr_accessible</code> (Neil Matatall)</li>
  <li>Handle <code class="language-plaintext highlighter-rouge">render :template =&gt; ...</code></li>
  <li>Report line number of highlighted value, if available</li>
  <li>Fix highlighting of HTML escaped values in HTML report</li>
  <li>Fix rescanning of deleted templates</li>
</ul>

<h3 id="updated-sql-injection-check">Updated SQL Injection Check</h3>

<p><code class="language-plaintext highlighter-rouge">CheckSQL</code> has been completely revamped. Brakeman now has a much better understanding of the various ActiveRecord::FinderMethods and ActiveRecord::QueryMethods, as well as their options.</p>

<p>The check is also more conservative about what it warns on. Previously, since string interpolation is the main entry point for SQL injection in Rails, any interpolated value in a query would generate a warning. Now, “safe” sanitization methods, obviously safe methods like <code class="language-plaintext highlighter-rouge">to_i</code> and <code class="language-plaintext highlighter-rouge">id</code>, constants, strings, and other literal values should not cause warnings.</p>

<p>The “highlighted” value (or “user input”) reported for SQL warnings should be much more accurate now, making it easier to determine why a warning was reported.</p>

<h3 id="controller-mixins">Controller Mixins</h3>

<p>Methods on controller mixins that are used as actions should now be processed as if they were defined in the controller itself.</p>

<h3 id="check-for-inherited-mass-assignment-protection">Check for Inherited Mass Assignment Protection</h3>

<p>Since mass assignment protection via <code class="language-plaintext highlighter-rouge">attr_accessible</code> is inheritable, Brakeman will no longer warn about models whose parent uses <code class="language-plaintext highlighter-rouge">attr_accessible</code>.</p>

<h3 id="template-option-in-render">Template Option in Render</h3>

<p>Somehow, the <code class="language-plaintext highlighter-rouge">:template</code> option for <code class="language-plaintext highlighter-rouge">render</code> has been ignored this whole time. Sorry!</p>

<h3 id="better-line-numbers">Better Line Numbers</h3>

<p>Warnings which have a <code class="language-plaintext highlighter-rouge">:user_input</code> field use that value to “highlight” part of the code in the reported warning. This value usually corresponds to the code which actually caused the warning to be generated.</p>

<p>If a warning has this field, the line number of that code is used, instead of the starting line number of the entire piece of code. This often leads to more accurate and helpful line numbers.</p>

<h3 id="highlighted-values-in-html-reports">Highlighted Values in HTML Reports</h3>

<p>Since the warnings output in HTML reports are HTML-escaped, there was a sometimes mismatch between the value that needed to be highlighted and the HTML warning output, causing nothing to be highlighted. This is fixed now.</p>

<h3 id="rescanning-of-deleted-templates">Rescanning of Deleted Templates</h3>

<p>In the rescanning logic, templates which are related to a changed file (a view or partial that is rendered, usually) will be rescanned. However, there is the possibility that the template which needs to be rescanned as a related file has been deleted as part of the set of changes. This caused the rescanning to blow up, but that has been fixed now.</p>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<p>Don’t forget to check out the <a href="https://speakerdeck.com/u/presidentbeef/p/keeping-rails-applications-on-track-with-brakeman">RailsConf Brakeman presentation slides</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/04/20/brakeman-1-dot-6-released">Brakeman 1.6 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-04-20 10:22:00 -0700" pubdate  updated >2012-04-20 10:22:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>A lot of code has changed in this release, particularly with the removal of the Ruport library for reporting. While Ruport worked pretty well, it caused some issues just due to the large number of (out-dated) dependencies it brought with it.</p>

<p>Also, this release changes the JSON report output. This is a backwards <em>incompatible</em> change. But, given how useless the previous JSON reports were, hopefully this will not affect too many people.</p>

<p><em>Changes since 1.5.3:</em></p>

<ul>
  <li>Remove the Ruport dependency (Neil Matatall)</li>
  <li>Add more informational JSON output (Neil Matatall)</li>
  <li>Add comparison to previous JSON report (Neil Matatall)</li>
  <li>Add highlighting of dangerous values in HTML/text reports</li>
  <li><code class="language-plaintext highlighter-rouge">Model#update_attribute</code> should not raise mass assignment warning (Dave Worth)</li>
  <li>Don’t check <code class="language-plaintext highlighter-rouge">find_by_*</code> method for SQL injection</li>
  <li>Fix duplicate reporting of mass assignment and SQL injection</li>
  <li>Fix rescanning of deleted files</li>
  <li>Properly check for <code class="language-plaintext highlighter-rouge">rails_xss</code> in Gemfile</li>
</ul>

<h3 id="no-more-ruport">No More Ruport</h3>

<p>Ruport is a nice library, but it also has not been updated in over two years and its dependency tree was ridiculous.</p>

<p>Thanks to Neil Matatall, Brakeman no longer depends on Ruport, but the reports should look essentially the same. The HTML reports are now rendered through ERB templates, so it should not be too difficult to customize the reports if desired.</p>

<h3 id="better-json-output">Better JSON Output</h3>

<p>JSON output now includes meta-information about the scan, errors raised during the scan, and line numbers for each warning.</p>

<h3 id="json-report-comparison">JSON Report Comparison</h3>

<p>Being able to compare Brakeman reports is essential for tracking warnings over time. Prior to this release, the only decent way of doing that was via the <a href="http://brakemanscanner.org/docs/jenkins/">Jenkins plugin</a>. But now Brakeman can compare results to the JSON report from a previous scan.</p>

<p>For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brakeman -o report.json
brakeman --compare report.json
</code></pre></div></div>

<p>This will run another scan, then output a comparison of the reports (in JSON). The report includes a list of fixed warnings and a list of new warnings that were found.</p>

<h3 id="user-input-highlighted-in-reports">User Input Highlighted in Reports</h3>

<p>Sometimes it is unclear exactly what value has caused Brakeman to issue a particular warning. This release adds highlighting the detected user input in most warnings. (Some warnings, the code that is reported <em>is</em> the detected user input). This information is also available in the JSON reports.</p>

<p><img src="/images/user_input_highlight.png" alt="User Input Highlight" title="Example of User Input Highlighting" /></p>

<h3 id="fewer-mass-assignment-and-sql-injection-methods">Fewer Mass Assignment and SQL Injection Methods</h3>

<p>Dave Worth pointed out that Brakeman was a little overzealous in which methods it considered susceptible to mass assignment and SQL injection attacks.</p>

<p>Brakeman will no longer check <code class="language-plaintext highlighter-rouge">update_attribute</code> for mass assignment or the <code class="language-plaintext highlighter-rouge">find_by_*</code> dynamic methods for SQL injection.</p>

<h3 id="fewer-mass-assignment-and-sql-injection-duplicates">Fewer Mass Assignment and SQL Injection Duplicates</h3>

<p>Pesky duplicate reports of mass assignment and SQL injection were turning up as template warnings. This occurred when the results of the mass assignment or SQL query were assigned to a variable which was then used in a template. This should now be fixed.</p>

<p>More details than are probably desired are available <a href="https://github.com/presidentbeef/brakeman/pull/82">here</a>.</p>

<h3 id="rescanning-fixes">Rescanning Fixes</h3>

<p>Rescanning of deleted files is now supported, and there some other issues with rescanning that are now resolved as well.</p>

<h3 id="new-logo">New Logo</h3>

<p>Brakeman has a sweet new logo, thanks to <a href="http://janellelawless.com/">Janelle Lawless</a>!</p>

<p><img src="/images/logo_medium.png" alt="Brakeman Logo" /></p>

<p>Updates to the website to reflect this awesomeness are coming soon.</p>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<p>And don’t forget to check out the Brakeman talk at <a href="http://railsconf2012.com/sessions/44">RailsConf</a> in a few days.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/04/10/brakeman-1-dot-5-3-released">Brakeman 1.5.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-04-10 13:18:00 -0700" pubdate  updated >2012-04-10 13:18:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>A considerable number of bugs and odd cases have been fixed with this release, and one new check has been added. Upgrading is <em>always</em> recommended!</p>

<p><em>Changes since 1.5.2:</em></p>

<ul>
  <li>Add check for user input in <code class="language-plaintext highlighter-rouge">Object#send</code> (Neil Matatall)</li>
  <li>Support output to multiple formats (Nick Green)</li>
  <li>Prevent infinite loops in mutually recursive templates</li>
  <li>Only check <code class="language-plaintext highlighter-rouge">eval</code> arguments for user input, not the call target</li>
  <li>Handle <code class="language-plaintext highlighter-rouge">render :layout</code> in views</li>
  <li>Search subdirectories for models</li>
  <li>Set values in request hashes and propagate to views</li>
  <li>Add rake task file to gemspec (Anton Ageev)</li>
  <li>Filter rescanning of templates (Neil Matatall)</li>
  <li>Improve handling of modules and nesting</li>
  <li>Test for zero errors in test reports</li>
</ul>

<h3 id="new-check-for-user-input-in-objectsend">New Check for User Input in Object#send</h3>

<p>This new check looks for instances where user input can be used to control the method called using <code class="language-plaintext highlighter-rouge">send</code>.</p>

<p>For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>user = User.find(params[:user][:id])
method = params[:user][:action].to_sym
user.send(method)
</code></pre></div></div>

<h3 id="support-for-multiple-output-formats">Support for Multiple Output Formats</h3>

<p>Brakeman can now accept multiple <code class="language-plaintext highlighter-rouge">-o</code> arguments in order to produce more than one report from the same scan:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>brakeman -o report.html -o report.json
</code></pre></div></div>

<h3 id="handle-mutually-recursive-templates">Handle Mutually Recursive Templates</h3>

<p>In some cases where two templates would render each other as partials, it would cause infinite loops in Brakeman. This is now fixed, at least for the simple common case:</p>

<p>_one.erb.html:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= render :partial =&gt; 'two' %&gt;
</code></pre></div></div>

<p>_two.erb.html:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= render :partial =&gt; 'one' %&gt;
</code></pre></div></div>

<h3 id="only-check-eval-arguments">Only Check <code class="language-plaintext highlighter-rouge">eval</code> Arguments</h3>

<p>Previously, Brakeman was checking the entire call to methods like <code class="language-plaintext highlighter-rouge">eval</code> or <code class="language-plaintext highlighter-rouge">class_eval</code> for user input. This led to false positives when <code class="language-plaintext highlighter-rouge">class_eval</code> was being called on a model.</p>

<p>Now Brakeman only checks the arguments or block provided to the <code class="language-plaintext highlighter-rouge">eval</code> call.</p>

<h3 id="handle-render-layout-in-views">Handle render :layout in views</h3>

<p>Brakeman was not handling <code class="language-plaintext highlighter-rouge">render :layout =&gt; "..."</code> in views properly. This led to errors like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wrong number of arguments (0 for 1): /Users/collins/work/brakeman/lib/brakeman/processors/lib/render_helper.rb:14:in `template_name
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">render :layout</code> is now handled just like rendering a partial.</p>

<h3 id="search-for-models-in-subdirectories">Search for Models in Subdirectories</h3>

<p>Brakeman was only searching <code class="language-plaintext highlighter-rouge">app/models/</code> for models, but not any subdirectories. Now it does!</p>

<h3 id="propagate-request-values">Propagate Request Values</h3>

<p>While Brakeman has always detected request values (e.g., query parameters) in views, it would not propagate values stored IN those request hashes.</p>

<p>For example, if an action in a controller did this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>params[:input] = some_random_value
</code></pre></div></div>

<p>That value would not be propagated to the view if the view used <code class="language-plaintext highlighter-rouge">params[:input]</code>.</p>

<h3 id="add-rake-task-to-gemspec">Add Rake Task to Gemspec</h3>

<p>In 1.2.0, Brakeman added the <code class="language-plaintext highlighter-rouge">--rake</code> option to add a Rake task to a Rails application, but the actual task itself was not included in the gem!</p>

<p>Thanks to Anton Ageev for pointing this out. Either no one else tried this option, or a lot of people were very disappointed.</p>

<h3 id="filter-templates-when-rescanning">Filter Templates When Rescanning</h3>

<p>When rescanning (for example, with <a href="https://github.com/guard/guard-brakeman">guard-brakeman</a>), Brakeman was assuming any files in <code class="language-plaintext highlighter-rouge">app/views</code> is a template, but this isn’t always true.</p>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a>!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<p>And don’t forget to check out the Brakeman talk at <a href="http://railsconf2012.com/sessions/44">RailsConf</a> later this month.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2023/12/04/brakeman-6-dot-1-dot-0-released">Brakeman 6.1.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/07/20/brakeman-6-dot-0-dot-1-released">Brakeman 6.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/05/24/brakeman-6-dot-0-released">Brakeman 6.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/02/21/brakeman-5-dot-4-dot-1-released">Brakeman 5.4.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/11/17/brakeman-5-dot-4-dot-0-released">Brakeman 5.4.0 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
