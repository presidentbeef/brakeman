
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/20/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/11/13/brakeman-1-dot-8-3-released">Brakeman 1.8.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-11-13 09:20:00 -0700" pubdate  updated >2012-11-13 09:20:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is primarily a false positive reduction release. One major change is the change in dependency from the <code class="language-plaintext highlighter-rouge">json_pure</code> gem to <code class="language-plaintext highlighter-rouge">multi_json</code>.</p>

<p><em>Changes since 1.8.2</em>:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">multi_json</code> gem for better harmony (<a href="https://github.com/presidentbeef/brakeman/issues/164">#164</a>)</li>
  <li>Performance improvement for call indexing</li>
  <li>Fix issue with processing HAML files (<a href="https://github.com/presidentbeef/brakeman/issues/168">#168</a>)</li>
  <li>Handle pre-release versions when processing <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> (<a href="https://github.com/presidentbeef/brakeman/issues/174">#174</a>)</li>
  <li>Only check first argument of <code class="language-plaintext highlighter-rouge">redirect_to</code> (<a href="https://github.com/presidentbeef/brakeman/issues/98">#98</a>)</li>
  <li>Fix false positives from <code class="language-plaintext highlighter-rouge">Model.arel_table</code> accesses</li>
  <li>Fix false positives on redirects to models decorated with Draper gem (<a href="https://github.com/presidentbeef/brakeman/issues/172">#172</a>)</li>
  <li>Fix false positive on redirect to model association (<a href="https://github.com/presidentbeef/brakeman/issues/111">#111</a>)</li>
  <li>Fix false positive on <code class="language-plaintext highlighter-rouge">YAML.load</code> (<a href="https://github.com/presidentbeef/brakeman/issues/142">#142</a>)</li>
  <li>Fix false positive XSS on any <code class="language-plaintext highlighter-rouge">to_i</code> output</li>
  <li>Fix error on Rails 2 named routes with no args</li>
  <li>Fix error in rescan of mixins with symbols in method name</li>
  <li>Do not rescan non-Ruby files in config/</li>
</ul>

<h3 id="change-to-multijson">Change to MultiJSON</h3>

<p>Brakeman now depends on the <a href="http://rdoc.info/github/intridea/multi_json">multijson</a> gem instead of <code class="language-plaintext highlighter-rouge">json_pure</code>. This should make it easier for people who include Brakeman as a dependency.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/166">changes</a>)</p>

<h3 id="faster-call-indexing">Faster Call Indexing</h3>

<p>Dumb code in the <code class="language-plaintext highlighter-rouge">CallIndex</code> was causing call indexing to be slow on some large applications. This should now be faster and require less memory!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/180">changes</a>)</p>

<h3 id="fix-haml-processing">Fix HAML Processing</h3>

<p>Some HAML files were causing Brakeman’s alias processing to slow to a crawl. This was due to the template code (sometimes) directly appending to the output variable via <code class="language-plaintext highlighter-rouge">&lt;&lt;</code>. Since Brakeman attempts to treat targets of <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> as arrays, Brakeman was generating large data structures each time <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> was encountered.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/170">changes</a>]</p>

<h3 id="handle-pre-release-versions">Handle Pre-release Versions</h3>

<p>When a <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> file is present in a Rails application, Brakeman uses it to determine the version of Rails in use. Previous versions did not accept pre-release version numbers (like <code class="language-plaintext highlighter-rouge">3.1.2.rc1</code>), leading to version inappropriate warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/176">changes</a>)</p>

<h3 id="redirect-false-positives">Redirect False Positives</h3>

<p>Several false positives related to redirects have been fixed, and the scope of the redirect check is somewhat reduced.</p>

<p>Calls beginning with <code class="language-plaintext highlighter-rouge">Model.arel_table</code> should no longer be treated as user input (in any context).</p>

<p>Model instances returned by the <code class="language-plaintext highlighter-rouge">decorate</code> method in the <a href="https://github.com/drapergem/draper">Draper</a> gem are considered safe.</p>

<p>Redirects to model associations (e.g, <code class="language-plaintext highlighter-rouge">belongs_to :account</code>) are considered safe.</p>

<p>Redirects to method calls with safe values should no longer warn. For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redirect_to blah(User.first) #No warning
</code></pre></div></div>

<p>Additionally, only the first argument of <code class="language-plaintext highlighter-rouge">redirect_to</code> will be checked for user input.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/177">changes</a>)</p>

<h3 id="yaml-false-positive">YAML False Positive</h3>

<p>File access warnings for YAML calls have been reduced to only those calls which actually access files.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/178">changes</a>)</p>

<h3 id="integer-output-false-positives">Integer Output False Positives</h3>

<p>Calls to <code class="language-plaintext highlighter-rouge">to_i</code> should not trigger XSS warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/179">changes</a>)</p>

<h3 id="errors-on-named-routes">Errors on Named Routes</h3>

<p>Rails 2 named routes with no arguments were causing errors, which have now been fixed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/181">changes</a>)</p>

<h3 id="future-work">Future Work</h3>

<p>Now that RubyParser 3.x is officially released, work is underway to use the new version. This will increase Ruby 1.9 syntax compatibility and remove the need to parse applications with the same Ruby version as the application uses. Additionally, it will allow us to get rid of the vendored version of RubyParser that Brakeman uses for Ruby 1.9. Unfortunately, RubyParser 3.x introduces a lot of incompatibilities and upgrading requires a significant amount of effort.</p>

<p>Another exciting feature in development is limited interprocedural analysis. Brakeman will be able to handle simple things like calls to helper methods in controllers which set instance variables or return user input. This should help with the “obvious” vulnerabilities that Brakeman often misses.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/10/17/brakeman-1-dot-8-2-released">Brakeman 1.8.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-10-17 10:44:00 -0600" pubdate  updated >2012-10-17 10:44:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a bugfix release, in particular fixing rescanning (used by <a href="https://github.com/guard/guard-brakeman">guard-brakeman</a>).</p>

<p><em>Changes since 1.8.1</em>:</p>

<ul>
  <li>Fixed rescanning problems caused by 1.8.0 changes</li>
  <li>Fix scope calls with single argument</li>
  <li>Report specific model name in rendered collections</li>
  <li>Handle overwritten JSON escape settings (Neil Matatall)</li>
  <li>Add CHANGES to gemspec</li>
</ul>

<h3 id="rescan-fixes">Rescan Fixes</h3>

<p>Brakeman supports rescanning a subset of files in an application, with the caveat that the previous scan must still be in memory. This functionality was broken in the the 1.8.0 release, due to the lack of tests.</p>

<p>This release updates rescanning to be more robust and work with the 1.8.0 changes to how “render paths” are stored. Also, a number of tests were added to help prevent breakage in the future.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/165">changes</a>)</p>

<h3 id="scope-calls-with-one-argument">Scope Calls with One Argument</h3>

<p>Calls to <code class="language-plaintext highlighter-rouge">scope</code> with a single argument were causing errors in Brakeman’s SQL injection check.</p>

<p>The fixed error looked like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>undefined method `node_type' for nil:NilClass  /something/brakeman/lib/brakeman/checks/check_sql.rb:75:in `block (2 levels) in find_scope_calls'
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/157">changes</a>)</p>

<h3 id="model-names-for-rendered-collections">Model Names for Rendered Collections</h3>

<p>In cases like below, where a collection of models is being rendered and the model name could be known, any resulting warnings will now reference the actual model name.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= render 'user', :collection =&gt; User.all %&gt;
</code></pre></div></div>

<p>Previously, Brakeman would report warnings with <code class="language-plaintext highlighter-rouge">UnknownModel</code>, whether or not the model name was actually known.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/155">changes</a>)</p>

<h3 id="overwritten-json-escape-config">Overwritten JSON Escape Config</h3>

<p>It is possible that a config setting in one initializer overrides a setting in a different initializer. This is now handled for the JSON escape settings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/154">changes</a>)</p>

<h3 id="changes-file-in-gem">CHANGES File in Gem</h3>

<p>The <a href="https://github.com/presidentbeef/brakeman/blob/master/CHANGES">CHANGES</a> file is now included in the gem file as requested.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/issues/153">changes</a>)</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<h3 id="brakeman-roadmap">Brakeman Roadmap</h3>

<p>A rough guide to Brakeman 1.9 and 2.0 has been <a href="https://github.com/presidentbeef/brakeman/wiki/Roadmap">posted here</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/09/24/brakeman-1-dot-8-1-released">Brakeman 1.8.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-09-24 12:09:00 -0600" pubdate  updated >2012-09-24 12:09:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>Bug fixes!</p>

<p><em>Changes since 1.8.0</em>:</p>

<ul>
  <li>Recover from errors in output formatting (<a href="https://github.com/presidentbeef/brakeman/pull/148">#148</a>)</li>
  <li>Fix false positive in <code class="language-plaintext highlighter-rouge">redirect_to</code> (Neil Matatall) (<a href="https://github.com/presidentbeef/brakeman/issues/143">#143</a>)</li>
  <li>Fix problems with removal of <code class="language-plaintext highlighter-rouge">Sexp#method_missing</code> (<a href="https://github.com/presidentbeef/brakeman/pull/150">#150</a>)</li>
  <li>Fix array indexing in alias processing (<a href="https://github.com/presidentbeef/brakeman/pull/145">#145</a>)</li>
  <li>Fix old <code class="language-plaintext highlighter-rouge">mail_to</code> vulnerability check (<a href="https://github.com/presidentbeef/brakeman/pull/147">#147</a>)</li>
  <li>Fix rescans when only controller action changes (<a href="https://github.com/presidentbeef/brakeman/pull/141">#141</a>)</li>
  <li>Allow comparison of versions with unequal lengths (<a href="https://github.com/presidentbeef/brakeman/pull/144">#144</a>)</li>
  <li>Handle super calls with blocks (<a href="https://github.com/presidentbeef/brakeman/pull/146">#146</a>)</li>
  <li>Remove malformed Sexps from HAML processing  (<a href="https://github.com/presidentbeef/brakeman/pull/149">#149</a>)</li>
  <li>Respect <code class="language-plaintext highlighter-rouge">-q</code> flag for “Rails 3 detected” message</li>
</ul>

<h3 id="fix-crashes-when-generating-report">Fix Crashes when Generating Report</h3>

<p>Some scans were causing Brakeman to crash while generating reports with an error like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lib/brakeman/warning.rb:78:in `format_code': undefined method `gsub' for nil:NilClass (NoMethodError)
</code></pre></div></div>

<p>This was due to a combination of the removal of <code class="language-plaintext highlighter-rouge">method_missing</code> behavior from <code class="language-plaintext highlighter-rouge">Sexp</code> and the <code class="language-plaintext highlighter-rouge">OutputProcessor</code> not handling errors well.</p>

<p>The problem should be fixed now, but please report an issue if “[Format Error]” shows up in reports.</p>

<h3 id="false-positive-in-redirect-check">False Positive in Redirect Check</h3>

<p>Neil Matatall fixed <a href="https://github.com/presidentbeef/brakeman/issues/143">an issue</a> with a false positive when redirecting to an array.</p>

<p>When <code class="language-plaintext highlighter-rouge">redirect_to</code> is given an array, Rails eventually falls through to <code class="language-plaintext highlighter-rouge">polymorphic_path</code>, which will only return a path, not a full URL. Brakeman only checks for redirects that can redirect to a different host, so this is considered safe.</p>

<h3 id="sexp-and-method_missing">Sexp and <code class="language-plaintext highlighter-rouge">method_missing</code></h3>

<p>The original <code class="language-plaintext highlighter-rouge">Sexp</code> code from RubyParser uses <code class="language-plaintext highlighter-rouge">method_missing</code> to find and optionally delete nodes. This functionality is not used very often (never in Brakeman) but has covered up bugs that would otherwise been found. Therefore, <code class="language-plaintext highlighter-rouge">Sexp#method_missing</code> has been removed in Brakeman. However, it turns out that <a href="https://github.com/seattlerb/ruby2ruby">Ruby2Ruby</a> uses it in a couple places. Brakeman uses Ruby2Ruby to covert s-expressions back to readable Ruby code, particularly when generating reports. This lead to some crashes.</p>

<h3 id="fix-array-indexing">Fix Array Indexing</h3>

<p>Brakeman can handle pulling values out of simple arrays. Or it should be able to, but it keeps breaking. Should be fixed now!</p>

<h3 id="fix-mail_to-check">Fix <code class="language-plaintext highlighter-rouge">mail_to</code> Check</h3>

<p>There is a Brakeman check for an <a href="https://groups.google.com/d/topic/rubyonrails-security/8CpI7egxX4E/discussion">old vulnerability</a> in <code class="language-plaintext highlighter-rouge">mail_to</code>. However, it turns out this check has been broken for a while. But now it is fixed! And there are regression tests.</p>

<h3 id="fix-rescans-on-controller-changes">Fix Rescans on Controller Changes</h3>

<p>There were some crashes when rescanning was triggered by a controller change.</p>

<h3 id="haml-processing">HAML Processing</h3>

<p>Some very old code for HAML processing was generating malformed s-expressions, which then had to be handled specially in the output formatter. It turns out these nodes were not even used, so they were removed. Please report any problems arising from this! We do not have a lot of HAML test cases.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/09/04/brakeman-1-dot-8-0-released">Brakeman 1.8.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-09-04 11:26:00 -0600" pubdate  updated >2012-09-04 11:26:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p><em>Changes since 1.7.1</em>:</p>

<ul>
  <li>Support relative paths in reports (fsword)</li>
  <li>Allow Brakeman to be run without tty (fsword)</li>
  <li>Fix exit code with <code class="language-plaintext highlighter-rouge">--compare</code> (fsword)</li>
  <li>Fix <code class="language-plaintext highlighter-rouge">--rake</code> option (Deepak Kumar)</li>
  <li>Add high confidence warnings for <code class="language-plaintext highlighter-rouge">to_json</code> XSS (Neil Matatall)</li>
  <li>Fix <code class="language-plaintext highlighter-rouge">redirect_to</code> false negative</li>
  <li>Fix duplicate warnings with <code class="language-plaintext highlighter-rouge">raw</code> calls</li>
  <li>Fix shadowing of rendered partials</li>
  <li>Add “render chain” to HTML reports</li>
  <li>Add check for XSS in <code class="language-plaintext highlighter-rouge">content_tag</code></li>
  <li>Add full backtrace for errors in debug mode</li>
  <li>Treat model attributes in <code class="language-plaintext highlighter-rouge">or</code> expressions as immediate values</li>
  <li>Switch to method access for Sexp nodes</li>
</ul>

<h3 id="relative-paths-in-reports">Relative Paths in Reports</h3>

<p>The <code class="language-plaintext highlighter-rouge">--relative-paths</code> option will now cause Brakeman to output relative paths for warnings in reports in either JSON or tabs format. This is useful when comparing reports run on different machines or just in different directories.</p>

<h3 id="brakeman-without-tty">Brakeman without TTY</h3>

<p>Thanks to <a href="http://fsword.github.com/">fsword</a>, Brakeman can now run without a TTY available.</p>

<h3 id="exit-code-for-compare">Exit Code for Compare</h3>

<p>Also thanks to fsword, Brakeman will return a proper exit code when run with <code class="language-plaintext highlighter-rouge">-z --compare</code>. If any changes are found, the exit code will be nonzero.</p>

<h3 id="rake-task-generation-fixed">Rake Task Generation Fixed</h3>

<p>The <code class="language-plaintext highlighter-rouge">--rake</code> option was broken, but <a href="https://github.com/deepakinseattle">Deepak Kumar</a> noticed and fixed it!</p>

<h3 id="high-confidence-warnings-for-json">High Confidence Warnings for JSON</h3>

<p>Older versions of Rails default to not escaping <code class="language-plaintext highlighter-rouge">to_json</code> calls, leading to <a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting_to_json/">cross site scripting problems</a>. Since Rails 2.1.0, Rails has provided an option to escape JSON output by default. Brakeman will check this option, and warn on unescaped <code class="language-plaintext highlighter-rouge">to_json</code> calls.</p>

<h3 id="fix-redirect-false-negative">Fix Redirect False Negative</h3>

<p>Brakeman was incorrectly checking for <code class="language-plaintext highlighter-rouge">:only_path =&gt; true</code> in <em>any</em> argument to <code class="language-plaintext highlighter-rouge">redirect_to</code>. However, it is only valid as part of the first argument.</p>

<h3 id="fix-duplicate-warnings-on-raw-calls">Fix Duplicate Warnings on Raw Calls</h3>

<p>A logic mistake sometimes caused a high and weak confidence warning to be reported for the same code using <code class="language-plaintext highlighter-rouge">raw</code>. This has been fixed.</p>

<h3 id="fix-shadowing-of-rendered-partials">Fix Shadowing of Rendered Partials</h3>

<p>Due to the way Brakeman was storing rendered partials, a view that was rendered multiple times via different code paths would only store a single instance of the rendered view. This could result in some vulnerabilities not being reported.</p>

<p>To fix this, Brakeman now stores the entire “render chain” (that is, each location of a <code class="language-plaintext highlighter-rouge">render</code>). This ensures a unique key for each rendered template.</p>

<h3 id="report-render-chain-in-html">Report Render Chain in HTML</h3>

<p>HTML reports now have a new feature that reports the “render chain” for view warnings (if the chain is more than a single call deep).</p>

<p>A warning like this:</p>

<p><img src="/images/unexpanded_call_chain.png" alt="Unexpanded" /></p>

<p>Might expand to show this chain:</p>

<p><img src="/images/expanded_call_chain.png" alt="Expanded" /></p>

<h3 id="check-for-xss-in-content_tag">Check for XSS in <code class="language-plaintext highlighter-rouge">content_tag</code></h3>

<p><code class="language-plaintext highlighter-rouge">content_tag</code> is a view helper for generating HTML tags containing some content. In Rails 2.x, <code class="language-plaintext highlighter-rouge">content_tag</code> did not escape this content. In Rails 3.x, this changed so that now it is escaped. While <code class="language-plaintext highlighter-rouge">content_tag</code> does have an <code class="language-plaintext highlighter-rouge">escape</code> parameter (true by default), this only applies to the tag attribute <em>values</em>.</p>

<p>Brakeman now warns on possible cross site scripting via <code class="language-plaintext highlighter-rouge">content_tag</code> calls. <a href="/docs/warning_types/content_tag">See here</a> for more details.</p>

<h3 id="backtraces-in-debug-mode">Backtraces in Debug Mode</h3>

<p>By default, Brakeman tries its best to recover from errors and produce a report. However, this can sometimes make it difficult to track down the sources of errors. Now, with the <code class="language-plaintext highlighter-rouge">-d</code> option, Brakeman will report backtraces for errors encountered while running, as well as including backtraces in HTML reports.</p>

<h3 id="convenience-methods-for-sexp-access">Convenience Methods for Sexp Access</h3>

<p>Previously, all code dealing with <a href="https://en.wikipedia.org/wiki/S-exp">s-expressions</a> in the <code class="language-plaintext highlighter-rouge">Sexp</code> class accessed nodes via array access, e.g. <code class="language-plaintext highlighter-rouge">exp[1]</code> or <code class="language-plaintext highlighter-rouge">exp[2]</code>. This led to hard-to-read code like <code class="language-plaintext highlighter-rouge">exp[2][3][1][1..-1]</code>. This release includes convenience methods to replace those types of calls. Available methods are <a href="http://rdoc.info/gems/brakeman/Sexp">documented here</a>.</p>

<p>Hopefully this leads to code that is both easier to read and easier to write.</p>

<h3 id="reporting-problems">Reporting Problems</h3>

<p>This release touches a lot of code (76 changed files with 1,515 additions and 598 deletions), so there is ample opportunity for bugs to sneak in. Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a>!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> and following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/08/13/brakeman-1-dot-7-1-released">Brakeman 1.7.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-08-13 11:04:00 -0600" pubdate  updated >2012-08-13 11:04:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a small release to add checks for the <a href="http://weblog.rubyonrails.org/2012/8/9/ann-rails-3-2-8-has-been-released/">Rails vulnerabilities reported last week</a>.</p>

<p><em>Changes since 1.7.0</em>:</p>

<ul>
  <li>Add check for <a href="https://groups.google.com/d/topic/rubyonrails-security/fV3QUToSMSw/discussion">CVE-2012-3463</a></li>
  <li>Add check for <a href="https://groups.google.com/d/topic/rubyonrails-security/kKGNeMrnmiY/discussion">CVE-2012-3464</a></li>
  <li>Add check for <a href="https://groups.google.com/d/topic/rubyonrails-security/FgVEtBajcTY/discussion">CVE-2012-3465</a></li>
  <li>Add charset to HTML report (<a href="https://github.com/hooopo">hooopo</a>)</li>
  <li>Report XSS in select() for Rails 2</li>
</ul>

<h3 id="cve-2012-3463---xss-in-select_tag-prompt">CVE-2012-3463 - XSS in select_tag Prompt</h3>

<p>In Rails 3.x, values supplied to the <code class="language-plaintext highlighter-rouge">:prompt</code> option in the <code class="language-plaintext highlighter-rouge">select_tag</code> helper are not escaped, leading to a cross-site scripting vulnerability.</p>

<p>Brakeman will warn on all uses of <code class="language-plaintext highlighter-rouge">select_tag</code> with unescaped user input in the <code class="language-plaintext highlighter-rouge">:prompt</code> option.</p>

<h3 id="cve-2012-3464---single-quotes-are-unescaped">CVE-2012-3464 - Single Quotes are Unescaped</h3>

<p>This is pretty much a known issue (<a href="http://www.ruby-forum.com/topic/166894">example from 2008</a>), but Rails 3.2.8 fixes it.</p>

<p>Single quotes are most dangerous when interpolating values into HTML attributes that use single quotes, which is why it is often recommended to always use double quotes in HTML.</p>

<p>There is a <a href="https://groups.google.com/d/topic/rubyonrails-security/kKGNeMrnmiY/discussion">provided workaround</a> for earlier versions of Rails which replaces <code class="language-plaintext highlighter-rouge">ERB::Util.html_escape</code> with <code class="language-plaintext highlighter-rouge">Rack::Utils.escape_html</code>. This method adds escaping for both single quotes (<code class="language-plaintext highlighter-rouge">'</code>) and forward slashes (<code class="language-plaintext highlighter-rouge">/</code>).</p>

<p>If the provided workaround is used in an initializer, as suggested, then Brakeman will not generate a warning for this vulnerability. Otherwise, Brakeman will generate a warning for affected versions.</p>

<h3 id="cve-2012-3465---xss-in-strip_tags">CVE-2012-3465 - XSS in strip_tags</h3>

<p>Another vulnerability has been reported for <code class="language-plaintext highlighter-rouge">strip_tags</code> (earlier report was <a href="https://groups.google.com/d/topic/rubyonrails-security/K5EwdJt06hI/discussion">CVE-2011-2931</a>).</p>

<p>Brakeman will warn on affected versions if uses of <code class="language-plaintext highlighter-rouge">strip_tags</code> are detected.</p>

<h3 id="xss-in-select-helper">XSS in select Helper</h3>

<p>This vulnerability was <a href="https://groups.google.com/d/topic/rubyonrails-security/CdoMUVpsRmQ/discussion">reported a while ago</a>, but it was unclear if it applied to Rails 2.x or just Rails 3. Thanks to Neil Matatall, it has been confirmed to be an issue in Rails 2.x as well.</p>

<p>Therefore, Brakeman will be reporting the vulnerability (<code class="language-plaintext highlighter-rouge">select</code> does not escape options list if supplied as a straight string) for Rails 2.x as well.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2025/04/03/brakeman-7-dot-0-dot-1-released">Brakeman 7.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/12/30/brakeman-7-dot-0-dot-0-released">Brakeman 7.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/10/18/brakeman-6-dot-2-dot-2-released">Brakeman 6.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/08/22/brakeman-6-dot-2-released">Brakeman 6.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/02/01/brakeman-6-dot-1-dot-2-released">Brakeman 6.1.2 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
