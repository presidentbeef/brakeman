
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/20/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2013/01/18/brakeman-1-dot-9-1-released">Brakeman 1.9.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2013-01-18 17:36:00 -0700" pubdate  updated >2013-01-18 17:36:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This released was forced due to messed up dependencies with Brakeman 1.9.0 and Ruby2Ruby - my fault entirely! As such, this release does not match the roadmap for 1.9.1, which will be changed to 1.9.2.</p>

<p><em>Changes since 1.9.0</em>:</p>

<ul>
  <li>Add check for CVE-2012-5664 - SQL Injection</li>
  <li>Add check for CVE-2013-0155 - SQL Injection</li>
  <li>Add check for CVE-2013-0156 - Remote Code Execution</li>
  <li>Add check for unsafe <code class="language-plaintext highlighter-rouge">YAML.load</code></li>
  <li>Update to RubyParser 3.1.1 (neersighted)</li>
  <li>Remove ActiveSupport dependency (Neil Matatall)</li>
  <li>Do not warn on arrays passed to <code class="language-plaintext highlighter-rouge">link_to</code> (Neil Matatall) (<a href="https://github.com/presidentbeef/brakeman/issues/232">#232</a>)</li>
  <li>Warn on secret tokens (<a href="https://github.com/presidentbeef/brakeman/issues/200">#200</a>)</li>
  <li>Warn on more mass assignment methods (<a href="https://github.com/presidentbeef/brakeman/issues/223">#223</a>)</li>
</ul>

<h3 id="cve-2012-5664---sql-injection">CVE-2012-5664 - SQL Injection</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/DCNTNp_qjFM/discussion">CVE-2012-5664</a> is a vulnerability Rails’ dynamic finders. While dynamic finders (such as <code class="language-plaintext highlighter-rouge">User.find_by_name</code>) appear to take a single argument, they also accept a hash options which can be used to modify the SQL query. Normally the hash of options would be the second argument, but it can also be the first. If an application passes in user code as the first argument, it will be interpreted as the options hash, leading to SQL injection.</p>

<p>The provided fix is to only accept the hash if the dynamic finder is called with the proper number of arguments. A workaround is to always cast input to dynamic finders.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/228">changes</a>)</p>

<h3 id="cve-2013-0155---sql-injection">CVE-2013-0155 - SQL Injection</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/c7jT-EeN9eI/discussion">CVE-2013-0155</a> is a SQL vulnerability where certain JSON input can cause <code class="language-plaintext highlighter-rouge">find</code> methods to add <code class="language-plaintext highlighter-rouge">NULL</code> as a valid value.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/239">changes</a>)</p>

<h3 id="cve-2013-0156---remote-code-execution">CVE-2013-0156 - Remote Code Execution</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/61bkgvnSGTQ/discussion">CVE-2013-0156</a> is the worst Rails vulnerability in recent memory. It allows attackers to easily execute arbitrary code on any Rails application.</p>

<p>Besides upgrading Rails, there are workarounds for this issue: disable XML request parsing or disable YAML/symbol types inside XML requests.</p>

<p>Exploits for this vulnerability are easily available and already in use in the wild. Please upgrade, patch, or use a workaround.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/239">changes</a>)</p>

<h3 id="check-for-yamlload">Check for <code class="language-plaintext highlighter-rouge">YAML.load</code></h3>

<p>In light of <a href="https://groups.google.com/d/topic/rubyonrails-security/61bkgvnSGTQ/discussion">CVE-2013-0156</a>, Brakeman will now warn on any uses of <code class="language-plaintext highlighter-rouge">YAML.load</code> with user input. Do not load arbitrary YAML in applications!</p>

<h3 id="dependency-changes">Dependency Changes</h3>

<p>Brakeman now uses the latest RubyParser and Ruby2Ruby versions.</p>

<p>Thanks to Neil, Brakeman no longer depends on any version of ActiveSupport or i18n.</p>

<h3 id="namespaced-urls-in-link_to">Namespaced URLs in <code class="language-plaintext highlighter-rouge">link_to</code></h3>

<p>Brakeman will no longer warn on array arguments to <code class="language-plaintext highlighter-rouge">link_to</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/233">changes</a>)</p>

<h3 id="secret-tokens">Secret Tokens</h3>

<p>Secret tokens stored in source control are bad! Doubly bad if the source code is available publicly. Anyone with access to an application’s secret token can generate any session cookies they would like. See <a href="http://phenoelit.org/blog/archives/2012/12/21/let_me_github_that_for_you/index.html">this post</a> for details.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/227">changes</a>)</p>

<h3 id="more-mass-assignment">More Mass Assignment</h3>

<p>Bryan Helmkamp pointed out more Rails methods which perform mass assignment. The following methods have been added: <code class="language-plaintext highlighter-rouge">first_or_create</code>, <code class="language-plaintext highlighter-rouge">first_or_create!</code>, <code class="language-plaintext highlighter-rouge">first_or_initialize!</code>, <code class="language-plaintext highlighter-rouge">assign_attributes</code>, and <code class="language-plaintext highlighter-rouge">update</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/234">changes</a>)</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/12/25/brakeman-1-dot-9-0-released">Brakeman 1.9.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-12-25 11:00:00 -0700" pubdate  updated >2012-12-25 11:00:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>Happy <a href="https://en.wikipedia.org/wiki/Eggnog_Riot">Eggnog Riot</a> day!</p>

<p>This is a major release: 95 changed files with 1,775 additions and 14,484 deletions. This provides ample room for new bugs, so please report any issues.</p>

<p><em>Changes since 1.8.3</em>:</p>

<ul>
  <li>Update to RubyParser 3</li>
  <li>Ignore route information by default</li>
  <li>Add optional “interprocedural” analysis for controllers</li>
  <li>Properly pass instance variables between before_filters</li>
  <li>Support <code class="language-plaintext highlighter-rouge">strong_parameters</code> (<a href="https://github.com/presidentbeef/brakeman/issues/88">#88</a>)</li>
  <li>Support newer <code class="language-plaintext highlighter-rouge">validates :format</code> call (<a href="https://github.com/presidentbeef/brakeman/issues/198">#198</a>)</li>
  <li>Add scan time to reports (<a href="https://github.com/presidentbeef/brakeman/issues/158">#158</a>)</li>
  <li>Add Brakeman version to reports</li>
  <li>Don’t mangle whitespace in JSON code formatting</li>
  <li>Fix <code class="language-plaintext highlighter-rouge">CheckExecute</code> to warn on all string interpolation (<a href="https://github.com/presidentbeef/brakeman/issues/213">#213</a>)</li>
  <li>Fix false positive on <code class="language-plaintext highlighter-rouge">to_sql</code> calls</li>
  <li>Add AppTree as facade for filesystem (<a href="https://github.com/brynary">Bryan Helmkamp</a>)</li>
  <li>Add link for translate vulnerability warning (<a href="https://github.com/grosser">Michael Grosser</a>)</li>
  <li>Add Rakefile to run tests (<a href="https://github.com/grosser">Michael Grosser</a>)</li>
  <li>Better default config file locations (<a href="https://github.com/grosser">Michael Grosser</a>)</li>
  <li>Remove “find by regex” feature from <code class="language-plaintext highlighter-rouge">CallIndex</code></li>
  <li>Reduce Sexp creation</li>
  <li>Handle empty model files</li>
</ul>

<h3 id="update-to-rubyparser-3">Update to RubyParser 3</h3>

<p>With the update to use RubyParser 3.x, Brakeman no longer includes a vendored version of RubyParser (which was only used with running with Ruby 1.9), which reduced code size by about 14,000 lines.</p>

<p>RubyParser 3 supports Ruby 1.9 much more fully, so there should be very few parse errors. Additionally, Brakeman no longer chooses parsers based on the current Ruby version.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/190">changes</a>)</p>

<h3 id="route-information-ignored-by-default">Route Information Ignored by Default</h3>

<p>Route information is only used in Brakeman to determine whether a controller method should perform an implicit render. Since determining Rails routes statically is quite difficult to get right, it is better to assume a method is a routable action. Previous versions provided the <code class="language-plaintext highlighter-rouge">-a</code> option for this, which is now on by default. To turn off this behavior (and revert to the old), use <code class="language-plaintext highlighter-rouge">--no-assume-routes</code>.</p>

<p>This does not affect default route warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/219">changes</a>)</p>

<h3 id="optional-interprocedural-analysis-for-controllers">Optional Interprocedural Analysis for Controllers</h3>

<p>Currently, Brakeman essentially looks at each method in isolation. Values are propagated from controller actions (including before_filters) through rendered views and templates. But if a controller action calls another method which has an effect on the eventual output of the action, Brakeman does not processed the invoked method.</p>

<p>This release includes optional, experimental support for analyzing controller methods called from within controller actions.</p>

<p>For a simple example, instance variables set in helper methods will now be added to a rendered view. Also, values returned from called methods will be tracked:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def create
  get_user 
  #@user is now User.find(params[:id])

  @account = find_account(@user)  
  #@account is now Account.where(:user =&gt; User.find(params[:id]).id
end

private

def get_user
  @user = User.find(params[:id])
end

def find_account
  Account.where(:user =&gt; @user.id)
end
</code></pre></div></div>

<p>This is limited to methods available in the controller (via a parent class or mixins). It is also limited to a “depth of one”, meaning it will not try to analyze methods called by helper methods (<code class="language-plaintext highlighter-rouge">get_user</code> and <code class="language-plaintext highlighter-rouge">find_account</code> above).</p>

<p>Since this feature is still experimental and will definitely increase scan times, it is turned off by default. Use <code class="language-plaintext highlighter-rouge">--interprocedural</code> to enable it. (Better name pending suggestions…)</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/218">changes</a>)</p>

<h3 id="pass-instance-variables-between-filters">Pass Instance Variables between Filters</h3>

<p>While instance variables set in <code class="language-plaintext highlighter-rouge">before_filters</code> were set properly, <code class="language-plaintext highlighter-rouge">before_filter</code> which used instance variables from an earlier filter could not see those variables. This has been fixed, which will likely lead to new or more accurate warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/224">changes</a>)</p>

<h3 id="support-for-strong_parameters">Support for <code class="language-plaintext highlighter-rouge">strong_parameters</code></h3>

<p>In Rails 4, the responsibility for mass assignment protection will move from models to controllers where mass assignment is actually used. A preview of the new functionality is available in the <a href="https://github.com/rails/strong_parameters">strong_parameters</a> gem. Brakeman should no longer warn on mass assignment for models protected with <code class="language-plaintext highlighter-rouge">strong_parameters</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/204">changes</a>)</p>

<h3 id="support-validates-format">Support <code class="language-plaintext highlighter-rouge">validates :format</code></h3>

<p>In Rails 3, format validation changed from <code class="language-plaintext highlighter-rouge">validates_format_of</code> to the more generic <code class="language-plaintext highlighter-rouge">validates</code> method. Brakeman will now check <code class="language-plaintext highlighter-rouge">validates</code> calls for proper anchors on regular expressions for <code class="language-plaintext highlighter-rouge">:format</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/205">changes</a>)</p>

<h3 id="report-changes">Report Changes</h3>

<p>Reports will now contain Brakeman version and scan duration. JSON reports contain <code class="language-plaintext highlighter-rouge">start_time</code> and <code class="language-plaintext highlighter-rouge">end_time</code> timestamps. For now, JSON reports will still have a <code class="language-plaintext highlighter-rouge">timestamp</code> key, but it will be identical to <code class="language-plaintext highlighter-rouge">end_time</code>. It will be removed in Brakeman 2.0.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/193">changes</a>)</p>

<p>Additionally, code formatting in JSON reports has changed slightly. Previously, code was formatted with the HTML output in mind, so line breaks were removed. Now JSON reports include the code formatted from Ruby2Ruby without any mangling.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/191">changes</a>)</p>

<h3 id="fix-command-injection-check">Fix Command Injection Check</h3>

<p>The command injection check will now (again) warn on any form on string interpolation used for process execution, whether or not user input is involved.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/216">changes</a>)</p>

<h3 id="fix-to_sql-false-positives">Fix <code class="language-plaintext highlighter-rouge">to_sql</code> False Positives</h3>

<p>SQL code generated from Arel’s <code class="language-plaintext highlighter-rouge">to_sql</code> method will be considered safe.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/194">changes</a>)</p>

<h3 id="file-system-facade">File System Facade</h3>

<p>Bryan Helmkamp cleaned up Brakeman’s file access into a single object. This should simplify future changes and add some consistency to how Brakeman handles files.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/197">changes</a>)</p>

<h3 id="run-tests-via-rake">Run Tests via Rake</h3>

<p>Thanks to Michael Grosser, running <code class="language-plaintext highlighter-rouge">rake</code> will now run Brakeman’s tests.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/183">changes</a>)</p>

<h3 id="improved-config-file-locations">Improved Config File Locations</h3>

<p>Also thanks to Michael Grosser, Brakeman will check more sane locations for Brakeman configuration files. This version adds <code class="language-plaintext highlighter-rouge">./config/brakeman.yml</code>, <code class="language-plaintext highlighter-rouge">~/.brakeman/config.yml</code>, and <code class="language-plaintext highlighter-rouge">/etc/brakeman/config.yml</code> as default locations for configuration files. The old locations are deprecated now, and will be removed in Brakeman 2.0.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/182">changes</a></p>

<h3 id="more-internal-changes">More Internal Changes</h3>

<p>Call indexing performance has been given another <a href="http://blog.presidentbeef.com/">slight boost</a> with the removal of the ability to search for call targets via regular expressions (which was not being used anywhere).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/189">changes</a>)</p>

<p>The number of s-expressions generated by Brakeman has been reduced, although this did not lead to any major performance improvement.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/207">changes</a>)</p>

<p>Data-flow/alias processing was performing two passes. This has been reduced to just one.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/224">changes</a>)</p>

<p>Empty model files will no longer cause errors.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/11/13/brakeman-1-dot-8-3-released">Brakeman 1.8.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-11-13 09:20:00 -0700" pubdate  updated >2012-11-13 09:20:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is primarily a false positive reduction release. One major change is the change in dependency from the <code class="language-plaintext highlighter-rouge">json_pure</code> gem to <code class="language-plaintext highlighter-rouge">multi_json</code>.</p>

<p><em>Changes since 1.8.2</em>:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">multi_json</code> gem for better harmony (<a href="https://github.com/presidentbeef/brakeman/issues/164">#164</a>)</li>
  <li>Performance improvement for call indexing</li>
  <li>Fix issue with processing HAML files (<a href="https://github.com/presidentbeef/brakeman/issues/168">#168</a>)</li>
  <li>Handle pre-release versions when processing <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> (<a href="https://github.com/presidentbeef/brakeman/issues/174">#174</a>)</li>
  <li>Only check first argument of <code class="language-plaintext highlighter-rouge">redirect_to</code> (<a href="https://github.com/presidentbeef/brakeman/issues/98">#98</a>)</li>
  <li>Fix false positives from <code class="language-plaintext highlighter-rouge">Model.arel_table</code> accesses</li>
  <li>Fix false positives on redirects to models decorated with Draper gem (<a href="https://github.com/presidentbeef/brakeman/issues/172">#172</a>)</li>
  <li>Fix false positive on redirect to model association (<a href="https://github.com/presidentbeef/brakeman/issues/111">#111</a>)</li>
  <li>Fix false positive on <code class="language-plaintext highlighter-rouge">YAML.load</code> (<a href="https://github.com/presidentbeef/brakeman/issues/142">#142</a>)</li>
  <li>Fix false positive XSS on any <code class="language-plaintext highlighter-rouge">to_i</code> output</li>
  <li>Fix error on Rails 2 named routes with no args</li>
  <li>Fix error in rescan of mixins with symbols in method name</li>
  <li>Do not rescan non-Ruby files in config/</li>
</ul>

<h3 id="change-to-multijson">Change to MultiJSON</h3>

<p>Brakeman now depends on the <a href="http://rdoc.info/github/intridea/multi_json">multijson</a> gem instead of <code class="language-plaintext highlighter-rouge">json_pure</code>. This should make it easier for people who include Brakeman as a dependency.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/166">changes</a>)</p>

<h3 id="faster-call-indexing">Faster Call Indexing</h3>

<p>Dumb code in the <code class="language-plaintext highlighter-rouge">CallIndex</code> was causing call indexing to be slow on some large applications. This should now be faster and require less memory!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/180">changes</a>)</p>

<h3 id="fix-haml-processing">Fix HAML Processing</h3>

<p>Some HAML files were causing Brakeman’s alias processing to slow to a crawl. This was due to the template code (sometimes) directly appending to the output variable via <code class="language-plaintext highlighter-rouge">&lt;&lt;</code>. Since Brakeman attempts to treat targets of <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> as arrays, Brakeman was generating large data structures each time <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> was encountered.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/170">changes</a>]</p>

<h3 id="handle-pre-release-versions">Handle Pre-release Versions</h3>

<p>When a <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> file is present in a Rails application, Brakeman uses it to determine the version of Rails in use. Previous versions did not accept pre-release version numbers (like <code class="language-plaintext highlighter-rouge">3.1.2.rc1</code>), leading to version inappropriate warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/176">changes</a>)</p>

<h3 id="redirect-false-positives">Redirect False Positives</h3>

<p>Several false positives related to redirects have been fixed, and the scope of the redirect check is somewhat reduced.</p>

<p>Calls beginning with <code class="language-plaintext highlighter-rouge">Model.arel_table</code> should no longer be treated as user input (in any context).</p>

<p>Model instances returned by the <code class="language-plaintext highlighter-rouge">decorate</code> method in the <a href="https://github.com/drapergem/draper">Draper</a> gem are considered safe.</p>

<p>Redirects to model associations (e.g, <code class="language-plaintext highlighter-rouge">belongs_to :account</code>) are considered safe.</p>

<p>Redirects to method calls with safe values should no longer warn. For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redirect_to blah(User.first) #No warning
</code></pre></div></div>

<p>Additionally, only the first argument of <code class="language-plaintext highlighter-rouge">redirect_to</code> will be checked for user input.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/177">changes</a>)</p>

<h3 id="yaml-false-positive">YAML False Positive</h3>

<p>File access warnings for YAML calls have been reduced to only those calls which actually access files.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/178">changes</a>)</p>

<h3 id="integer-output-false-positives">Integer Output False Positives</h3>

<p>Calls to <code class="language-plaintext highlighter-rouge">to_i</code> should not trigger XSS warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/179">changes</a>)</p>

<h3 id="errors-on-named-routes">Errors on Named Routes</h3>

<p>Rails 2 named routes with no arguments were causing errors, which have now been fixed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/181">changes</a>)</p>

<h3 id="future-work">Future Work</h3>

<p>Now that RubyParser 3.x is officially released, work is underway to use the new version. This will increase Ruby 1.9 syntax compatibility and remove the need to parse applications with the same Ruby version as the application uses. Additionally, it will allow us to get rid of the vendored version of RubyParser that Brakeman uses for Ruby 1.9. Unfortunately, RubyParser 3.x introduces a lot of incompatibilities and upgrading requires a significant amount of effort.</p>

<p>Another exciting feature in development is limited interprocedural analysis. Brakeman will be able to handle simple things like calls to helper methods in controllers which set instance variables or return user input. This should help with the “obvious” vulnerabilities that Brakeman often misses.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/10/17/brakeman-1-dot-8-2-released">Brakeman 1.8.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-10-17 10:44:00 -0600" pubdate  updated >2012-10-17 10:44:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a bugfix release, in particular fixing rescanning (used by <a href="https://github.com/guard/guard-brakeman">guard-brakeman</a>).</p>

<p><em>Changes since 1.8.1</em>:</p>

<ul>
  <li>Fixed rescanning problems caused by 1.8.0 changes</li>
  <li>Fix scope calls with single argument</li>
  <li>Report specific model name in rendered collections</li>
  <li>Handle overwritten JSON escape settings (Neil Matatall)</li>
  <li>Add CHANGES to gemspec</li>
</ul>

<h3 id="rescan-fixes">Rescan Fixes</h3>

<p>Brakeman supports rescanning a subset of files in an application, with the caveat that the previous scan must still be in memory. This functionality was broken in the the 1.8.0 release, due to the lack of tests.</p>

<p>This release updates rescanning to be more robust and work with the 1.8.0 changes to how “render paths” are stored. Also, a number of tests were added to help prevent breakage in the future.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/165">changes</a>)</p>

<h3 id="scope-calls-with-one-argument">Scope Calls with One Argument</h3>

<p>Calls to <code class="language-plaintext highlighter-rouge">scope</code> with a single argument were causing errors in Brakeman’s SQL injection check.</p>

<p>The fixed error looked like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>undefined method `node_type' for nil:NilClass  /something/brakeman/lib/brakeman/checks/check_sql.rb:75:in `block (2 levels) in find_scope_calls'
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/157">changes</a>)</p>

<h3 id="model-names-for-rendered-collections">Model Names for Rendered Collections</h3>

<p>In cases like below, where a collection of models is being rendered and the model name could be known, any resulting warnings will now reference the actual model name.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= render 'user', :collection =&gt; User.all %&gt;
</code></pre></div></div>

<p>Previously, Brakeman would report warnings with <code class="language-plaintext highlighter-rouge">UnknownModel</code>, whether or not the model name was actually known.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/155">changes</a>)</p>

<h3 id="overwritten-json-escape-config">Overwritten JSON Escape Config</h3>

<p>It is possible that a config setting in one initializer overrides a setting in a different initializer. This is now handled for the JSON escape settings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/154">changes</a>)</p>

<h3 id="changes-file-in-gem">CHANGES File in Gem</h3>

<p>The <a href="https://github.com/presidentbeef/brakeman/blob/master/CHANGES">CHANGES</a> file is now included in the gem file as requested.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/issues/153">changes</a>)</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<h3 id="brakeman-roadmap">Brakeman Roadmap</h3>

<p>A rough guide to Brakeman 1.9 and 2.0 has been <a href="https://github.com/presidentbeef/brakeman/wiki/Roadmap">posted here</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/09/24/brakeman-1-dot-8-1-released">Brakeman 1.8.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-09-24 12:09:00 -0600" pubdate  updated >2012-09-24 12:09:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>Bug fixes!</p>

<p><em>Changes since 1.8.0</em>:</p>

<ul>
  <li>Recover from errors in output formatting (<a href="https://github.com/presidentbeef/brakeman/pull/148">#148</a>)</li>
  <li>Fix false positive in <code class="language-plaintext highlighter-rouge">redirect_to</code> (Neil Matatall) (<a href="https://github.com/presidentbeef/brakeman/issues/143">#143</a>)</li>
  <li>Fix problems with removal of <code class="language-plaintext highlighter-rouge">Sexp#method_missing</code> (<a href="https://github.com/presidentbeef/brakeman/pull/150">#150</a>)</li>
  <li>Fix array indexing in alias processing (<a href="https://github.com/presidentbeef/brakeman/pull/145">#145</a>)</li>
  <li>Fix old <code class="language-plaintext highlighter-rouge">mail_to</code> vulnerability check (<a href="https://github.com/presidentbeef/brakeman/pull/147">#147</a>)</li>
  <li>Fix rescans when only controller action changes (<a href="https://github.com/presidentbeef/brakeman/pull/141">#141</a>)</li>
  <li>Allow comparison of versions with unequal lengths (<a href="https://github.com/presidentbeef/brakeman/pull/144">#144</a>)</li>
  <li>Handle super calls with blocks (<a href="https://github.com/presidentbeef/brakeman/pull/146">#146</a>)</li>
  <li>Remove malformed Sexps from HAML processing  (<a href="https://github.com/presidentbeef/brakeman/pull/149">#149</a>)</li>
  <li>Respect <code class="language-plaintext highlighter-rouge">-q</code> flag for “Rails 3 detected” message</li>
</ul>

<h3 id="fix-crashes-when-generating-report">Fix Crashes when Generating Report</h3>

<p>Some scans were causing Brakeman to crash while generating reports with an error like:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lib/brakeman/warning.rb:78:in `format_code': undefined method `gsub' for nil:NilClass (NoMethodError)
</code></pre></div></div>

<p>This was due to a combination of the removal of <code class="language-plaintext highlighter-rouge">method_missing</code> behavior from <code class="language-plaintext highlighter-rouge">Sexp</code> and the <code class="language-plaintext highlighter-rouge">OutputProcessor</code> not handling errors well.</p>

<p>The problem should be fixed now, but please report an issue if “[Format Error]” shows up in reports.</p>

<h3 id="false-positive-in-redirect-check">False Positive in Redirect Check</h3>

<p>Neil Matatall fixed <a href="https://github.com/presidentbeef/brakeman/issues/143">an issue</a> with a false positive when redirecting to an array.</p>

<p>When <code class="language-plaintext highlighter-rouge">redirect_to</code> is given an array, Rails eventually falls through to <code class="language-plaintext highlighter-rouge">polymorphic_path</code>, which will only return a path, not a full URL. Brakeman only checks for redirects that can redirect to a different host, so this is considered safe.</p>

<h3 id="sexp-and-method_missing">Sexp and <code class="language-plaintext highlighter-rouge">method_missing</code></h3>

<p>The original <code class="language-plaintext highlighter-rouge">Sexp</code> code from RubyParser uses <code class="language-plaintext highlighter-rouge">method_missing</code> to find and optionally delete nodes. This functionality is not used very often (never in Brakeman) but has covered up bugs that would otherwise been found. Therefore, <code class="language-plaintext highlighter-rouge">Sexp#method_missing</code> has been removed in Brakeman. However, it turns out that <a href="https://github.com/seattlerb/ruby2ruby">Ruby2Ruby</a> uses it in a couple places. Brakeman uses Ruby2Ruby to covert s-expressions back to readable Ruby code, particularly when generating reports. This lead to some crashes.</p>

<h3 id="fix-array-indexing">Fix Array Indexing</h3>

<p>Brakeman can handle pulling values out of simple arrays. Or it should be able to, but it keeps breaking. Should be fixed now!</p>

<h3 id="fix-mail_to-check">Fix <code class="language-plaintext highlighter-rouge">mail_to</code> Check</h3>

<p>There is a Brakeman check for an <a href="https://groups.google.com/d/topic/rubyonrails-security/8CpI7egxX4E/discussion">old vulnerability</a> in <code class="language-plaintext highlighter-rouge">mail_to</code>. However, it turns out this check has been broken for a while. But now it is fixed! And there are regression tests.</p>

<h3 id="fix-rescans-on-controller-changes">Fix Rescans on Controller Changes</h3>

<p>There were some crashes when rescanning was triggered by a controller change.</p>

<h3 id="haml-processing">HAML Processing</h3>

<p>Some very old code for HAML processing was generating malformed s-expressions, which then had to be handled specially in the output formatter. It turns out these nodes were not even used, so they were removed. Please report any problems arising from this! We do not have a lot of HAML test cases.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2025/07/18/brakeman-7-dot-1-dot-0-released">Brakeman 7.1.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2025/04/04/brakeman-7-dot-0-dot-2-released">Brakeman 7.0.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2025/04/03/brakeman-7-dot-0-dot-1-released">Brakeman 7.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/12/30/brakeman-7-dot-0-dot-0-released">Brakeman 7.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/10/18/brakeman-6-dot-2-dot-2-released">Brakeman 6.2.2 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
