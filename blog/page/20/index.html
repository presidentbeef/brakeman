
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/20/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/03/22/brakeman-1-dot-5-2-released-important-fixes">Brakeman 1.5.2 Released - Important Fixes</a></h1>
    
    
      <p class="meta">




<time datetime="2012-03-22 13:34:00 -0700" pubdate  updated >2012-03-22 13:34:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is update includes some important fixes. All users of the <code class="highlighter-rouge">rails_xss</code> plugin are particularly encouraged to upgrade.</p>

<p><em>Changes since 1.5.1:</em></p>

<ul>
  <li>Fix handling of views when using <code class="highlighter-rouge">rails_xss</code></li>
  <li>Fix rescanning of lib files (Neil Matatall)</li>
  <li>Fix <code class="highlighter-rouge">link_to</code> checks for Rails 2.0 and 2.3</li>
  <li>Revert to <code class="highlighter-rouge">ruby_parser</code> 2.3.1 for Ruby 1.8 parsing</li>
  <li>Only warn on user input in render paths</li>
  <li>Output stack trace on interrupt when debugging</li>
  <li>Ignore user input in if statement conditions</li>
  <li>Fix –skip-files option with Ruby 1.8</li>
</ul>

<h3 id="views-with-rails_xss">Views with rails_xss</h3>

<p>Some previous changes to make sure Brakeman was processing ERB views the same way as the <code class="highlighter-rouge">rails_xss</code> plugin unfortunately broke the processing of those views.</p>

<p>These changes caused Brakeman to not report <em>any</em> output from ERB views when the <code class="highlighter-rouge">rails_xss</code> plugin was in use, hiding any XSS vulnerabilities in those views.</p>

<p>This now fixed, so if you are using the <code class="highlighter-rouge">rails_xss</code> plugin, it is highly recommended to upgrade.</p>

<h3 id="rescanning-lib-files">Rescanning lib/ Files</h3>

<p>Rescanning changed files in the <code class="highlighter-rouge">lib</code> directory was broken, but Neil fixed it!</p>

<h3 id="link_to-checks">link_to Checks</h3>

<p>In Rails 2.3, the URL is escaped, but not the body of the link. In Rails 2.0, neither argument is escaped.</p>

<p>In this release, the check for XSS in <code class="highlighter-rouge">link_to</code> has been updated to handle <code class="highlighter-rouge">link_to</code> with blocks and to warn in Rails 2.0.x if any user input is used as an argument.</p>

<h3 id="revert-to-ruby_parser-for-ruby-18">Revert to ruby_parser for Ruby 1.8</h3>

<p>Brakeman has been using a vendored version of <a href="https://github.com/seattlerb/ruby_parser">ruby_parser</a> with some updates to Ruby 1.9 syntax parsing. Unfortunately, that version also introduced some regressions for parsing Ruby 1.8 syntax.</p>

<p>To handle this, Brakeman will now only use the vendored version for 1.9 parsing, but the regular gem version for 1.8 syntax parsing. This should fix some parse errors people are seeing for Ruby 1.8 apps.</p>

<h3 id="dynamic-render-path-updates">Dynamic Render Path Updates</h3>

<p>The check for dynamic render paths was not very good, but it is better now. “Dynamic Render Path” warnings should only be raised when user input is actually used to determine what view, partial, or file to render.</p>

<h3 id="stacktrace-output">Stacktrace Output</h3>

<p>Brakeman will now output a stacktrace if interrupted while running with the <code class="highlighter-rouge">-d</code> option. This is mostly helpful when Brakeman appears to “hang”.</p>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a>!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/03/22/brakeman-jenkins-plugin-0-dot-7-released">Brakeman Jenkins Plugin 0.7 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-03-22 13:27:00 -0700" pubdate  updated >2012-03-22 13:27:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>The <a href="http://jenkins-ci.org">Jenkins</a>/<a href="http://hudson-ci.org">Hudson</a> plugin which tracks, displays, and alerts on Brakeman warnings has been updated to work with the latest static analysis core plugin. In particular, this means warning thresholds for new warnings will no longer disappear.</p>

<p>See <a href="https://wiki.jenkins-ci.org/display/JENKINS/Brakeman+Plugin">here</a> for more information about the plugin.</p>

<p>Thanks to Nick Green for fixing this!</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/03/05/brakeman-1-dot-5-1-released">Brakeman 1.5.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-03-05 18:50:00 -0800" pubdate  updated >2012-03-05 18:50:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>After the excitment yesterday with a mass assignment vulnerability being exploited in a very public manner on <a href="https://gist.github.com/1978249">Github</a>, interest in Brakeman has skyrocketed.</p>

<p>This lead to re-examination of Brakeman’s code for detecting that mass assignment has been globally disabled - and it turns out there was a bug or two. So here is a bug-fix release of Brakeman to correct that and some other minor issues.</p>

<p>Upgrading to 1.5.1 may increase the number of warnings reported.</p>

<p><em>Changes since 1.5.0</em>:</p>

<ul>
  <li>Fix detection of global mass assignment setting</li>
  <li>Fix partial rendering in Rails 3</li>
  <li>Show backtrace when interrupt received (Ruby 1.9 only)</li>
  <li>More debug output</li>
  <li>Internal fixes:
    <ul>
      <li>Remove duplicate method in Brakeman::Rails2XSSErubis</li>
      <li>Add tracking of module and class to Brakeman::BaseProcessor</li>
      <li>Report module when using Brakeman::FindCall</li>
    </ul>
  </li>
</ul>

<h3 id="mass-assignment">Mass Assignment</h3>

<p>Mass assignment is not a particularly new issue, but the amount of attention suddenly focused on it this weekend was amazing.</p>

<p>This release of Brakeman can detect three different methods for defaulting all models to a whitelist of allowed attributes that can be mass assigned.</p>

<p>The first is probably the most widely-seen version. In an intializer, do</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ActiveRecord::Base.send(:attr_accessible, nil)
</code></pre></div></div>

<p>The second is essentially equivalent, but 1.5.1 adds support for it as well:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>module ActiveRecord
  class Base
    attr_accessible nil
  end
end
</code></pre></div></div>

<p>The third option is only available for Rails 3.1.0 and newer. The following configuration setting can be added to <code class="highlighter-rouge">application.rb</code>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>config.active_record.whitelist_attributes = true
</code></pre></div></div>

<p>Brakeman should correctly detect all of these.</p>

<p><a href="http://pragtob.wordpress.com/2012/03/06/secure-your-rails-apps/">This is a very nice post</a> explaining the dangers of mass assignment (mentioning Brakeman is nice, too.)</p>

<h3 id="partials-in-rails-3">Partials in Rails 3</h3>

<p>In Rails 3, <code class="highlighter-rouge">render 'blah'</code> is now equivalent to <code class="highlighter-rouge">render :partial =&gt; 'blah'</code> when used inside a template.</p>

<p>Brakeman now supports this correctly.</p>

<h3 id="debug-output">Debug Output</h3>

<p>More debugging output has been added for use with the <code class="highlighter-rouge">-d</code> option.</p>

<p>Additionally, when interrupting the application (for example, with <code class="highlighter-rouge">^C</code>), a stack trace will be output. Please note, however, that this only works with Ruby 1.9.</p>

<h3 id="internal-changes">Internal Changes</h3>

<p>There have been a few internal changes. There is a possibility that these will affect some warnings. However, it should only result in accurate reporting of class names.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any problems on <a href="https://github.com/presidentbeef/brakeman/issues">Github</a>!</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/03/01/brakeman-1-dot-5-0-released">Brakeman 1.5.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-03-01 20:23:00 -0800" pubdate  updated >2012-03-01 20:23:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>A release was forced today because two new Rails vulnerabilities were reported (the first since November):</p>

<ul>
  <li><a href="http://groups.google.com/group/rubyonrails-security/browse_thread/thread/9da0c515a6c4664">Manual options are not escaped in select()</a></li>
  <li><a href="http://groups.google.com/group/rubyonrails-security/browse_thread/thread/edd28f1e3d04e913">Some operations on SafeBuffer mistakenly return strings marked as html_safe</a></li>
</ul>

<p>This release includes checks for these two vulnerabilities.</p>

<p>There is also a new check for skipping CSRF token verification, and some other changes which may result in fewer or more vulnerabilities being reported.</p>

<p><em>Changes since 1.4.0:</em></p>

<ul>
  <li>Add version check for SafeBuffer vulnerability</li>
  <li>Add check for select vulnerability in Rails 3</li>
  <li>select() is no longer considered safe in Rails 2</li>
  <li>Add check for skipping CSRF protection with a blacklist</li>
  <li>Add JSON report format</li>
  <li>Model#id should not be considered XSS</li>
  <li>Standardize methods to check for SQL injection</li>
  <li>Fix Rails 2 route parsing issue with nested routes</li>
</ul>

<h3 id="check-for-safebuffer-vulnerability">Check for SafeBuffer Vulnerability</h3>

<p>A new vulnerability was reported that affects strings which are marked as <code class="highlighter-rouge">html_safe</code> and then modified in some way. For some operations, the new, modified string will still be marked as <code class="highlighter-rouge">html_safe</code>. Full details <a href="http://groups.google.com/group/rubyonrails-security/browse_thread/thread/edd28f1e3d04e913">here</a>.</p>

<p>For this vulnerability, Brakeman only does a version check and reports if an application is used a vulnerable version of Rails. It only reports on Rails 3 applications, since Rails 3 introduced the concept of SafeBuffers.</p>

<h3 id="check-for-select-helper-vulnerability">Check for select Helper Vulnerability</h3>

<p>Another vulnerability was reported today in the <code class="highlighter-rouge">select</code> form helper. Option tags built by hand (interpolating values into <code class="highlighter-rouge">&lt;option&gt;&lt;/option&gt;</code>) will not be escaped by <code class="highlighter-rouge">select</code>. Full details <a href="http://groups.google.com/group/rubyonrails-security/browse_thread/thread/9da0c515a6c4664">here</a>.</p>

<p>For Rails 3 applications, Brakeman checks for uses of <code class="highlighter-rouge">select</code> which have user input in the <code class="highlighter-rouge">options</code> argument. This check may be refined in the future.</p>

<p>For Rails 2, Brakeman no longer considers <code class="highlighter-rouge">select</code> a safe method when checking for cross site scripting.</p>

<h3 id="check-for-csrf-filter-skipping">Check for CSRF Filter Skipping</h3>

<p>When cross site request forgery protection is enabled, a <code class="highlighter-rouge">before_filter</code> is added called <code class="highlighter-rouge">verify_authenticity_token</code>. This filter checks that actions called responding to a <code class="highlighter-rouge">POST</code> have a correct authenticity token from the client. Since this is a regular <code class="highlighter-rouge">before_filter</code>, it can be skipped using <code class="highlighter-rouge">skip_before_filter</code>.</p>

<p>If <code class="highlighter-rouge">skip_before_filter</code> is called using an <code class="highlighter-rouge">:except</code> option, then the default for the controller becomes NOT checking for an authenticity token:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>skip_before_filter :verify_authenticity_token, :except =&gt; [:create, :delete]
</code></pre></div></div>

<p>It is recommended to use <code class="highlighter-rouge">:only</code> if skipping this filter is actually necessary. This way, any new actions added later will automatically fall under the CSRF protection.</p>

<p>This check may be extended in the future to other important filters.</p>

<h3 id="json-report-format">JSON Report Format</h3>

<p>While the code for outputting JSON was in the 1.4.0 release, it was not actually added as a proper output format! This has been rectified.</p>

<p><code class="highlighter-rouge">-f json</code> or <code class="highlighter-rouge">-o report.json</code> will now produce JSON reports.</p>

<p>The information contained in these reports may change in the future, although that should only be adding more information.</p>

<h3 id="sql-methods">SQL Methods</h3>

<p>The code for finding SQL methods to check for SQL injection was a little messed up. Depending on how the method was called, different sets of methods were considered dangerous.</p>

<p>This has been changed for better consistency and coverage. This means reports may include new SQL injections, so keep an eye out.</p>

<h3 id="rails-2-route-parsing-fix">Rails 2 Route Parsing Fix</h3>

<p>There was a bug in the code which determined if a method was being called on <code class="highlighter-rouge">map</code>, which caused Brakeman to think strange methods were route definitions (for example, <code class="highlighter-rouge">require</code>). This has been fixed.</p>

<h3 id="report-problems">Report Problems!</h3>

<p>Always <a href="https://github.com/presidentbeef/brakeman/issues">report problems</a> encountered when running Brakeman.</p>

<p>Don’t forget to join the <a href="http://librelist.com/browser/brakeman/">mailing list</a> and/or follow <a href="https://twitter.com/brakeman">@Brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/02/25/brakeman-1-dot-4-0-released">Brakeman 1.4.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-02-25 09:57:00 -0800" pubdate  updated >2012-02-25 09:57:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is not a big release, but it does add a new check. Also, processing for ERB templates with the <code class="highlighter-rouge">rails_xss</code> plugin has changed, so there is the possibility that line numbers for reported warnings will shift.</p>

<p><em>Changes since 1.3.0:</em></p>

<ul>
  <li>Add check for user input in link_to href parameter</li>
  <li>Match ERB processing to rails_xss plugin when plugin used</li>
  <li>Add Brakeman::Report#to_json, Brakeman::Warning#to_json</li>
  <li>Warnings below minimum confidence are dropped completely</li>
  <li>Brakeman.run will now always return a Tracker</li>
</ul>

<h3 id="new-check-for-link_to">New Check for link_to</h3>

<p><a href="https://github.com/oreoshake">Neil Matatall</a> has contributed a new check for the href parameter in <code class="highlighter-rouge">link_to</code>. Even if HTML escaped, some values can be dangerous, so this check will warn for user input in that parameter. See <a href="https://github.com/presidentbeef/brakeman/pull/45">here</a> for more details.</p>

<p>The <code class="highlighter-rouge">--url-safe-methods</code> option can be used to specify escaping methods which are safe for urls.</p>

<h3 id="erb-and-rails_xss">ERB and rails_xss</h3>

<p>The <code class="highlighter-rouge">rails_xss</code> plugin has some fixes for how Erbuis handles certain input. Brakeman now matches those changes, which fixes some parsing errors.</p>

<h3 id="internal-changes">Internal Changes</h3>

<p>There have been some changes which only impact those working with Brakeman as a library.</p>

<p>First, there is now json output for reports. This actually should be an output format option, but I did not realize it until writing this post. The next release will include this, though!</p>

<p>The way Brakeman handles the <code class="highlighter-rouge">--confidence-level</code> option has also changed. In the past, warnings would be filtered when output in a report. This meant, for example, that <code class="highlighter-rouge">tracker.checks.all_warnings</code> would still return warnings below the specified confidence level. It also caused problems because there were many places in the code where the warnings needed to be filtered. With this release, warnings below the confidence level will be dropped as soon as they are found and will not need to be filtered at any later point.</p>

<p>Lastly, <code class="highlighter-rouge">Brakeman.run</code> would return <code class="highlighter-rouge">false</code> if <code class="highlighter-rouge">--exit-on-warn</code> was set, and a <code class="highlighter-rouge">Tracker</code> object otherwise. This has changed. <code class="highlighter-rouge">Brakeman.run</code> will now always return a <code class="highlighter-rouge">Tracker</code> object and the logic for <code class="highlighter-rouge">--exit-on-warn</code> was pushed out to the Brakeman executable.</p>

<h3 id="report-issues">Report Issues</h3>

<p>As usual, please <a href="https://github.com/presidentbeef/brakeman/issues">report any issues</a>.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
<script type='text/javascript'>
    $(document).ready(function(){
        $("#github").GitHubBadge({
          login: "presidentbeef",
          kind: "project",
          repo_name: "brakeman",
          include_github_logo: false,
          image_path: "",
          commit_count: "1",
          issue_count: "0",
          repo_count: "0"
      });
    });
</script>
<div id="github"></div>
<a href="https://travis-ci.org/#!/presidentbeef/brakeman"><img src="https://secure.travis-ci.org/presidentbeef/brakeman.png" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2022/05/01/brakeman-5-dot-3-dot-0-released">Brakeman 5.2.3 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/05/01/brakeman-5-dot-2-dot-3-released">Brakeman 5.2.3 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">Brakeman 5.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/01/30/5-dot-2-dot-1-released">Brakeman 5.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/12/15/brakeman-5-dot-2-dot-0-released">Brakeman 5.2.0 Released</a>
      </li>
    
  </ul>
</section>

  <section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <a class="twitter-timeline" data-dnt=true href="https://twitter.com/brakeman" data-widget-id="258654953097273345">Tweets by @brakeman</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
