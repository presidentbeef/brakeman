
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/14/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2014/04/30/brakeman-2-dot-5-0-released">Brakeman 2.5.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2014-04-30 09:52:00 -0700" pubdate  updated >2014-04-30 09:52:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release includes a number of false positive fixes, more Rails 4 support, a new check for regular expression denial of service, and Markdown output formatting.</p>

<p><em>Changes since 2.4.3</em>:</p>

<ul>
  <li>Add GitHub-flavored Markdown output format (<a href="https://github.com/gregose">Greg Ose</a>)</li>
  <li>Add check for regex denial of service (<a href="https://github.com/mastahyeti">Ben Toews</a>)</li>
  <li>Fix false positives when <code class="highlighter-rouge">sanitize</code> is used in SQL (<a href="https://github.com/jeffyip">Jeff Yip</a>)</li>
  <li>Add <code class="highlighter-rouge">String#intern</code> and <code class="highlighter-rouge">Hash#symbolize_keys</code> DoS check (<a href="https://github.com/jrusnack">Jan Rusnacko</a>)</li>
  <li>Add support for Rails 4 <code class="highlighter-rouge">before_actions</code> and friends</li>
  <li>Add support for RailsLTS 2.3.18.7 and 2.3.18.8</li>
  <li>Check for <code class="highlighter-rouge">protected_attributes</code> gem (<a href="https://github.com/presidentbeef/brakeman/issues/475">#475</a>)</li>
  <li>Fix SQLi detection in chain calls in scopes (<a href="https://github.com/presidentbeef/brakeman/issues/471">#471</a>)</li>
  <li>Fix false positive when <code class="highlighter-rouge">:host</code> is specified in redirect (<a href="https://github.com/presidentbeef/brakeman/issues/464">#464</a>)</li>
  <li>Check all arguments in <code class="highlighter-rouge">Model.select</code> for SQLi</li>
  <li>Move SQLi CVE checks to <code class="highlighter-rouge">CheckSQLCVEs</code></li>
  <li>Handle more non-literals in routes (<a href="https://github.com/presidentbeef/brakeman/issues/461">#461</a>)</li>
</ul>

<h3 id="markdown-output-format">Markdown Output Format</h3>

<p><a href="https://github.com/gregose">Greg Ose</a> added the option to output to GitHub-flavored markdown (<code class="highlighter-rouge">-f markdown</code> or <code class="highlighter-rouge">-o report.md</code>). Additionally, the <code class="highlighter-rouge">--github-repo</code> option can be used to link the files in the report to a specific GitHub repository. <a href="https://github.com/presidentbeef/brakeman/pull/463">See here for details</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/463">changes</a>)</p>

<h3 id="regex-denial-of-service">Regex Denial of Service</h3>

<p>A new check for dangerous interpolation in regular expressions was contributed by <a href="https://github.com/mastahyeti">Ben Toews</a>. This will generate “Denial of Service” warnings if user input is interpolated into regular expressions.</p>

<p>For example, this will generate a warning:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/#{params[:name]}/
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/454">changes</a>)</p>

<h3 id="avoid-warning-on-sanitized-sql">Avoid Warning on Sanitized SQL</h3>

<p>Brakeman should no longer warn about SQL values wrapped in <code class="highlighter-rouge">sanitize</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/commit/cd9093d890b7a16f117d11a0ae6af281ecbb648d">changes</a>)</p>

<h3 id="more-symbol-denial-of-service-methods">More Symbol Denial of Service Methods</h3>

<p><code class="highlighter-rouge">String#intern</code> and <code class="highlighter-rouge">Hash#symbolize_key</code> were added to the symbol denial of service check by <a href="https://github.com/jrusnack">Jan Rusnacko</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/470">changes</a>)</p>

<h3 id="rails-4-before-actions">Rails 4 Before Actions</h3>

<p>Rails 4 added a bunch of aliases for <code class="highlighter-rouge">before_filter</code> and related methods, and Brakeman now recognizes these methods for adding and skipping filters.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/480">changes</a>)</p>

<h3 id="latest-railslts-version">Latest RailsLTS Version</h3>

<p>This release adds support for the latest RailsLTS 2.3.18.x versions and will not warn on <a href="https://groups.google.com/d/msg/rubyonrails-security/CdoMUVpsRmQ/iFRwR1xPym8J">CVE-2012-1099</a> and <a href="https://groups.google.com/d/msg/rubyonrails-security/tfp6gZCtzr4/j8LUHmu7fIEJ">CVE-2014-0081</a> for applications using the appropriate RailsLTS versions.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/481">changes</a>)</p>

<h3 id="protected-attributes-gem">Protected Attributes Gem</h3>

<p>Brakeman now treats applications using the <code class="highlighter-rouge">protected_attributes</code> gem as if mass assignment is enabled by default and <code class="highlighter-rouge">attr_accessible</code> is necessary to protect models.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/477">changes</a>)</p>

<h3 id="sql-injection-in-scopes">SQL Injection in Scopes</h3>

<p>There was a bug which caused Brakeman not warn about SQL injection in chained calls inside scope blocks (<a href="https://github.com/presidentbeef/brakeman/issues/471">example here</a>). Additionally, scope calls were not being handled for Rails 4.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/472">changes</a>)</p>

<h3 id="hosts-in-redirects">Hosts in Redirects</h3>

<p>Brakeman should no longer warn about instances of <code class="highlighter-rouge">redirect_to</code> when <code class="highlighter-rouge">:host</code> is explicitly specified.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/465">changes</a>)</p>

<h3 id="sql-injection-in-all-select-arguments">SQL Injection in All Select Arguments</h3>

<p>Brakeman was only checking the first argument to <code class="highlighter-rouge">Model.select</code> for SQL injection, but the method can take multiple arguments. This release corrects this to check all of the arguments.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/468">changes</a>)</p>

<h3 id="sql-injection-cves-moved-to-separate-check">SQL Injection CVEs Moved to Separate Check</h3>

<p>All the checks for SQL injection CVEs have been moved from <code class="highlighter-rouge">CheckSQL</code> to <code class="highlighter-rouge">CheckSQLCVEs</code>. This should only have an effect for users explicitly specifying to run or skip <code class="highlighter-rouge">CheckSQL</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/478">changes</a>)</p>

<h3 id="more-routing-fixes">More Routing Fixes</h3>

<p>More instances of non-literals in routes will be ignored instead of raising exceptions. In general, information from <code class="highlighter-rouge">routes.rb</code> is not used except to warn about default routes (unless <code class="highlighter-rouge">--no-assume-routes</code> is used).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/462">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fc8a7991e9351f8d5e26a59acf54422a638f4866  brakeman-2.5.0.gem
48f974aaf40957a325ee778d3d700fd29aa526bf  brakeman-min-2.5.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2014/03/22/brakeman-2-dot-4-3-released">Brakeman 2.4.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2014-03-22 17:49:00 -0700" pubdate  updated >2014-03-22 17:49:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>A new gem version has been released because the 2.4.2 gem was not signed. No other changes were introduced.</p>

<h3 id="signed-gems">Signed Gems</h3>

<p>As a reminder, the Brakeman gems are (supposed to be) signed and can be verified with <a href="https://github.com/presidentbeef/brakeman/blob/master/brakeman-public_cert.pem">this certificate</a>.</p>

<p>To verify on installation:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem cert --add &lt;(curl -Ls https://raw.github.com/presidentbeef/brakeman/master/brakeman-public_cert.pem)
gem install brakeman -P MediumSecurity
</code></pre></div></div>

<p>“HighSecurity” requires all dependencies to be signed as well, which is unlikely.</p>

<p>There is some weirdness around <code class="highlighter-rouge">-P MediumSecurity</code> currently. The simplest solution seems to be:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem install brakeman   # Install Brakeman and all dependencies
gem uninstall brakeman # Remove the Brakeman gem
gem install brakeman -P MediumSecurity  # Install Brakeman gem and check signature
</code></pre></div></div>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>16b4890fa8ee6bad1d429a12bf3f0cb8e76cb2d8  brakeman-2.4.3.gem
be5743d77140e64b75eefc53f8697f767ab370d9  brakeman-min-2.4.3.gem 
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2014/03/20/brakeman-2-dot-4-2-released">Brakeman 2.4.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2014-03-20 22:37:00 -0700" pubdate  updated >2014-03-20 22:37:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release is only internal changes and bug fixes, but some scans may see significant time and memory improvements.</p>

<p><em>Changes since 2.4.1</em>:</p>

<ul>
  <li>Skip identically rendered templates</li>
  <li>Improve HAML template processing</li>
  <li>Only track original template output locations</li>
  <li>Reuse duplicate call location information</li>
  <li>Fix duplicate warnings about sanitize CVE</li>
  <li>Remove <code class="highlighter-rouge">rescue Exception</code></li>
</ul>

<h3 id="drop-identical-templates">Drop Identical Templates</h3>

<p>For a long time now Brakeman has skipped processing templates if the template had already been processed with an identical environment. However, there are many times when a template is rendered with different environments but the actual output is the same. Brakeman now drops these templates (they are rendered, then discarded if they are duplicates). This reduces peak memory overhead, sometimes drastically. It can also speed up call indexing and vulnerability checks since fewer templates are searched.</p>

<p>The location and render path of template warnings may change slightly due to this change. Also, the rendered template debug output will no longer include all rendered templates since duplicates will not be tracked.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/442">changes</a>)</p>

<h3 id="better-haml-processing">Better HAML Processing</h3>

<p>HAML templates will be processed more accurately with this release.</p>

<p>For example, a template like this</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#content
  .nav
    = @navigation_menu
</code></pre></div></div>

<p>used to produce output like</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-------------------------------------------------------------------------------------------------+
| Output                                                                                          |
+-------------------------------------------------------------------------------------------------+
| [Output] "&lt;div id='content'&gt;; &lt;div class='nav'&gt;; #{[Escaped] @navigation_menu}; &lt;/div&gt;;&lt;/div&gt;;" |
+-------------------------------------------------------------------------------------------------+
</code></pre></div></div>

<p>but now it will look like this instead</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+-----------------------------------+
| Output                            |
+-----------------------------------+
| [Escaped Output] @navigation_menu |
+-----------------------------------+
</code></pre></div></div>

<p>Besides looking much nicer, this improves warnings and reduces how much code Brakeman has to search. Additionally, these <code class="highlighter-rouge">push_text</code> methods can often interpolate multiple values into the output string, which were not being properly detected as output. This is fixed now.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/441">changes</a>)</p>

<h3 id="duplicate-template-outputs">Duplicate Template Outputs</h3>

<p>Aliased values in templates were being counted multiple times as output. This did not affect warnings generated, but it did create duplicate output values to check and extraneous debug output.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/443">changes</a>)</p>

<h3 id="call-location-reuse">Call Location Reuse</h3>

<p>For large applications, many calls in the call index actually have the same location (class+method or template). Instead of creating a new location hash for each call, the locations are cached and reused.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/444">changes</a>)</p>

<h3 id="sanitize-cve-duplicates">Sanitize CVE Duplicates</h3>

<p>Don’t worry - <a href="https://groups.google.com/d/msg/rubyonrails-security/zAAU7vGTPvI/1vZDWXqBuXgJ">CVE-2013-1857</a> is one year old this week. But Brakeman was not properly preventing duplicate warnings for it. Hopefully this was affecting exactly no one.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/445">changes</a>)</p>

<h3 id="narrower-exception-handling">Narrower Exception Handling</h3>

<p>All instances of <code class="highlighter-rouge">rescue Exception</code> were removed from Brakeman and replaced with bare <code class="highlighter-rouge">rescue</code>s to catch <code class="highlighter-rouge">StandardError</code> and subclasses. <code class="highlighter-rouge">Exception</code> has some unfortunate subclasses, such as <code class="highlighter-rouge">NoMemoryError</code> and <code class="highlighter-rouge">Interrupt</code> which Brakeman should not be rescuing.</p>

<p>This does mean there may be some newly unhandled exceptions. Please report these so they can be rescued properly.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/446">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>02842dc497bf22b5b427cfd02635c005c4fc4fd4  brakeman-2.4.2.gem
4893cedbcb015e96c82f4777b00a49ca8d0ae22f  brakeman-min-2.4.2.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2014/02/19/brakeman-2-dot-4-1-released">Brakeman 2.4.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2014-02-19 10:53:00 -0800" pubdate  updated >2014-02-19 10:53:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release only adds checks for the latest CVEs, no other changes.</p>

<p><em>Changes since 2.4.0</em>:</p>

<ul>
  <li>Add check for CVE-2014-0080</li>
  <li>Add check for CVE-2014-0081, replaces CVE-2013-6415</li>
  <li>Add check for CVE-2014-0082</li>
</ul>

<h3 id="cve-2014-0080">CVE-2014-0080</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/Wu96YkTUR6s/pPLBMZrlwvYJ">CVE-2014-0080</a> is a SQL injection issue only affects applications using PostgreSQL with Rails 4.x. If Brakeman detects the <code class="highlighter-rouge">pg</code> gem and an affected version, it will warn about this CVE.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/447">changes</a>)</p>

<h3 id="cve-2014-0081">CVE-2014-0081</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/tfp6gZCtzr4/j8LUHmu7fIEJ">CVE-2014-0081</a> is a vulnerability in <code class="highlighter-rouge">number_to_currency</code>, <code class="highlighter-rouge">number_to_percentage</code>, and <code class="highlighter-rouge">number_to_human</code>. Values passed in as options may not be properly escaped. It affects all previous versions of Rails.</p>

<p>Brakeman will warn on unsafe uses of these methods. If no unsafe calls are found, it will generate a generic medium confidence warning.</p>

<p>Warnings for CVE-2014-0081 replace warnings for CVE-2013-6415, which was about just <code class="highlighter-rouge">number_to_currency</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/448">changes</a>)</p>

<h3 id="cve-2014-0082">CVE-2014-0082</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/LMxO_3_eCuc/ozGBEhKaJbIJ">CVE-2014-0082</a> is a potential symbol denial of service problem when handling <code class="highlighter-rouge">render :text</code> in Rails 3.x.</p>

<p>Brakeman will only warn about this CVE if it detects use of <code class="highlighter-rouge">render :text</code> in affected versions.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/449">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>e9fb5439d5a322b4a9c9611d75d994e7df83d4d2  brakeman-2.4.1.gem
b84ad90a7ec9b6e6bbce8fc69c50d1d8b3214d0f  brakeman-min-2.4.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter or joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2014/02/05/brakeman-2-dot-4-0-released">Brakeman 2.4.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2014-02-05 01:15:00 -0800" pubdate  updated >2014-02-05 01:15:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a fairly big release with some significant changes (especially for SQL injection warnings), so please test carefully. Existing warnings and fingerprints may change.</p>

<p><em>Changes since 2.3.1:</em></p>

<ul>
  <li>Fingerprint attribute warnings individually (<a href="https://github.com/ctaintor">Case Taintor</a>)</li>
  <li>Add check for uses of <code class="highlighter-rouge">OpenSSL::SSL::VERIFY_NONE</code> (<a href="https://github.com/abedra/">Aaron Bedra</a>)</li>
  <li>Detect SQL injection raw SQL queries using <code class="highlighter-rouge">connection</code>(<a href="https://github.com/presidentbeef/brakeman/issues/434">#434</a>)</li>
  <li>Fix false positives when SQL methods are not called on AR models (<a href="https://github.com/presidentbeef/brakeman/issues/423">#423</a>, <a href="https://github.com/abedra/">Aaron Bedra</a>)</li>
  <li>Reduce false positives for SQL injection in string building</li>
  <li>More accurate user input marking for SQL injection warnings</li>
  <li>Detect SQL injection in <code class="highlighter-rouge">delete_all</code>/<code class="highlighter-rouge">destroy_all</code></li>
  <li>Add support for Rails LTS versions (<a href="https://github.com/presidentbeef/brakeman/issues/422">#422</a>)</li>
  <li>Parse exact versions from Gemfile.lock for all gems (<a href="https://github.com/presidentbeef/brakeman/issues/431">#431</a>)</li>
  <li>Ignore generators in <code class="highlighter-rouge">lib/</code> directory</li>
  <li>No longer raise exceptions if a class name cannot be determined</li>
  <li>Update to RubyParser 3.4.0</li>
</ul>

<h3 id="attribute-warning-fingerprints">Attribute Warning Fingerprints</h3>

<p><a href="https://github.com/ctaintor">Case Taintor</a> noted that ignoring one warning about dangerous mass assignable attributes ignored all such warnings for the same model. Then he fixed it, yay!</p>

<p>Please note this means fingerprints for warnings about “dangerous attributes” in <code class="highlighter-rouge">attr_accessible</code> will change. If you are currently ignoring some of these warnings, you will need to re-ignore them.</p>

<p>Also, the messages for these warnings have changed and the attribute name will now be in the “code” value in JSON reports.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/416">changes</a>)</p>

<h3 id="check-for-ssl-verification">Check for SSL Verification</h3>

<p><a href="https://github.com/abedra/">Aaron Bedra</a> has contributed a new check for instances of <code class="highlighter-rouge">verify_mode</code> on HTTPS connections being set to <code class="highlighter-rouge">OpenSSL::SSL::VERIFY_NONE</code>. This bypasses any checks OpenSSL has for verifying the SSL certificate is legitimate, allowing easy man-in-the-middle attacks.</p>

<p>This new check has a new warning type (“SSL Verification Bypass”) and warning code (71).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/419">changes</a>)</p>

<h3 id="sql-injection-in-raw-queries">SQL Injection in Raw Queries</h3>

<p><code class="highlighter-rouge">ActiveRecord::Core#connection</code> or <code class="highlighter-rouge">ActiveRecord::Base.connection</code> or <code class="highlighter-rouge">ActiveRecord::Base#connection</code> can be used to send queries directly to the database connection without any protection. There are several ways of doing this, most of which are hopefully now covered by Brakeman.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/438">changes</a>)</p>

<h3 id="fewer-sql-injection-false-positives">Fewer SQL Injection False Positives</h3>

<p>Many changes were made in this release to reduce false positives related to SQL injection warnings and to improve the accuracy of reported issues.</p>

<p>First, <a href="https://github.com/abedra/">Aaron Bedra</a> fixed Brakeman to not warn about query-like methods that were innocently called on non-ActiveRecord objects. (<a href="https://github.com/presidentbeef/brakeman/pull/426">changes</a>)</p>

<p>For example, this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>find_by_sql("SELECT * FROM stuff WHERE thing = " + self.class.sanitize_sql(thing))
</code></pre></div></div>

<p>would have generated a warning which indicated <code class="highlighter-rouge">"SELECT * FROM stuff WHERE thing = " + self.class.sanitize_sql(thing)</code> was a dangerous value. Now it will not warn at all.</p>

<p>As another example, code like this</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>options = {}

if params[:sort_order] == 'ascending'
  sort_order = 'ASC'
else
  sort_order = 'DESC'
end

options[:order] = 'updated_at ' + sort_order
Test.all(options)
</code></pre></div></div>

<p>would create a warning about <code class="highlighter-rouge">("updated_at " + ("ASC" or "DESC"))</code>. Now Brakeman will recognize that these are all just strings and not warn.</p>

<p>Many warnings will also just be more accurate:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>query = "SELECT sum(stuff) " +
      "FROM (SELECT other_stuff FROM #{table} WHERE id = #{id}) " +
      "AS item, bgs " +
      "WHERE ST_Contains(item.geometry, bgs.the_point);"

Test.find_by_sql(query)
</code></pre></div></div>

<p>This used to warn on the entire query! Now it will just warn about <code class="highlighter-rouge">table</code>.</p>

<p><code class="highlighter-rouge">#to_s</code> calls are ignored now and their targets considered instead.</p>

<p>Additionally, Brakeman should no longer warn about method calls ending in <code class="highlighter-rouge">_id</code>, since those generally refer to foreign keys. Note, however, that local variables ending in <code class="highlighter-rouge">_id</code> will still produce warnings.</p>

<p>In general, fingerprints should not change for existing warnings, since the <code class="highlighter-rouge">user_input</code> value is not included in the fingerprint.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/440">changes</a>)</p>

<h3 id="sql-injection-in-deletions">SQL Injection in Deletions</h3>

<p>Brakeman will now look for SQL injection in <code class="highlighter-rouge">delete_all</code> and <code class="highlighter-rouge">destroy_all</code> which allow raw SQL strings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/438">changes</a>)</p>

<h3 id="support-for-rails-lts">Support for Rails LTS</h3>

<p><a href="https://railslts.com/">RailsLTS</a> provides security patch backporting to Rails 2.3.18. They now <a href="http://makandracards.com/railslts/21809-how-to-find-out-your-current-rails-lts-version">include an internal version number</a> in <code class="highlighter-rouge">Gemfile.lock</code>, which allows Brakeman to avoid warning about fixed vulnerabilities in applications using RailsLTS.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/437">changes</a>)</p>

<h3 id="gemfile-parsing">Gemfile Parsing</h3>

<p>Previously, Brakeman only checked <code class="highlighter-rouge">Gemfile.lock</code> for specific gems. Now it “parses” the entire file and can track all gem versions. (<a href="https://github.com/rubysec/bundler-audit">bundler-audit</a> is recommended for checking gems for vulnerable versions.) This helps when Brakeman is checking for gem usage but the gem is an indirect dependency.</p>

<p>Also, a minor issue was fixed for those <code class="highlighter-rouge">Gemfile</code>s that do weird things and call <code class="highlighter-rouge">gem</code> with non-string arguments.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/432">changes</a>)</p>

<h3 id="generators-are-ignored">Generators are Ignored</h3>

<p>Any path in <code class="highlighter-rouge">lib/</code> containing <code class="highlighter-rouge">generators</code> will now be ignored. This is mainly because there are <code class="highlighter-rouge">.rb</code> files in there that are actually templates, but Brakeman tries to parse them and fails because they aren’t really Ruby.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/427">changes</a>)</p>

<h3 id="exceptions-for-class-names">Exceptions for Class Names</h3>

<p>Previously, Brakeman actually raised and caught exceptions if a class name could not be determined from a <code class="highlighter-rouge">Sexp</code>. Now it just returns <code class="highlighter-rouge">nil</code>. This should remove some errors and possibly make some scans faster.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/417">changes</a>)</p>

<h3 id="rubyparser-update">RubyParser Update</h3>

<p>The RubyParser dependency has been updated to 3.4.0. This release is <em>much</em> faster, along with <a href="http://blog.zenspider.com/releases/2014/02/ruby_parser-version-3-4-0-has-been-released.html">lots of other good changes</a>.</p>

<p>However, please note that line numbers for warnings involving heredocs may change. They will be slightly closer, but not exactly accurate.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/commit/29239377a79bafbaddfa7664e1570d4c1f3982b5">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<p>c9d840b6fca08f61b3abbd1fa109cf66be19fccc  brakeman-2.4.0.gem
5bad89c43f7ab78bd40dfd6f71aac3d034ccaa0a  brakeman-min-2.4.0.gem</p>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter or joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
<script type='text/javascript'>
    $(document).ready(function(){
        $("#github").GitHubBadge({
          login: "presidentbeef",
          kind: "project",
          repo_name: "brakeman",
          include_github_logo: false,
          image_path: "",
          commit_count: "1",
          issue_count: "0",
          repo_count: "0"
      });
    });
</script>
<div id="github"></div>
<a href="https://travis-ci.org/#!/presidentbeef/brakeman"><img src="https://secure.travis-ci.org/presidentbeef/brakeman.png" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">Brakeman 5.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/01/30/5-dot-2-dot-1-released">Brakeman 5.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/12/15/brakeman-5-dot-2-dot-0-released">Brakeman 5.2.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/28/brakeman-5-dot-1-dot-2-released">Brakeman 5.1.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/07/19/brakeman-5-dot-1-dot-0-released">Brakeman 5.1.0 Released</a>
      </li>
    
  </ul>
</section>

  <section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <a class="twitter-timeline" data-dnt=true href="https://twitter.com/brakeman" data-widget-id="258654953097273345">Tweets by @brakeman</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
