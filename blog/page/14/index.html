
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/14/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/08/30/brakeman-3-dot-1-0-released">Brakeman 3.1.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-08-30 21:46:00 -0600" pubdate  updated >2015-08-30 21:46:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>There are several changes in this release which may affect consumers of the JSON report as well as anyone relying on the ignore configuration file. Please try out <a href="https://gist.github.com/presidentbeef/52d5cce0fd26b901179e">this script</a> to migrate ignore configurations.</p>

<p>Additionally, some dependencies have been updated to versions no longer supporting Ruby 1.8. As a consequence, Brakeman no longer runs “out of the box” on Ruby 1.8, although you may be able to use the <code class="language-plaintext highlighter-rouge">brakeman-min</code> gem. No more attempts will be made to support running on Ruby 1.8 in future releases. Please note that does not mean Ruby 1.8 code cannot be analyzed; that still works fine.</p>

<p><em>Changes since 3.0.5</em>:</p>

<ul>
  <li>Update dependencies to Ruby 1.8 incompatible versions</li>
  <li>Update render path information in JSON reports</li>
  <li>Remove renaming of several <code class="language-plaintext highlighter-rouge">Sexp</code> nodes</li>
  <li>Treat <code class="language-plaintext highlighter-rouge">html_safe</code> like <code class="language-plaintext highlighter-rouge">raw</code></li>
  <li>Use railties version if rails gem is missing (<a href="https://github.com/lucasmazza">Lucas Mazza</a>)</li>
  <li>Warn about unverified SSL mode in <code class="language-plaintext highlighter-rouge">Net::HTTP.start</code></li>
  <li>Expand XSS safe methods</li>
  <li>Avoid warning on path creation methods in <code class="language-plaintext highlighter-rouge">link_to</code></li>
  <li>Add support for <code class="language-plaintext highlighter-rouge">gems.rb</code>/<code class="language-plaintext highlighter-rouge">gems.locked</code> (<a href="https://github.com/presidentbeef/brakeman/pull/705">#705</a>)</li>
  <li>Fix low confidence XSS warning code</li>
  <li>Avoid duplicate <code class="language-plaintext highlighter-rouge">eval</code> warnings</li>
  <li>Convert YAML config keys to symbols (<a href="https://github.com/KarlGl">Karl Glaser</a>)</li>
</ul>

<h3 id="ruby-18-incompatibility">Ruby 1.8 Incompatibility</h3>

<p>Ruby 1.8.7 has been unsupported by the Ruby core team for over a year now (and that was after it had a six month extension). Several libraries Brakeman depends on have stopped supporting Ruby 1.8. Unfortunately, there is no way to specify depending on different gem versions for different Ruby versions. This left Brakeman in a difficult place - use old libraries (and cause conflicts in Gemfiles…), use new libraries (and lose 1.8 support), or don’t declare dependencies (and force users to install dependencies themselves). In the end, it seems most people are okay with dropping Ruby 1.8 support.</p>

<p>That being said, Brakeman 3.1.0 should run fine on Ruby 1.8 if dependencies are set up manually to be compatible.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/684">changes</a>)</p>

<h3 id="render-path-improvements">Render Path Improvements</h3>

<p>Previously, render paths were arrays of strings. The strings represented the locations of calls to <code class="language-plaintext highlighter-rouge">render</code> (implicit or explicit), either in the form <code class="language-plaintext highlighter-rouge">&lt;Controller&gt;#&lt;method&gt;</code> or <code class="language-plaintext highlighter-rouge">Template:&lt;template/path&gt;</code>. While the information was somewhat useful to humans, it was not easily manipulated by computers and it was difficult to link the strings back to application code.</p>

<p>Now, render paths are arrays of hashes. The hash has a <code class="language-plaintext highlighter-rouge">type</code> key with a value of either <code class="language-plaintext highlighter-rouge">controller</code> or <code class="language-plaintext highlighter-rouge">template</code>. For controllers, the hash includes <code class="language-plaintext highlighter-rouge">class</code>, <code class="language-plaintext highlighter-rouge">method</code>, <code class="language-plaintext highlighter-rouge">line</code>, and <code class="language-plaintext highlighter-rouge">file</code>. For templates, the hash includes <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">line</code>, and <code class="language-plaintext highlighter-rouge">file</code>.</p>

<p>Example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[
  {
    "type": "controller",
    "class": "ProductsController",
    "method": "create",
    "line": 50,
    "file": "app/controllers/products_controller.rb"
  },
  {
    "type": "template",
    "name": "products/new",
    "line": 2,
    "file": "app/views/products/new.html.erb"
  }
]
</code></pre></div></div>

<p>Implicit renders from controller actions point to the line at the end of the method.</p>

<p>Rendered templates in JSON reports used to include the render location as well. For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"location": {
  "type": "template",
  "template": "home/index (HomeController#index)"
}
</code></pre></div></div>

<p>Since this information is redundant with the render path, it has been removed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/702">changes</a>)</p>

<h3 id="s-expression-names">S-Expression Names</h3>

<p>Starting a long time ago, Brakeman rewrote several s-expression names for no reason other than clarity (for example, <code class="language-plaintext highlighter-rouge">dstr</code> becomes <code class="language-plaintext highlighter-rouge">string_interp</code>). However, not all nodes were changed, leading to code that must check for both the original name from RubyParser and Brakeman’s name. This leads to messy code and subtle bugs.</p>

<p>The following node names were removed: <code class="language-plaintext highlighter-rouge">string_interp</code>, <code class="language-plaintext highlighter-rouge">string_eval</code>, <code class="language-plaintext highlighter-rouge">methdef</code>, <code class="language-plaintext highlighter-rouge">selfdef</code>, <code class="language-plaintext highlighter-rouge">call_with_block</code>.</p>

<p>While this seems like a silly internal change, it will unfortunately change any fingerprints containing these node types. A <a href="https://gist.github.com/presidentbeef/52d5cce0fd26b901179e">quick script is available</a> to migrate ignore files without having to manually update the fingerprints.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/701">changes</a>)</p>

<h3 id="html_safe">html_safe</h3>

<p>As we hopefully all know now, <code class="language-plaintext highlighter-rouge">html_safe</code> is not safe, it marks a string so it is <em>not</em> escaped when output in a template. Since this is essentially the same as calling <code class="language-plaintext highlighter-rouge">raw</code> on a string, Brakeman will treat them both as unescaped output.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/675">changes</a>)</p>

<h3 id="use-railties-version">Use railties Version</h3>

<p>Thanks to <a href="https://github.com/lucasmazza">Lucas Mazza</a>, if an application depends on <code class="language-plaintext highlighter-rouge">railties</code> instead of <code class="language-plaintext highlighter-rouge">rails</code>, Brakeman will now use the gem version of <code class="language-plaintext highlighter-rouge">railties</code> as the Rails version.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/695/files">changes</a>)</p>

<h3 id="ssl-verify-mode">SSL Verify Mode</h3>

<p>As suggested by <a href="https://github.com/gmcnaughton">Gordon McNaughton</a>, Brakeman now warns when SSL certificate verification is turned off in calls to <code class="language-plaintext highlighter-rouge">Net::HTTP.start</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/694">changes</a>)</p>

<h3 id="safe-methods">Safe Methods</h3>

<p>The <code class="language-plaintext highlighter-rouge">--safe-methods</code> option (which only applies to XSS warnings) and <code class="language-plaintext highlighter-rouge">--url-safe-methods</code> (which applies to values pass to <code class="language-plaintext highlighter-rouge">link_to</code>) now work on methods that have a target. For example, <code class="language-plaintext highlighter-rouge">--url-safe-methods this_is_safe</code> will ignore <code class="language-plaintext highlighter-rouge">link_to util.this_is_safe(params[:x])</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/674">changes</a>)</p>

<h3 id="more-safe-methods">More Safe Methods</h3>

<p>Brakeman warns about user input in the href parameter of <code class="language-plaintext highlighter-rouge">link_to</code> because it is possible to pass in a string starting with <code class="language-plaintext highlighter-rouge">javascript:</code>, which will execute the XSS payload when the victim clicks on it. However, it will no longer warn about methods that look like path helpers or URL generation methods. It will still warn about URL methods on models, since those may be direct user input.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/674">changes</a>)</p>

<h3 id="gemsrbgemslocked">gems.rb/gems.locked</h3>

<p><code class="language-plaintext highlighter-rouge">gems.rb</code>/<code class="language-plaintext highlighter-rouge">gems.locked</code> are alternative names for <code class="language-plaintext highlighter-rouge">Gemfile</code>/<code class="language-plaintext highlighter-rouge">Gemfile.lock</code>. Brakeman now supports either pair.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/705">changes</a>)</p>

<h3 id="weak-confidence-xss-warnings">Weak Confidence XSS Warnings</h3>

<p>A small bug caused weak confidence XSS warnings to have a warning code of <code class="language-plaintext highlighter-rouge">5</code> (which is for unescaped JSON) instead of <code class="language-plaintext highlighter-rouge">2</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/commit/9fec336e7cbbbb74add9ef9c6c90c65efa0ebcc7">changes</a>)</p>

<h3 id="duplicate-eval-warnings">Duplicate Eval Warnings</h3>

<p>There should now be fewer duplicate warnings about dangerous calls to <code class="language-plaintext highlighter-rouge">eval</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/670/files">changes</a>)</p>

<h3 id="configuration-keys">Configuration Keys</h3>

<p><a href="https://github.com/KarlGl">Karl Glaser</a> added a change so Brakeman configuration files may use string or symbol keys in the YAML file. However, it is recommended to use <code class="language-plaintext highlighter-rouge">brakeman -C</code> to generate configurations automatically, because writing YAML by hand is annoying.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/696">changes</a>)</p>

<h3 id="internal-changes">Internal Changes</h3>

<p>Internally, most of the information Brakeman tracks is kept in hash tables. This is changing, starting with the addition of <code class="language-plaintext highlighter-rouge">Controller</code>, <code class="language-plaintext highlighter-rouge">Model</code>, <code class="language-plaintext highlighter-rouge">Template</code>, and <code class="language-plaintext highlighter-rouge">Config</code> classes.</p>

<p>Unfortunately, this will probably break any code that relies on Brakeman’s internals (such as custom checks).</p>

<p>Fortunately, in almost all cases it will simplify code and in many cases it just means changing a hash access (like <code class="language-plaintext highlighter-rouge">template[:name]</code>) to a method call (<code class="language-plaintext highlighter-rouge">template.name</code>).</p>

<p>See <a href="https://github.com/presidentbeef/brakeman/pull/690">the pull request</a> for examples.</p>

<p>Also note this is just the beginning of these internal changes…sorry! Hopefully this leads to improvements and makes it easier to write Brakeman code.</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>236af597e5cbcc0e647c02c4087ceb5965510435  brakeman-3.1.0.gem
fe06faf67e781c4c4dc5ee362918ef2dfd8e1ce2  brakeman-min-3.1.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/06/19/brakeman-3-dot-0-5-released">Brakeman 3.0.5 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-06-19 18:09:00 -0600" pubdate  updated >2015-06-19 18:09:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>And this is why you don’t rush out releases.</p>

<p><em>Changes since 3.0.4</em>:</p>

<ul>
  <li>Fix check for CVE-2015-3227 (<a href="https://github.com/presidentbeef/brakeman/issues/667">#667</a>)</li>
</ul>

<h3 id="fix-cve-2015-3227-check">Fix CVE-2015-3227 Check</h3>

<p>Includes information that Rails 3.2.22 is the fix version for anything before Rails 4.0. Fixes warning message when exact Rails version cannot be determined. Fixes link URL to point to the CVE announcement.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/668">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>b78e11b745128ed7f9acd5d0c4f5e0e3a81f4d07  brakeman-min-3.0.5.gem
c62cc782595d4995aa385b6bd96c2485ac932077  brakeman-3.0.5.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/06/18/brakeman-3-dot-0-4-released">Brakeman 3.0.4 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-06-18 10:50:00 -0600" pubdate  updated >2015-06-18 10:50:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a small release prompted by Tuesday’s CVE announcements. New checks for the CVEs directly in Rails have been added, and can also test for the suggested workarounds. Please consider using <a href="https://github.com/rubysec/bundler-audit">bundler-audit</a> for detecting known vulnerable versions of gems, as Brakeman has only limited coverage.</p>

<p>Note this release also upgrades the RubyParser dependency. The latest RubyParser has several bug fixes and initial support for new Ruby 2.2 syntax.</p>

<p><em>Changes since 3.0.3</em>:</p>

<ul>
  <li>Add check for CVE-2015-3226 (XSS via JSON keys)</li>
  <li>Add check for CVE-2015-3227 (XML DoS)</li>
  <li>Treat <code class="language-plaintext highlighter-rouge">&lt;%==</code> as unescaped output (<a href="https://github.com/presidentbeef/brakeman/issues/661">#661</a>)</li>
  <li>Update <code class="language-plaintext highlighter-rouge">ruby_parser</code> dependency to 3.7.0</li>
</ul>

<h3 id="cross-site-scripting-in-json">Cross Site Scripting in JSON</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/7VlB_pck3hU/3QZrGIaQW6cJ">CVE-2015-3226</a> is an issue with converting hashes to JSON. The keys do not properly escape HTML entities, leading to potential cross site scripting vulnerabilities. Brakeman will warn unless the workaround is included in an initializer (essentially verbatim). The warning is high confidence if there is evidence of explicitly converting values to JSON, otherwise medium.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/665">changes</a>)</p>

<h3 id="xml-denial-of-service">XML Denial of Service</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/bahr2JLnxvk/x4EocXnHPp8J">CVE-2015-3227</a> is a potential denial of service when parsing deeply nested XML requests. Brakeman will warn about this unless there is an initializer changing the XML parser as described in the CVE. Currently it looks for either <code class="language-plaintext highlighter-rouge">LibXML</code> or <code class="language-plaintext highlighter-rouge">Nokogiri</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/666">changes</a>)</p>

<h3 id="double-equals-is-unescaped-output">Double Equals is Unescaped Output</h3>

<p>Brakeman will now treat <code class="language-plaintext highlighter-rouge">&lt;%== x %&gt;</code> in ERB templates as unescaped output.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/663">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bf6ae72a0b516ecf65b9165d07e86259ef9fa5d3  brakeman-3.0.4.gem
c1c2ea5402d8a89fe4a645947ec324d0603d3976  brakeman-min-3.0.4.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/04/30/brakeman-3-dot-0-3-released">Brakeman 3.0.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-04-30 09:50:00 -0600" pubdate  updated >2015-04-30 09:50:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is mostly a bug fix release, but does introduce a new warning code for when <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> is not set to raise exceptions in Rails 4.</p>

<p><em>Changes since 3.0.2</em>:</p>

<ul>
  <li>Warn about <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> without exceptions (<a href="https://github.com/oreoshake">Neil Matatall</a>)</li>
  <li>Add Rake task to exit with error code on warnings (<a href="https://github.com/masarakki">masarakki</a>)</li>
  <li>Ignore <code class="language-plaintext highlighter-rouge">quoted_table_name</code> in SQL (<a href="https://github.com/sobrinho">Gabriel Sobhrinho</a>)</li>
  <li>Ignore more Arel methods in SQL (<a href="https://github.com/presidentbeef/brakeman/issues/604">#604</a>)</li>
  <li>Warn about RCE and file access with <code class="language-plaintext highlighter-rouge">open</code></li>
  <li>Handle <code class="language-plaintext highlighter-rouge">Array#include?</code> guard conditionals (<a href="https://github.com/presidentbeef/brakeman/issues/604">#604</a>)</li>
  <li>Handle lambdas as filters</li>
  <li>Do not ignore targets of <code class="language-plaintext highlighter-rouge">to_s</code> in SQL (<a href="https://github.com/presidentbeef/brakeman/issues/638">#638</a>)</li>
</ul>

<h3 id="new-csrf-warning">New CSRF Warning</h3>

<p><a href="https://github.com/oreoshake">Neil Matatall</a> has added a warning for Rails 4 applications that do not pass the <code class="language-plaintext highlighter-rouge">with: :exception</code> option to <code class="language-plaintext highlighter-rouge">protect_from_forgery</code>. The default behavior of clearing out the session (but still processing the request) has lead to vulnerabilities in some applications. GitHub <a href="https://bounty.github.com/researchers/LukasReschke.html">recently awarded a bug bounty</a> for a vulnerability caused by this behavior.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/648">changes</a>)</p>

<h3 id="additional-rake-task">Additional Rake Task</h3>

<p><a href="https://github.com/masarakki">Masarakki</a> added a Rake task that will exit with an error code if any warnings are found (like <code class="language-plaintext highlighter-rouge">brakeman -z</code>). The task can be run with <code class="language-plaintext highlighter-rouge">rake brakeman:check</code>.</p>

<p>However, please note the use of Rake tasks to run Brakeman is discouraged, since it loads the entire Rails application which is unnecessary and may cause conflicts with Brakeman dependencies.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/637">changes</a>)</p>

<h3 id="reduce-sql-injection-false-positives">Reduce SQL Injection False Positives</h3>

<p>A patch from <a href="https://github.com/sobrinho">Gabriel Sobhrinho</a> removes warnings about <code class="language-plaintext highlighter-rouge">quoted_table_name</code> in SQL queries.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/647">changes</a>)</p>

<p>An additional change was made to ignore more Arel methods nested inside of other queries. This should reduce many of the false positives seen with combining Arel and ActiveRecord queries.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/653">changes</a>)</p>

<h3 id="remote-code-execution-in-open">Remote Code Execution in open()</h3>

<p>As noted in <a href="http://sakurity.com/blog/2015/02/28/openuri.html">Egor Homakov’s blog post</a>, <code class="language-plaintext highlighter-rouge">open</code> can actually be used to spawn new processes by starting the argument with a pipe <code class="language-plaintext highlighter-rouge">|</code>. Brakeman will now warn about remote code execution via <code class="language-plaintext highlighter-rouge">open</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/643">changes</a>)</p>

<h3 id="simple-guard-conditions">Simple Guard Conditions</h3>

<p>Brakeman should now recognize guard conditions that look exactly like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if [1, 2, "a", "b"].include? x
  do_something_dangerous_with x
end
</code></pre></div></div>

<p>This may resolve some false positives. If you have code similar to this, please consider <a href="https://github.com/presidentbeef/brakeman/issues">opening an issue</a> and perhaps it can be handled similarly.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/640">changes</a>)</p>

<h3 id="lambda-filters">Lambda Filters</h3>

<p>Filters that use lambdas instead of blocks should now be handled correctly.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/649">changes</a>)</p>

<h3 id="handle-to_s-in-sql">Handle to_s in SQL</h3>

<p>Values with <code class="language-plaintext highlighter-rouge">to_s</code> called on them were being ignored when checking for SQL injection. This has been fixed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/639">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>170c3dd6925373b7da2e27fd1decf2957b35dc43  brakeman-3.0.3.gem
f126e305404a61e99f9ddb848996d87325d1485a  brakeman-min-3.0.3.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/03/09/brakeman-3-dot-0-2-released">Brakeman 3.0.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-03-09 14:54:00 -0600" pubdate  updated >2015-03-09 14:54:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is entirely a bugfix release, no new features. However, the fixes may cause line numbers and warning fingerprints to change.</p>

<p><em>Changes since 3.0.1</em>:</p>

<ul>
  <li>Fix HTML reports with GitHub repos (<a href="https://github.com/presidentbeef/brakeman/issues/624">#624</a>)</li>
  <li>Handle processing of explictly shadowed block arguments (<a href="https://github.com/presidentbeef/brakeman/issues/612">#612</a>)</li>
  <li>Fix CSV output when there are no warnings (<a href="https://github.com/presidentbeef/brakeman/issues/615">#615</a>)</li>
  <li>Update <code class="language-plaintext highlighter-rouge">ruby_parser</code> to ~&gt; 3.6.2</li>
  <li>Treat <code class="language-plaintext highlighter-rouge">primary_key</code>, <code class="language-plaintext highlighter-rouge">table_name_prefix</code>, <code class="language-plaintext highlighter-rouge">table_name_suffix</code> as safe in SQL</li>
  <li>Fix using <code class="language-plaintext highlighter-rouge">--compare</code> and <code class="language-plaintext highlighter-rouge">--add-checks-path</code> together</li>
  <li>Alias process methods called in class scope on models</li>
  <li>Avoid warning about mass assignment with string literals</li>
  <li>Only report original regex DoS locations</li>
  <li>Report correct file for <code class="language-plaintext highlighter-rouge">simple_format</code> usage CVE warning</li>
  <li>Ignore case value in XSS checks</li>
</ul>

<h3 id="html-reports-with-github-repo">HTML Reports with GitHub Repo</h3>

<p>HTML reports were sometimes causing an error when linking to a GitHub repo.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/625">changes</a>)</p>

<h3 id="shadowed-block-arguments">Shadowed Block Arguments</h3>

<p>There was an error handling explicitly shadowed block arguments like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>some_array.each do |item; x, y|
  # Stuff
end
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/613">changes</a>)</p>

<h3 id="csv-output">CSV Output</h3>

<p>Empty tables caused the CSV report to fail.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/616">changes</a>)</p>

<h3 id="rubyparser-update">RubyParser Update</h3>

<p>Brakeman has been very behind on RubyParser versions due to a line number issue which is nearly always present in HAML templates. As a workaround, Brakeman now strips newline literals from HAML templates. While this does cause some line numbers to be off, but typically newline literals are caused by HAML formatting. Removing them allows Brakeman to use the latest RubyParser.</p>

<p>Brakeman now requires RubyParser 3.6.2 as a minimum.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/620">HAML changes</a>, <a href="https://github.com/presidentbeef/brakeman/pull/621">dependency change</a>)</p>

<h3 id="more-sql-safe-methods">More SQL-safe Methods</h3>

<p>Brakeman will no longer warn about <code class="language-plaintext highlighter-rouge">primary_key</code>, <code class="language-plaintext highlighter-rouge">table_name_prefix</code>, and <code class="language-plaintext highlighter-rouge">table_name_suffix</code> in SQL.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/635">changes</a>)</p>

<h3 id="compare-with-external-checks">Compare with External Checks</h3>

<p>Fix an issue when using <code class="language-plaintext highlighter-rouge">--compare</code> and <code class="language-plaintext highlighter-rouge">--add-checks-path</code> together.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/635">changes</a>)</p>

<h3 id="process-class-scope-method-calls">Process Class-Scope Method Calls</h3>

<p>Previously, Brakeman would process method calls at the class scope (e.g., <code class="language-plaintext highlighter-rouge">belongs_to</code>) in models and then throw away the call. This meant the call never received data flow analysis. This was particularly noticeable when those calls involved blocks. This has been fixed and has improved results, especially where constants are used.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/634">changes</a>)</p>

<h3 id="mass-assignment-with-literals">Mass Assignment with Literals</h3>

<p>Brakeman no longer warns about mass assignment if the arguments are a string or symbol. In those cases it probably isn’t an ActiveRecord subclass in any case.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/631">changes</a>)</p>

<h3 id="reduce-regex-dos-duplicates">Reduce Regex DoS Duplicates</h3>

<p>Duplicate regular expression denial of service warnings were being reported due to data flow analysis.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/627">changes</a>)</p>

<h3 id="file-for-simple_format-cve">File for simple_format CVE</h3>

<p>Warnings regarding the old <code class="language-plaintext highlighter-rouge">simple_format</code> CVE will now point to the file where <code class="language-plaintext highlighter-rouge">simple_format</code> was called, not the Gemfile.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/623/files">changes</a>)</p>

<h3 id="ignore-case-value">Ignore Case Value</h3>

<p>Do not report about XSS regarding the value used in <code class="language-plaintext highlighter-rouge">case</code> expressions.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/619">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>87413b544b5eae0cac9f037e2b62b1fe3f0fee5e  brakeman-3.0.2.gem
cfcf3080a992ca173c64dd98fe239e8bd9bb0eaa  brakeman-min-3.0.2.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2025/04/03/brakeman-7-dot-0-dot-1-released">Brakeman 7.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/12/30/brakeman-7-dot-0-dot-0-released">Brakeman 7.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/10/18/brakeman-6-dot-2-dot-2-released">Brakeman 6.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/08/22/brakeman-6-dot-2-released">Brakeman 6.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/02/01/brakeman-6-dot-1-dot-2-released">Brakeman 6.1.2 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
