
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/13/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/06/18/brakeman-3-dot-0-4-released">Brakeman 3.0.4 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-06-18 10:50:00 -0700" pubdate  updated >2015-06-18 10:50:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a small release prompted by Tuesday’s CVE announcements. New checks for the CVEs directly in Rails have been added, and can also test for the suggested workarounds. Please consider using <a href="https://github.com/rubysec/bundler-audit">bundler-audit</a> for detecting known vulnerable versions of gems, as Brakeman has only limited coverage.</p>

<p>Note this release also upgrades the RubyParser dependency. The latest RubyParser has several bug fixes and initial support for new Ruby 2.2 syntax.</p>

<p><em>Changes since 3.0.3</em>:</p>

<ul>
  <li>Add check for CVE-2015-3226 (XSS via JSON keys)</li>
  <li>Add check for CVE-2015-3227 (XML DoS)</li>
  <li>Treat <code class="language-plaintext highlighter-rouge">&lt;%==</code> as unescaped output (<a href="https://github.com/presidentbeef/brakeman/issues/661">#661</a>)</li>
  <li>Update <code class="language-plaintext highlighter-rouge">ruby_parser</code> dependency to 3.7.0</li>
</ul>

<h3 id="cross-site-scripting-in-json">Cross Site Scripting in JSON</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/7VlB_pck3hU/3QZrGIaQW6cJ">CVE-2015-3226</a> is an issue with converting hashes to JSON. The keys do not properly escape HTML entities, leading to potential cross site scripting vulnerabilities. Brakeman will warn unless the workaround is included in an initializer (essentially verbatim). The warning is high confidence if there is evidence of explicitly converting values to JSON, otherwise medium.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/665">changes</a>)</p>

<h3 id="xml-denial-of-service">XML Denial of Service</h3>

<p><a href="https://groups.google.com/d/msg/rubyonrails-security/bahr2JLnxvk/x4EocXnHPp8J">CVE-2015-3227</a> is a potential denial of service when parsing deeply nested XML requests. Brakeman will warn about this unless there is an initializer changing the XML parser as described in the CVE. Currently it looks for either <code class="language-plaintext highlighter-rouge">LibXML</code> or <code class="language-plaintext highlighter-rouge">Nokogiri</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/666">changes</a>)</p>

<h3 id="double-equals-is-unescaped-output">Double Equals is Unescaped Output</h3>

<p>Brakeman will now treat <code class="language-plaintext highlighter-rouge">&lt;%== x %&gt;</code> in ERB templates as unescaped output.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/663">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>bf6ae72a0b516ecf65b9165d07e86259ef9fa5d3  brakeman-3.0.4.gem
c1c2ea5402d8a89fe4a645947ec324d0603d3976  brakeman-min-3.0.4.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/04/30/brakeman-3-dot-0-3-released">Brakeman 3.0.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-04-30 09:50:00 -0700" pubdate  updated >2015-04-30 09:50:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is mostly a bug fix release, but does introduce a new warning code for when <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> is not set to raise exceptions in Rails 4.</p>

<p><em>Changes since 3.0.2</em>:</p>

<ul>
  <li>Warn about <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> without exceptions (<a href="https://github.com/oreoshake">Neil Matatall</a>)</li>
  <li>Add Rake task to exit with error code on warnings (<a href="https://github.com/masarakki">masarakki</a>)</li>
  <li>Ignore <code class="language-plaintext highlighter-rouge">quoted_table_name</code> in SQL (<a href="https://github.com/sobrinho">Gabriel Sobhrinho</a>)</li>
  <li>Ignore more Arel methods in SQL (<a href="https://github.com/presidentbeef/brakeman/issues/604">#604</a>)</li>
  <li>Warn about RCE and file access with <code class="language-plaintext highlighter-rouge">open</code></li>
  <li>Handle <code class="language-plaintext highlighter-rouge">Array#include?</code> guard conditionals (<a href="https://github.com/presidentbeef/brakeman/issues/604">#604</a>)</li>
  <li>Handle lambdas as filters</li>
  <li>Do not ignore targets of <code class="language-plaintext highlighter-rouge">to_s</code> in SQL (<a href="https://github.com/presidentbeef/brakeman/issues/638">#638</a>)</li>
</ul>

<h3 id="new-csrf-warning">New CSRF Warning</h3>

<p><a href="https://github.com/oreoshake">Neil Matatall</a> has added a warning for Rails 4 applications that do not pass the <code class="language-plaintext highlighter-rouge">with: :exception</code> option to <code class="language-plaintext highlighter-rouge">protect_from_forgery</code>. The default behavior of clearing out the session (but still processing the request) has lead to vulnerabilities in some applications. GitHub <a href="https://bounty.github.com/researchers/LukasReschke.html">recently awarded a bug bounty</a> for a vulnerability caused by this behavior.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/648">changes</a>)</p>

<h3 id="additional-rake-task">Additional Rake Task</h3>

<p><a href="https://github.com/masarakki">Masarakki</a> added a Rake task that will exit with an error code if any warnings are found (like <code class="language-plaintext highlighter-rouge">brakeman -z</code>). The task can be run with <code class="language-plaintext highlighter-rouge">rake brakeman:check</code>.</p>

<p>However, please note the use of Rake tasks to run Brakeman is discouraged, since it loads the entire Rails application which is unnecessary and may cause conflicts with Brakeman dependencies.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/637">changes</a>)</p>

<h3 id="reduce-sql-injection-false-positives">Reduce SQL Injection False Positives</h3>

<p>A patch from <a href="https://github.com/sobrinho">Gabriel Sobhrinho</a> removes warnings about <code class="language-plaintext highlighter-rouge">quoted_table_name</code> in SQL queries.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/647">changes</a>)</p>

<p>An additional change was made to ignore more Arel methods nested inside of other queries. This should reduce many of the false positives seen with combining Arel and ActiveRecord queries.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/653">changes</a>)</p>

<h3 id="remote-code-execution-in-open">Remote Code Execution in open()</h3>

<p>As noted in <a href="http://sakurity.com/blog/2015/02/28/openuri.html">Egor Homakov’s blog post</a>, <code class="language-plaintext highlighter-rouge">open</code> can actually be used to spawn new processes by starting the argument with a pipe <code class="language-plaintext highlighter-rouge">|</code>. Brakeman will now warn about remote code execution via <code class="language-plaintext highlighter-rouge">open</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/643">changes</a>)</p>

<h3 id="simple-guard-conditions">Simple Guard Conditions</h3>

<p>Brakeman should now recognize guard conditions that look exactly like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>if [1, 2, "a", "b"].include? x
  do_something_dangerous_with x
end
</code></pre></div></div>

<p>This may resolve some false positives. If you have code similar to this, please consider <a href="https://github.com/presidentbeef/brakeman/issues">opening an issue</a> and perhaps it can be handled similarly.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/640">changes</a>)</p>

<h3 id="lambda-filters">Lambda Filters</h3>

<p>Filters that use lambdas instead of blocks should now be handled correctly.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/649">changes</a>)</p>

<h3 id="handle-to_s-in-sql">Handle to_s in SQL</h3>

<p>Values with <code class="language-plaintext highlighter-rouge">to_s</code> called on them were being ignored when checking for SQL injection. This has been fixed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/639">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>170c3dd6925373b7da2e27fd1decf2957b35dc43  brakeman-3.0.3.gem
f126e305404a61e99f9ddb848996d87325d1485a  brakeman-min-3.0.3.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/03/09/brakeman-3-dot-0-2-released">Brakeman 3.0.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-03-09 14:54:00 -0700" pubdate  updated >2015-03-09 14:54:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is entirely a bugfix release, no new features. However, the fixes may cause line numbers and warning fingerprints to change.</p>

<p><em>Changes since 3.0.1</em>:</p>

<ul>
  <li>Fix HTML reports with GitHub repos (<a href="https://github.com/presidentbeef/brakeman/issues/624">#624</a>)</li>
  <li>Handle processing of explictly shadowed block arguments (<a href="https://github.com/presidentbeef/brakeman/issues/612">#612</a>)</li>
  <li>Fix CSV output when there are no warnings (<a href="https://github.com/presidentbeef/brakeman/issues/615">#615</a>)</li>
  <li>Update <code class="language-plaintext highlighter-rouge">ruby_parser</code> to ~&gt; 3.6.2</li>
  <li>Treat <code class="language-plaintext highlighter-rouge">primary_key</code>, <code class="language-plaintext highlighter-rouge">table_name_prefix</code>, <code class="language-plaintext highlighter-rouge">table_name_suffix</code> as safe in SQL</li>
  <li>Fix using <code class="language-plaintext highlighter-rouge">--compare</code> and <code class="language-plaintext highlighter-rouge">--add-checks-path</code> together</li>
  <li>Alias process methods called in class scope on models</li>
  <li>Avoid warning about mass assignment with string literals</li>
  <li>Only report original regex DoS locations</li>
  <li>Report correct file for <code class="language-plaintext highlighter-rouge">simple_format</code> usage CVE warning</li>
  <li>Ignore case value in XSS checks</li>
</ul>

<h3 id="html-reports-with-github-repo">HTML Reports with GitHub Repo</h3>

<p>HTML reports were sometimes causing an error when linking to a GitHub repo.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/625">changes</a>)</p>

<h3 id="shadowed-block-arguments">Shadowed Block Arguments</h3>

<p>There was an error handling explicitly shadowed block arguments like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>some_array.each do |item; x, y|
  # Stuff
end
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/613">changes</a>)</p>

<h3 id="csv-output">CSV Output</h3>

<p>Empty tables caused the CSV report to fail.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/616">changes</a>)</p>

<h3 id="rubyparser-update">RubyParser Update</h3>

<p>Brakeman has been very behind on RubyParser versions due to a line number issue which is nearly always present in HAML templates. As a workaround, Brakeman now strips newline literals from HAML templates. While this does cause some line numbers to be off, but typically newline literals are caused by HAML formatting. Removing them allows Brakeman to use the latest RubyParser.</p>

<p>Brakeman now requires RubyParser 3.6.2 as a minimum.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/620">HAML changes</a>, <a href="https://github.com/presidentbeef/brakeman/pull/621">dependency change</a>)</p>

<h3 id="more-sql-safe-methods">More SQL-safe Methods</h3>

<p>Brakeman will no longer warn about <code class="language-plaintext highlighter-rouge">primary_key</code>, <code class="language-plaintext highlighter-rouge">table_name_prefix</code>, and <code class="language-plaintext highlighter-rouge">table_name_suffix</code> in SQL.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/635">changes</a>)</p>

<h3 id="compare-with-external-checks">Compare with External Checks</h3>

<p>Fix an issue when using <code class="language-plaintext highlighter-rouge">--compare</code> and <code class="language-plaintext highlighter-rouge">--add-checks-path</code> together.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/635">changes</a>)</p>

<h3 id="process-class-scope-method-calls">Process Class-Scope Method Calls</h3>

<p>Previously, Brakeman would process method calls at the class scope (e.g., <code class="language-plaintext highlighter-rouge">belongs_to</code>) in models and then throw away the call. This meant the call never received data flow analysis. This was particularly noticeable when those calls involved blocks. This has been fixed and has improved results, especially where constants are used.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/634">changes</a>)</p>

<h3 id="mass-assignment-with-literals">Mass Assignment with Literals</h3>

<p>Brakeman no longer warns about mass assignment if the arguments are a string or symbol. In those cases it probably isn’t an ActiveRecord subclass in any case.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/631">changes</a>)</p>

<h3 id="reduce-regex-dos-duplicates">Reduce Regex DoS Duplicates</h3>

<p>Duplicate regular expression denial of service warnings were being reported due to data flow analysis.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/627">changes</a>)</p>

<h3 id="file-for-simple_format-cve">File for simple_format CVE</h3>

<p>Warnings regarding the old <code class="language-plaintext highlighter-rouge">simple_format</code> CVE will now point to the file where <code class="language-plaintext highlighter-rouge">simple_format</code> was called, not the Gemfile.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/623/files">changes</a>)</p>

<h3 id="ignore-case-value">Ignore Case Value</h3>

<p>Do not report about XSS regarding the value used in <code class="language-plaintext highlighter-rouge">case</code> expressions.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/619">changes</a>)</p>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>87413b544b5eae0cac9f037e2b62b1fe3f0fee5e  brakeman-3.0.2.gem
cfcf3080a992ca173c64dd98fe239e8bd9bb0eaa  brakeman-min-3.0.2.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/01/22/brakeman-3-dot-0-1-released">Brakeman 3.0.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-01-22 18:38:00 -0800" pubdate  updated >2015-01-22 18:38:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a small release, but may change some fingerprints of warnings in libraries. Also, the Slim dependency has been removed due to conflicts. See below for details.</p>

<ul>
  <li>Remove Slim dependency (<a href="https://github.com/cwest">Casey West</a>)</li>
  <li>Properly process libraries (<a href="https://github.com/ptoomey3">Patrick Toomey</a>)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">--add-libs-path</code> for additional libraries (<a href="https://github.com/ptoomey3">Patrick Toomey</a>)</li>
  <li>Allow for controllers/models/templates in directories under <code class="language-plaintext highlighter-rouge">app/</code> (<a href="https://github.com/nealharris">Neal Harris</a>)</li>
  <li>Avoid <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> warning unless <code class="language-plaintext highlighter-rouge">ApplicationController</code> inherits from <code class="language-plaintext highlighter-rouge">ActionController::Base</code> (<a href="https://github.com/presidentbeef/brakeman/issues/573">#573</a>)</li>
  <li>Properly format command interpolation (again)</li>
</ul>

<h3 id="slim-gem-dependency-removed">Slim Gem Dependency Removed</h3>

<p>Since <a href="https://github.com/slim-template/slim-rails/releases/tag/3.0.1">Rails 4.2 requires Slim 3.0.1</a> and <a href="https://github.com/slim-template/slim/blob/bb7ca78c1ea9629d8b57a06fcb99c938c9d7640e/CHANGES#L8">Slim 3.0 dropped support for Ruby 1.8.7</a>, there is no way to satisfy dependencies for Slim, Rails 4.2, and retain support for Ruby 1.8.7 when Brakeman is added as a dependency in a <code class="language-plaintext highlighter-rouge">Gemfile</code>.</p>

<p>The only acceptable solution is to not include Slim as a dependency at all and let users sort it out for themselves. Sorry for the unfortunate situation, but there is no way to add Brakeman to a <code class="language-plaintext highlighter-rouge">Gemfile</code> and avoid Bundler attempting to resolve Brakeman’s dependencies against the application’s dependencies, despite there being no relation.</p>

<p>Thanks to <a href="https://github.com/cwest">Casey West</a> for working through solutions for this issue.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/602">changes</a>)</p>

<h3 id="library-processing">Library Processing</h3>

<p>Libraries were added to the call index (which meant they were scanned during checks) in the 3.0.0 release, but there were still not being processed like most other code. This led to some checks not finding issues they should have. <a href="https://github.com/ptoomey3">Patrick Toomey</a> pointed this out and contributed a fix.</p>

<p>This change may affect existing warning fingerprints for warnings in libraries. Apologies for the inconvenience.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/605">changes</a>)</p>

<h3 id="allow-additional-library-paths">Allow Additional Library Paths</h3>

<p><a href="https://github.com/ptoomey3">Patrick Toomey</a> also added a new option <code class="language-plaintext highlighter-rouge">--add-libs-path</code> to treat more paths as if they were in <code class="language-plaintext highlighter-rouge">lib/</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/606">changes</a>)</p>

<h3 id="scan-application-subdirectories">Scan Application Subdirectories</h3>

<p><a href="https://github.com/nealharris">Neal Harris</a> contributed a change to support applications with multiple applications under <code class="language-plaintext highlighter-rouge">app/</code>, such as <code class="language-plaintext highlighter-rouge">app/cool_team/controllers/</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/607">changes</a>)</p>

<h3 id="avoid-csrf-warning-for-apis">Avoid CSRF Warning for APIs</h3>

<p>Brakeman will no longer warn about missing <code class="language-plaintext highlighter-rouge">protect_from_forgery</code> if <code class="language-plaintext highlighter-rouge">ApplicationController</code> does not inherit from <code class="language-plaintext highlighter-rouge">ActionController::Base</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/issues/573">changes</a>)</p>

<h3 id="command-interpolation-format-fix">Command Interpolation Format Fix</h3>

<p>Previous release had an incomplete fix for this. There should be no impact to warning fingerprints.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/608">changes</a>)</p>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2015/01/02/brakeman-3-dot-0-0-released">Brakeman 3.0.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2015-01-02 17:09:00 -0800" pubdate  updated >2015-01-02 17:09:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a major version release of Brakeman which introduces some backwards-incompatible changes. Very likely this release will cause many changes in reports, including fingerprints on existing warnings.</p>

<p><em>Changes since 2.6.3</em>:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">--exit-on-warn --compare</code> only returns error code on new warnings (<a href="https://github.com/jeffyip">Jeff Yip</a>)</li>
  <li>Sort warnings by fingerprint in JSON report (<a href="https://github.com/jeffyip">Jeff Yip</a>)</li>
  <li>CVEs report correct line and file name (Gemfile/Gemfile.lock) (<a href="https://github.com/pwnetrationguru">Rob Fletcher</a>)</li>
  <li>Change <code class="language-plaintext highlighter-rouge">--separate-models</code> to be the default</li>
  <li>Local variables are no longer formatted as <code class="language-plaintext highlighter-rouge">(local var)</code></li>
  <li>Actually skip skipped before filters</li>
  <li>Remove “fake filters” from warning fingerpints</li>
  <li>Index calls in <code class="language-plaintext highlighter-rouge">lib/</code> files</li>
  <li>Handle symmetric multiple assignment</li>
  <li>Do not branch for self attribute assignment <code class="language-plaintext highlighter-rouge">x = x.y</code> (<a href="https://github.com/presidentbeef/brakeman/issues/552">#552</a>)</li>
  <li>Move Symbol DoS to optional checks</li>
  <li>Add check for cross site scripting via inline renders</li>
  <li>Add check for CVE-2014-7829</li>
  <li>Fix parsing of <code class="language-plaintext highlighter-rouge">&lt;%==</code> in ERB</li>
  <li>Fix output format of command interpolation</li>
  <li>Fix CVE for CVE-2011-2932</li>
</ul>

<h3 id="exit-code-when-comparing">Exit Code When Comparing</h3>

<p>When using <code class="language-plaintext highlighter-rouge">--exit-on-warn --compare</code>, Brakeman will only return a non-zero exit code when there are new warnings. Previous behavior was to return non-zero exit code if there were any differences between reports (including fixed warnings).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/588">changes</a>)</p>

<h3 id="sort-warnings-in-json-report">Sort Warnings in JSON Report</h3>

<p>Warnings are now sorted by their fingerprint in the JSON report to provide more stable output.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/587">changes</a>)</p>

<h3 id="report-line-numbers-for-cves">Report Line Numbers for CVEs</h3>

<p>Previously, CVE warnings typically pointed to <code class="language-plaintext highlighter-rouge">Gemfile</code> with no line number information. Now CVEs should point to <code class="language-plaintext highlighter-rouge">Gemfile</code> or <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> as appropriate and include the line number for the vulnerable gem dependency.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/557">changes</a> and <a href="https://github.com/presidentbeef/brakeman/pull/569">more changes</a>)</p>

<h3 id="mass-assignment-warnings-default-to-per-model">Mass Assignment Warnings Default to per Model</h3>

<p>The <code class="language-plaintext highlighter-rouge">--separate-models</code> option is now on by default. This means warnings about missing <code class="language-plaintext highlighter-rouge">attr_accessible</code> will be reported for each model instead of rolling them into a single warning.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/586">changes</a>)</p>

<h3 id="local-variable-format">Local Variable Format</h3>

<p>Local variables are no longer formatted as <code class="language-plaintext highlighter-rouge">(local var)</code> in warning output.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/594">changes</a>)</p>

<h3 id="skip-skipped-filters">Skip Skipped Filters</h3>

<p>Before filters which are skipped are now actually skipped during data flow analysis.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/592">changes</a>)</p>

<h3 id="fake-filter-change">Fake Filter Change</h3>

<p>Before filters defined as blocks (instead of methods) are internally represented as methods with random names prepended by <code class="language-plaintext highlighter-rouge">fake_filter</code>. Since the method names were not stable, any warnings inside the filters would have inconsistent fingerprints. Now warnings inside of before filters will always be reported with <code class="language-plaintext highlighter-rouge">before_filter</code> as the method name.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/572">changes</a>)</p>

<h3 id="index-calls-in-libraries">Index Calls in Libraries</h3>

<p>Classes defined in <code class="language-plaintext highlighter-rouge">lib/</code> files will now be included in the method call index and searched for vulnerabilities. As these files were already being processed, this has not added any significant overhead in testing.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/571">changes</a>)</p>

<h3 id="handle-multiple-assignment">Handle Multiple Assignment</h3>

<p>Simple symmetric multiple assignments (also called “parallel assignment”) like <code class="language-plaintext highlighter-rouge">x, y = 1, 2</code> are now handled like normal assignments.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/577">changes</a>)</p>

<h3 id="avoid-branching-on-self-assignment">Avoid Branching on Self Assignment</h3>

<p>Brakeman no longer creates new union values for self assignment of attributes.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/578">changes</a>)</p>

<h3 id="symbol-dos-is-an-optional-check">Symbol DoS is an Optional Check</h3>

<p>In this release the check for denial of service via symbol creation has been changed to an optional check. Memory exhaustion by creating lots of new symbols is an unlikely attack and easily mitigated by having at least two web servers. Additionally</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/570">changes</a>)</p>

<h3 id="warn-on-inline-xss">Warn on Inline XSS</h3>

<p>Unescaped user input in <code class="language-plaintext highlighter-rouge">render :text</code> or <code class="language-plaintext highlighter-rouge">render :inline</code> should now generate warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/598">changes</a>)</p>

<h3 id="cve-2014-7829">CVE-2014-7829</h3>

<p>Brakeman will warn about <a href="https://groups.google.com/d/msg/rubyonrails-security/23fiuwb1NBA/MQVM1-5GkPMJ">CVE-2014-7829</a> (file existence disclosure) for applications using affected versions of Rails and setting <code class="language-plaintext highlighter-rouge">config.serve_static_assets = true</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/600">changes</a>)</p>

<h3 id="erb-parsing-fix">ERB Parsing Fix</h3>

<p>Parsing <code class="language-plaintext highlighter-rouge">&lt;%==</code> in ERB templates no longer causes errors.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/589">changes</a>)</p>

<h3 id="command-interpolation-format-fix">Command Interpolation Format Fix</h3>

<p>Brakeman was formatting</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`#{x}`
</code></pre></div></div>

<p>as</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>`x`
</code></pre></div></div>

<p>This has been fixed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/596">changes</a>)</p>

<h3 id="cve-2011-2932">CVE-2011-2932</h3>

<p>The ancient CVE-2011-2932 was being mis-reported as CVE-2011-2931. Hopefully this affects no one.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/575">changes</a>)</p>

<h3 id="certificate-update">Certificate Update</h3>

<p>The certificate used to sign the Brakeman gem expired in December. A new certificate is available <a href="https://raw.githubusercontent.com/presidentbeef/brakeman/master/brakeman-public_cert.pem">here</a>.</p>

<p>This command can be used to add the new certificate:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>gem cert --add &lt;(curl -Ls https://raw.github.com/presidentbeef/brakeman/master/brakeman-public_cert.pem)
</code></pre></div></div>

<h3 id="shas">SHAs</h3>

<p>The SHA1 sums for this release are</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4180238f8de503e7ad0f2ca952ea38ccc1c6530b  brakeman-3.0.0.gem
b5cefd6f14edb57f12d1fe9fcc0fb24e05a05aaf  brakeman-min-3.0.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and joining the <a href="http://brakemanscanner.org/contact/">mailing list</a>.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2023/05/24/brakeman-6-dot-0-released">Brakeman 6.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/02/21/brakeman-5-dot-4-dot-1-released">Brakeman 5.4.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/11/17/brakeman-5-dot-4-dot-0-released">Brakeman 5.4.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/08/09/brakeman-5-dot-3-dot-0-released">Brakeman 5.3.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/05/01/brakeman-5-dot-2-dot-3-released">Brakeman 5.2.3 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
