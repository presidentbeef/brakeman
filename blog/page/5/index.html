
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/5/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/10/14/brakeman-4-dot-7-dot-1-released">Brakeman 4.7.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-10-14 16:00:00 -0700" pubdate  updated >2019-10-14 16:00:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release includes a security fix in a dependency; please see below.</p>

<p><em>Changes since 4.7.0:</em></p>

<ul>
  <li>Address file permission issues in bundled <code class="highlighter-rouge">ruby_parser-legacy</code></li>
  <li>Sort text report by file and line (<a href="https://github.com/JacobEvelyn">Jacob Evelyn</a>)</li>
  <li>Catch reverse tabnabbing with <code class="highlighter-rouge">:_blank</code> symbol (<a href="https://github.com/JacobEvelyn">Jacob Evelyn</a>)</li>
  <li>Convert <code class="highlighter-rouge">s(:lambda)</code> to <code class="highlighter-rouge">s(:call)</code> in <code class="highlighter-rouge">Sexp#block_call</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1410">#1410</a>)</li>
  <li>Check string length against limit before joining</li>
  <li>Fix flaky rails4 test (<a href="https://github.com/adamkiczula">Adam Kiczula</a>)</li>
  <li>Fix errors from frozen <code class="highlighter-rouge">Symbol#to_s</code> in Ruby 2.7</li>
  <li>Add release dates to each version in CHANGES (<a href="https://github.com/TheSpartan1980">TheSpartan1980</a>)</li>
</ul>

<h3 id="file-permissions">File Permissions</h3>

<p>A security issue <a href="https://github.com/zenspider/ruby_parser-legacy/issues/1">was reported for the <code class="highlighter-rouge">ruby_parser-legacy</code> gem</a>, where some files are installed with world-writable permissions.
This would allow any user on the system to edit code which would then be executed by Brakeman (or other dependent libraries) when loading the <code class="highlighter-rouge">ruby_parser-legacy</code> gem.</p>

<p>In this release of the <code class="highlighter-rouge">brakeman</code> gem, the permissions on these files have been corrected.
However, there has not been a fixed release of <code class="highlighter-rouge">ruby_parser-legacy</code> yet, so the <code class="highlighter-rouge">brakeman-lib</code> and <code class="highlighter-rouge">brakeman-min</code> gems are still affected.</p>

<h3 id="default-report-format-sorting">Default Report Format Sorting</h3>

<p>Warnings in the default text report are now sorted by file and line number as well as confidence and category, thanks to <a href="https://github.com/JacobEvelyn">Jacob Evelyn</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1412">changes</a>)</p>

<h3 id="reverse-tabnabbing">Reverse Tabnabbing</h3>

<p><a href="https://github.com/JacobEvelyn">Jacob Evelyn</a> also updated the reverse tabnabbing check to match links created with <code class="highlighter-rouge">target: :_blank</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1411">changes</a>)</p>

<h3 id="stabby-lambdas">Stabby Lambdas</h3>

<p><code class="highlighter-rouge">ruby_parser</code> 3.14.0 changed the AST representation of <code class="highlighter-rouge">-&gt;{}</code> lambdas, and Brakeman needed to adjust.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1415">changes</a>)</p>

<h3 id="string-length-limit">String Length Limit</h3>

<p>Brakeman now checks the resulting length of joining two strings (e.g., <code class="highlighter-rouge">"blah" + "blah blah"</code>) <em>before</em> joining them.
If the joined string would be longer than 50 characters, the strings are not joined.</p>

<p>Note the only change is when the length is checked, the limit was already in place.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1421">changes</a>)</p>

<h3 id="flaky-test-fixed">Flaky Test Fixed</h3>

<p><a href="https://github.com/adamkiczula">Adam Kiczula</a> fixed an intermittently-failing test in the Brakeman test suite that had been
plaguing CI builds for a long time. Thanks!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1419">changes</a>)</p>

<h3 id="ruby-27-frozen-strings">Ruby 2.7 Frozen Strings</h3>

<p>In Ruby 2.7, symbols and some other constant values (<code class="highlighter-rouge">true</code>/<code class="highlighter-rouge">false</code>, etc.) will return frozen strings.
This affected Brakeman in only minor ways, but it is fixed now in preparation for Ruby 2.7.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1420">changes</a>)</p>

<h3 id="release-dates-in-changelog">Release Dates in Changelog</h3>

<p>Brakeman’s <a href="https://github.com/presidentbeef/brakeman/blob/master/CHANGES.md">changelog</a> now includes release dates thanks to <a href="https://github.com/TheSpartan1980">TheSpartan1980</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1418">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cdc6f4c86b5b35b5e94798cf443909385aa1b79235da8e1ee1fd4381acf03691  brakeman-4.7.1.gem
2f7a7a6d79b1e5b8c6a390e04642e987c56cced2c8be3d63a1250f7bbc9e504d  brakeman-lib-4.7.1.gem
598431f6bfc90b119fc6883ead7896c1718ba5d9a0e0450893c3e628a6c8e7b0  brakeman-min-4.7.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/10/14/brakeman-4-dot-7-released">Brakeman 4.7.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-10-14 16:00:00 -0700" pubdate  updated >2019-10-14 16:00:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release updates Haml support to Haml 5.x!</p>

<p><em>Changes since 4.6.1:</em></p>

<ul>
  <li>Update Haml support to Haml 5.x (<a href="https://github.com/presidentbeef/brakeman/issues/1044">#1044</a>)</li>
  <li>Catch shell injection from <code class="highlighter-rouge">-c</code> shell commands (<a href="https://github.com/JacobEvelyn">Jacob Evelyn</a>)</li>
  <li>Correctly handle non-symbols in <code class="highlighter-rouge">CheckCookieSerialization</code> (<a href="https://github.com/philipturnbull">Phil Turnbull</a>)</li>
  <li>Refactor <code class="highlighter-rouge">Brakeman::Differ#second_pass</code> (<a href="https://github.com/Becojo">Benoit Côté-Jodoin</a>)</li>
  <li>Fix <code class="highlighter-rouge">version_between?</code> (<a href="https://github.com/aglushkov">Andrey Glushkov</a>)</li>
  <li>Ignore interpolation in <code class="highlighter-rouge">%W[]</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1399">#1399</a>)</li>
  <li>Ignore <code class="highlighter-rouge">form_for</code> for XSS check</li>
</ul>

<h3 id="haml-support-update">Haml Support Update</h3>

<p>Haml 5 introduced a completely different “compiled” format, so adding support was a significant effort taking a few months to complete.
Due to the large number of changes, you may expect some changes to warnings for Haml templates.</p>

<p>Please report any bugs or odd behavior with Haml templates!</p>

<p>Haml 3.x and 4.x are no longer supported, although in general Haml is mostly backwards-compatible.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1397">changes</a>)</p>

<h3 id="shell-commands">Shell Commands</h3>

<p><a href="https://github.com/JacobEvelyn">Jacob Evelyn</a> added support for detecting command injection with <code class="highlighter-rouge">-c</code> in known-dangerous commands (such as <code class="highlighter-rouge">bash</code> or <code class="highlighter-rouge">echo</code>).</p>

<p>An example of dangerous code would be:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>system("echo", "-c", params[:command])
</code></pre></div></div>

<p>Of course not all dangerous shell commands are covered - so in general be careful passing any user-controlled input to a shell command.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1396/">changes</a>)</p>

<h3 id="cookieserialization-bug">CookieSerialization Bug</h3>

<p><a href="https://github.com/philipturnbull">Phil Turnbull</a> fixed an issue in <code class="highlighter-rouge">CheckCookieSerialization</code> where non-symbol cookie serialization options were handled poorly.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1391">changes</a>)</p>

<h3 id="brakemandiffer-refactor">Brakeman::Differ Refactor</h3>

<p><a href="https://github.com/Becojo">Benoit Côté-Jodoin</a> refactored <code class="highlighter-rouge">Brakeman::Differ</code> to compare warnings more efficiently and remove old fallback behavior.
All warnings are compared by fingerprint now when using <code class="highlighter-rouge">--compare</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1406">changes</a>)</p>

<h3 id="version-comparisons">Version Comparisons</h3>

<p><a href="https://github.com/aglushkov">Andrey Glushkov</a> updated the code for comparing library versions so it uses <code class="highlighter-rouge">Gem::Version</code> and handles “beta”/pre-release versions better.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1405">changes</a>)</p>

<h3 id="w-interpolation">%W Interpolation</h3>

<p>String interpolation when using <code class="highlighter-rouge">%W</code> is no longer considered dangerous in shell commands where regular interpolation would be.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1408">changes</a>)</p>

<h3 id="form_for"><code class="highlighter-rouge">form_for</code></h3>

<p><code class="highlighter-rouge">form_for</code> is considered a safe method in XSS checks.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1397/commits/a99cb25c6e76eb6240589f3a399e1245c0514257">changes</a>)</p>

<h3 id="stringnew">String.new</h3>

<p><code class="highlighter-rouge">String.new &lt;&lt; 'some string'</code> is now treated like <code class="highlighter-rouge">'' &lt;&lt; 'some string'</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1397/commits/931bed18481679086a7102bc063ecf9b1d727d40">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>f43d949f1de9c0bb67b7bc7d41000ac70a1fb6c2250c5e7332015f0cc5ce36c5  brakeman-4.7.0.gem
c02dbaa4ad0c7402ef99697c7b1916b7d9558dd5aa45e1a36efed117628498cc  brakeman-lib-4.7.0.gem
3ab80a47bbfbb0f869bb1289292ed62b9643b5e0884a4a79e2c7e44218ce3b07  brakeman-min-4.7.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/07/24/brakeman-4-dot-6-dot-1-released">Brakeman 4.6.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-07-24 09:14:00 -0700" pubdate  updated >2019-07-24 09:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release corrects a typo in the reverse tabnabbing warning message.</p>

<p><em>Changes since 4.6.0:</em></p>

<ul>
  <li>Fix Reverse Tabnabbing warning message (<a href="https://github.com/stsc3000">Steffen Schildknecht</a> / <a href="https://github.com/joergschiller">Jörg Schiller</a>)</li>
</ul>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6e31f8c8dbdea7b198c591d44b73aee067cca5612db191fe04d8d8c2a8eb9011  brakeman-4.6.1.gem
6879d5175e5f20bf5ac1bd20dad0ef9a1e4c72d9774114d752b19c7e7d7d69fc  brakeman-lib-4.6.1.gem
72a0ef7b91b11bea925b365645096a186ec3929024066792957006c46355560e  brakeman-min-4.6.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/07/23/brakeman-4-dot-6-dot-0-released">Brakeman 4.6.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-07-23 13:14:00 -0700" pubdate  updated >2019-07-23 13:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release has two new checks!</p>

<p><em>Changes since 4.5.1:</em></p>

<ul>
  <li>Add check for cookie serialization with Marshal (<a href="https://github.com/presidentbeef/brakeman/issues/1316">#1316</a>)</li>
  <li>Add reverse tabnabbing check (<a href="https://github.com/linosgian">Linos Giannopoulos</a>)</li>
  <li>Avoid warning about file access with <code class="highlighter-rouge">ActiveStorage::Filename#sanitized</code> (<a href="https://github.com/tejasbubane">Tejas Bubane</a>)</li>
  <li>Update loofah version for fixing <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-8048">CVE-2018-8048</a> (<a href="https://github.com/MartyBeGood">Markus Nölle</a>)</li>
  <li>Warn people that Haml 5 is not fully supported (<a href="https://github.com/jaredbeck">Jared Beck</a>)</li>
  <li>Index calls in initializers</li>
  <li>Improve template output handling in conditional branches</li>
  <li>Avoid assigning <code class="highlighter-rouge">nil</code> line numbers to <code class="highlighter-rouge">Sexp</code>s</li>
  <li>Add special warning code for custom checks</li>
  <li>Add call matching by regular expression</li>
  <li>Skip calls to <code class="highlighter-rouge">dup</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1374">#1374</a>)</li>
  <li>Restore <code class="highlighter-rouge">Warning#relative_path</code></li>
  <li>Better handling of gems with no version declared</li>
</ul>

<h3 id="cookie-serialization-check">Cookie Serialization Check</h3>

<p>Brakeman will now warn if <code class="highlighter-rouge">Rails.application.config.action_dispatch.cookies_serializer</code> is set to <code class="highlighter-rouge">:marshal</code> or <code class="highlighter-rouge">:json</code>.</p>

<p>This options allow cookies to be deserialized via <code class="highlighter-rouge">Marshal</code>. If an attacker is able to construct a valid encrypted cookie, this could lead to arbitrary code execution.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1364">changes</a>)</p>

<h3 id="reverse-tabnabbing-check">Reverse Tabnabbing Check</h3>

<p><a href="https://github.com/linosgian">Linos Giannopoulos</a> has added an optional check for cases of “reverse tabnabbing”. This occurs when a link is opened in a new window/tab via a link (with <code class="highlighter-rouge">target: '_blank'</code>).
The new window can control the location of the old window. If an attacker controls the new window, they can redirect the old window to a malicious site. This is especially useful for 
phishing attacks. These kinds of attacks are most likely on applications that allow arbitrary links to external sites.</p>

<p>To completely remove the ability of an attacker to control the old window, add <code class="highlighter-rouge">rel: "noreferrer noopener"</code> to the <code class="highlighter-rouge">link_to</code> call. Note: this will cause the new window to lose referrer information.</p>

<p>To enable this new check, use <code class="highlighter-rouge">--enable ReverseTabnabbing</code> or <code class="highlighter-rouge">-A</code> to enable all optional checks.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1367">changes</a>)</p>

<h3 id="file-access-false-positive">File Access False Positive</h3>

<p><a href="https://github.com/tejasbubane">Tejas Bubane</a> provided a fix to ignore use of <code class="highlighter-rouge">ActiveStorage::Filename#sanitized</code> inside file access calls.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1375">changes</a>)</p>

<h3 id="fixed-loofah-version">Fixed Loofah Version</h3>

<p><a href="https://github.com/MartyBeGood">Markus Nölle</a> corrected the “fixed” version of Loofah for CVE-2018-8048 from <code class="highlighter-rouge">2.1.2</code> to <code class="highlighter-rouge">2.2.1</code>. Oops!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1371">changes</a>)</p>

<h3 id="haml-5-support">Haml 5 Support</h3>

<p><a href="https://github.com/jaredbeck">Jared Beck</a> added a notification when Haml 5 is in use by an application. At the moment, Brakeman does not support Haml 5.x.
There appear to be only a few syntax differences between Haml 4.x and 5.x, so most users are unaffected.</p>

<p>Support is planned for a future release.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1379">changes</a>)</p>

<h3 id="initializers-more-fully-supported">Initializers More Fully Supported</h3>

<p>When Brakeman scans an application, <a href="https://blog.presidentbeef.com/blog/2012/11/28/faster-call-indexing-in-brakeman-1-dot-8-3/">it “indexes” all method calls of interest</a>. Most checks then operated on those indexed calls.</p>

<p>However, for historical reasons, initializers (files in <code class="highlighter-rouge">config/initializers/</code>) were not included in that index.</p>

<p>Now they are! Besides some modest speed gains and simpler/more consistent checks, now regular old checks can “see” initializers.
This may result in previously-unreported warnings now popping up in initializers.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1363">changes</a>)</p>

<h3 id="conditional-branches-in-templates">Conditional Branches in Templates</h3>

<p>Very obvious code like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= blah ? x : params[:x].html_safe %&gt;
</code></pre></div></div>

<p>Was not being handled correctly and the cross-site scripting issue would not be reported. This is now fixed!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1361">changes</a>)</p>

<h3 id="empty-line-numbers">Empty Line Numbers</h3>

<p><a href="https://github.com/seattlerb/sexp_processor/commit/ce284487f057203360c41b14d2b25f8c5453fbb9">A change in <code class="highlighter-rouge">sexp_processor</code></a> causes it to raise an exception if an <code class="highlighter-rouge">Sexp</code> is assigned a <code class="highlighter-rouge">nil</code> line.
Brakeman was a bit cavalier when assigning line numbers, so this caused an issue for some users.</p>

<p>As a result, line numbers should be assigned a bit more consistently now.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1360">changes</a>)</p>

<h3 id="custom-check-warning-code">Custom Check Warning Code</h3>

<p>Every warning reported by Brakeman refers to an integer “warning code”. This is so the “warning type” or category can be a bit more flexible if we want to change the name or formatting.
However, this list of warning codes is hardcoded into Brakeman. The hardcoding makes it hard for users to add their own checks, because they need to either use an existing code or monkey-patch in a new one.</p>

<p>To help with this situation, custom checks/rules can now use the <code class="highlighter-rouge">:custom_check</code> warning code.</p>

<p><a href="https://github.com/presidentbeef/brakeman/wiki/Creating-Custom-Brakeman-Rules">A tutorial on writing custom checks is in progress</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1377">changes</a>)</p>

<h3 id="call-matching-via-regex">Call Matching via Regex</h3>

<p>It is now possible to search for call targets by regular expression, although it is discouraged for performance reasons.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1358">changes</a>)</p>

<h3 id="dup-calls">Dup Calls</h3>

<p>Brakeman now skips calls to <code class="highlighter-rouge">#dup</code> as if they aren’t there.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1386">changes</a>)</p>

<h3 id="warningrelative_path"><code class="highlighter-rouge">Warning#relative_path</code></h3>

<p><code class="highlighter-rouge">Warning#relative_path</code> has been added back for dependencies that might need it, such as <a href="https://github.com/guard/guard-brakeman/pull/36/">guard-brakeman</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1365">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>48be7f5a8d814ad42bbb9a2222a331e59a8ece9b50103d8e809a0bbc9d128ef9  brakeman-4.6.0.gem
ff81f5d6fb258a1b83c78ba4144163d1183bd9f31536782722617e880ff85917  brakeman-lib-4.6.0.gem
ef3ad0f59dc32630b1e39f289257cf33a882f2838f455e6009c0cb973ee1d378  brakeman-min-4.6.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/05/11/4-dot-5-1-released">Brakeman 4.5.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-05-11 13:14:00 -0700" pubdate  updated >2019-05-11 13:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release adds initial support for Rails 6!</p>

<p><em>Changes since 4.5.0:</em></p>

<ul>
  <li>Add initial Rails 6 support</li>
  <li>Add optional check for <code class="highlighter-rouge">config.force_ssl</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1181">#1181</a>)</li>
  <li>Add deserialization warning for <code class="highlighter-rouge">Oj.load/object_load</code></li>
  <li>Add SQL injection checks for <code class="highlighter-rouge">destroy_by</code>/<code class="highlighter-rouge">delete_by</code></li>
  <li>Add SQL injection checks for <code class="highlighter-rouge">find_or_create_by</code> and friends</li>
  <li>Check <code class="highlighter-rouge">link_to</code> with block for href XSS (<a href="https://github.com/presidentbeef/brakeman/issues/1339">#1339</a>)</li>
  <li>Convert <code class="highlighter-rouge">!!</code> calls to boolean value (<a href="https://github.com/presidentbeef/brakeman/issues/1343">#1343</a>)</li>
  <li>Use relative paths for <code class="highlighter-rouge">__FILE__</code></li>
  <li>Represent file paths internally as <code class="highlighter-rouge">Brakeman::FilePath</code></li>
  <li>Handle empty partial names</li>
  <li>Handle trailing comma in block args</li>
  <li>Remove code for Ruby versions prior to 1.9</li>
</ul>

<h3 id="initial-rails-6-support">Initial Rails 6 Support</h3>

<p>Rails 6 is (almost?) here!</p>

<p>This release adds basic support internally for Rails 6 as well as the <code class="highlighter-rouge">-6</code> option to force Rails 6 mode.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1335">changes</a>)</p>

<h3 id="optional-check-for-force-ssl-option">Optional Check for Force SSL Option</h3>

<p>In Rails, <code class="highlighter-rouge">config.force_ssl = true</code> turns on HSTS, redirects HTTP to HTTPS, and sets the <code class="highlighter-rouge">secure</code> flag on all cookies.</p>

<p>A new optional check has been added to check if this option is enabled.</p>

<p>To enable this new check, use <code class="highlighter-rouge">-A</code> or <code class="highlighter-rouge">--enable ForceSSL</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1344">changes</a>)</p>

<h3 id="deserialization-with-oj">Deserialization with Oj</h3>

<p>The deserialization check now looks for unsafe use of the <code class="highlighter-rouge">Oj</code> JSON library.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1334">changes</a>)</p>

<h3 id="new-sql-injection-sinks">New SQL Injection Sinks</h3>

<p>The SQL injection check has been expanded to check for unsafe use of <code class="highlighter-rouge">destroy_by</code>/<code class="highlighter-rouge">delete_by</code> (new in Rails 6) and <code class="highlighter-rouge">find_or_create_by</code> and related methods.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1337">changes</a>)</p>

<h3 id="link_to-with-block"><code class="highlighter-rouge">link_to</code> with Block</h3>

<p>Brakeman now checks <code class="highlighter-rouge">link_to</code> calls with blocks for <code class="highlighter-rouge">javascript:</code> links.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1340">changes</a>)</p>

<h3 id="convert--to-boolean">Convert <code class="highlighter-rouge">!!</code> to Boolean</h3>

<p>Use of <code class="highlighter-rouge">!!</code> to convert values to booleans will be treated as safe (turned into <code class="highlighter-rouge">true or false</code>).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1345">changes</a>)</p>

<h3 id="relative-path-for-__file__">Relative Path for <code class="highlighter-rouge">__FILE__</code></h3>

<p>When ruby_parser parses <code class="highlighter-rouge">__FILE__</code>, it replaces it with the name of the current file. Unfortunately, Brakeman was passing in absolute paths for the current file.
This meant that the fingerprints for warnings including <code class="highlighter-rouge">__FILE__</code> would vary based on the path where the code was scanned.</p>

<p>Now a relative path is used instead, so fingerprints should stabilize.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1347">changes</a>)</p>

<h3 id="brakemanfilepath"><code class="highlighter-rouge">Brakeman::FilePath</code></h3>

<p>Internally, file paths are now represented with <code class="highlighter-rouge">Brakeman::FilePath</code> to make it easier to manage absolute/relative paths as needed. This was a pretty huge change, so please report any issues.</p>

<p>As a result, the <code class="highlighter-rouge">--no-separate-models</code> option no longer works (it used to combine all model-level mass assignment warnings into one warning).
That old option used to report a completely messed-up file name, which is incompatible with <code class="highlighter-rouge">Brakeman::FilePath</code>. Also, it was weird and wrong.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1354">changes</a>)</p>

<h3 id="empty-partial-names">Empty Partial Names</h3>

<p>If any empty string ends up as a partial name in a <code class="highlighter-rouge">render</code> call, Brakeman will ignore it.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1352">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>c8c48a88e9cd837122a590837ff5dbb4bd8214ad72baaffb75e5e5cd3585166f  brakeman-4.5.1.gem
48eaff4eb661f63d43c2f8b33da8efbabc6196ae5ff2ec58ad711e1649eff686  brakeman-lib-4.5.1.gem
c6fcfc5c32ec79a50281b0b97be5b703385ffb20ef45f770e7888ca6ba0b1666  brakeman-min-4.5.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
<script type='text/javascript'>
    $(document).ready(function(){
        $("#github").GitHubBadge({
          login: "presidentbeef",
          kind: "project",
          repo_name: "brakeman",
          include_github_logo: false,
          image_path: "",
          commit_count: "1",
          issue_count: "0",
          repo_count: "0"
      });
    });
</script>
<div id="github"></div>
<a href="https://travis-ci.org/#!/presidentbeef/brakeman"><img src="https://secure.travis-ci.org/presidentbeef/brakeman.png" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2022/11/17/brakeman-5-dot-4-dot-0-released">Brakeman 5.4.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/08/09/brakeman-5-dot-3-dot-0-released">Brakeman 5.3.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/05/01/brakeman-5-dot-2-dot-3-released">Brakeman 5.2.3 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">Brakeman 5.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/01/30/5-dot-2-dot-1-released">Brakeman 5.2.1 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
