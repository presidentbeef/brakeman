
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/5/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/07/24/brakeman-4-dot-6-dot-1-released">Brakeman 4.6.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-07-24 09:14:00 -0700" pubdate  updated >2019-07-24 09:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release corrects a typo in the reverse tabnabbing warning message.</p>

<p><em>Changes since 4.6.0:</em></p>

<ul>
  <li>Fix Reverse Tabnabbing warning message (<a href="https://github.com/stsc3000">Steffen Schildknecht</a> / <a href="https://github.com/joergschiller">Jörg Schiller</a>)</li>
</ul>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>6e31f8c8dbdea7b198c591d44b73aee067cca5612db191fe04d8d8c2a8eb9011  brakeman-4.6.1.gem
6879d5175e5f20bf5ac1bd20dad0ef9a1e4c72d9774114d752b19c7e7d7d69fc  brakeman-lib-4.6.1.gem
72a0ef7b91b11bea925b365645096a186ec3929024066792957006c46355560e  brakeman-min-4.6.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/07/23/brakeman-4-dot-6-dot-0-released">Brakeman 4.6.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-07-23 13:14:00 -0700" pubdate  updated >2019-07-23 13:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release has two new checks!</p>

<p><em>Changes since 4.5.1:</em></p>

<ul>
  <li>Add check for cookie serialization with Marshal (<a href="https://github.com/presidentbeef/brakeman/issues/1316">#1316</a>)</li>
  <li>Add reverse tabnabbing check (<a href="https://github.com/linosgian">Linos Giannopoulos</a>)</li>
  <li>Avoid warning about file access with <code class="highlighter-rouge">ActiveStorage::Filename#sanitized</code> (<a href="https://github.com/tejasbubane">Tejas Bubane</a>)</li>
  <li>Update loofah version for fixing <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-8048">CVE-2018-8048</a> (<a href="https://github.com/MartyBeGood">Markus Nölle</a>)</li>
  <li>Warn people that Haml 5 is not fully supported (<a href="https://github.com/jaredbeck">Jared Beck</a>)</li>
  <li>Index calls in initializers</li>
  <li>Improve template output handling in conditional branches</li>
  <li>Avoid assigning <code class="highlighter-rouge">nil</code> line numbers to <code class="highlighter-rouge">Sexp</code>s</li>
  <li>Add special warning code for custom checks</li>
  <li>Add call matching by regular expression</li>
  <li>Skip calls to <code class="highlighter-rouge">dup</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1374">#1374</a>)</li>
  <li>Restore <code class="highlighter-rouge">Warning#relative_path</code></li>
  <li>Better handling of gems with no version declared</li>
</ul>

<h3 id="cookie-serialization-check">Cookie Serialization Check</h3>

<p>Brakeman will now warn if <code class="highlighter-rouge">Rails.application.config.action_dispatch.cookies_serializer</code> is set to <code class="highlighter-rouge">:marshal</code> or <code class="highlighter-rouge">:json</code>.</p>

<p>This options allow cookies to be deserialized via <code class="highlighter-rouge">Marshal</code>. If an attacker is able to construct a valid encrypted cookie, this could lead to arbitrary code execution.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1364">changes</a>)</p>

<h3 id="reverse-tabnabbing-check">Reverse Tabnabbing Check</h3>

<p><a href="https://github.com/linosgian">Linos Giannopoulos</a> has added an optional check for cases of “reverse tabnabbing”. This occurs when a link is opened in a new window/tab via a link (with <code class="highlighter-rouge">target: '_blank'</code>).
The new window can control the location of the old window. If an attacker controls the new window, they can redirect the old window to a malicious site. This is especially useful for 
phishing attacks. These kinds of attacks are most likely on applications that allow arbitrary links to external sites.</p>

<p>To completely remove the ability of an attacker to control the old window, add <code class="highlighter-rouge">rel: "noreferrer noopener"</code> to the <code class="highlighter-rouge">link_to</code> call. Note: this will cause the new window to lose referrer information.</p>

<p>To enable this new check, use <code class="highlighter-rouge">--enable ReverseTabnabbing</code> or <code class="highlighter-rouge">-A</code> to enable all optional checks.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1367">changes</a>)</p>

<h3 id="file-access-false-positive">File Access False Positive</h3>

<p><a href="https://github.com/tejasbubane">Tejas Bubane</a> provided a fix to ignore use of <code class="highlighter-rouge">ActiveStorage::Filename#sanitized</code> inside file access calls.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1375">changes</a>)</p>

<h3 id="fixed-loofah-version">Fixed Loofah Version</h3>

<p><a href="https://github.com/MartyBeGood">Markus Nölle</a> corrected the “fixed” version of Loofah for CVE-2018-8048 from <code class="highlighter-rouge">2.1.2</code> to <code class="highlighter-rouge">2.2.1</code>. Oops!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1371">changes</a>)</p>

<h3 id="haml-5-support">Haml 5 Support</h3>

<p><a href="https://github.com/jaredbeck">Jared Beck</a> added a notification when Haml 5 is in use by an application. At the moment, Brakeman does not support Haml 5.x.
There appear to be only a few syntax differences between Haml 4.x and 5.x, so most users are unaffected.</p>

<p>Support is planned for a future release.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1379">changes</a>)</p>

<h3 id="initializers-more-fully-supported">Initializers More Fully Supported</h3>

<p>When Brakeman scans an application, <a href="https://blog.presidentbeef.com/blog/2012/11/28/faster-call-indexing-in-brakeman-1-dot-8-3/">it “indexes” all method calls of interest</a>. Most checks then operated on those indexed calls.</p>

<p>However, for historical reasons, initializers (files in <code class="highlighter-rouge">config/initializers/</code>) were not included in that index.</p>

<p>Now they are! Besides some modest speed gains and simpler/more consistent checks, now regular old checks can “see” initializers.
This may result in previously-unreported warnings now popping up in initializers.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1363">changes</a>)</p>

<h3 id="conditional-branches-in-templates">Conditional Branches in Templates</h3>

<p>Very obvious code like this:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= blah ? x : params[:x].html_safe %&gt;
</code></pre></div></div>

<p>Was not being handled correctly and the cross-site scripting issue would not be reported. This is now fixed!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1361">changes</a>)</p>

<h3 id="empty-line-numbers">Empty Line Numbers</h3>

<p><a href="https://github.com/seattlerb/sexp_processor/commit/ce284487f057203360c41b14d2b25f8c5453fbb9">A change in <code class="highlighter-rouge">sexp_processor</code></a> causes it to raise an exception if an <code class="highlighter-rouge">Sexp</code> is assigned a <code class="highlighter-rouge">nil</code> line.
Brakeman was a bit cavalier when assigning line numbers, so this caused an issue for some users.</p>

<p>As a result, line numbers should be assigned a bit more consistently now.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1360">changes</a>)</p>

<h3 id="custom-check-warning-code">Custom Check Warning Code</h3>

<p>Every warning reported by Brakeman refers to an integer “warning code”. This is so the “warning type” or category can be a bit more flexible if we want to change the name or formatting.
However, this list of warning codes is hardcoded into Brakeman. The hardcoding makes it hard for users to add their own checks, because they need to either use an existing code or monkey-patch in a new one.</p>

<p>To help with this situation, custom checks/rules can now use the <code class="highlighter-rouge">:custom_check</code> warning code.</p>

<p><a href="https://github.com/presidentbeef/brakeman/wiki/Creating-Custom-Brakeman-Rules">A tutorial on writing custom checks is in progress</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1377">changes</a>)</p>

<h3 id="call-matching-via-regex">Call Matching via Regex</h3>

<p>It is now possible to search for call targets by regular expression, although it is discouraged for performance reasons.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1358">changes</a>)</p>

<h3 id="dup-calls">Dup Calls</h3>

<p>Brakeman now skips calls to <code class="highlighter-rouge">#dup</code> as if they aren’t there.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1386">changes</a>)</p>

<h3 id="warningrelative_path"><code class="highlighter-rouge">Warning#relative_path</code></h3>

<p><code class="highlighter-rouge">Warning#relative_path</code> has been added back for dependencies that might need it, such as <a href="https://github.com/guard/guard-brakeman/pull/36/">guard-brakeman</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1365">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>48be7f5a8d814ad42bbb9a2222a331e59a8ece9b50103d8e809a0bbc9d128ef9  brakeman-4.6.0.gem
ff81f5d6fb258a1b83c78ba4144163d1183bd9f31536782722617e880ff85917  brakeman-lib-4.6.0.gem
ef3ad0f59dc32630b1e39f289257cf33a882f2838f455e6009c0cb973ee1d378  brakeman-min-4.6.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/05/11/4-dot-5-1-released">Brakeman 4.5.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-05-11 13:14:00 -0700" pubdate  updated >2019-05-11 13:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release adds initial support for Rails 6!</p>

<p><em>Changes since 4.5.0:</em></p>

<ul>
  <li>Add initial Rails 6 support</li>
  <li>Add optional check for <code class="highlighter-rouge">config.force_ssl</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1181">#1181</a>)</li>
  <li>Add deserialization warning for <code class="highlighter-rouge">Oj.load/object_load</code></li>
  <li>Add SQL injection checks for <code class="highlighter-rouge">destroy_by</code>/<code class="highlighter-rouge">delete_by</code></li>
  <li>Add SQL injection checks for <code class="highlighter-rouge">find_or_create_by</code> and friends</li>
  <li>Check <code class="highlighter-rouge">link_to</code> with block for href XSS (<a href="https://github.com/presidentbeef/brakeman/issues/1339">#1339</a>)</li>
  <li>Convert <code class="highlighter-rouge">!!</code> calls to boolean value (<a href="https://github.com/presidentbeef/brakeman/issues/1343">#1343</a>)</li>
  <li>Use relative paths for <code class="highlighter-rouge">__FILE__</code></li>
  <li>Represent file paths internally as <code class="highlighter-rouge">Brakeman::FilePath</code></li>
  <li>Handle empty partial names</li>
  <li>Handle trailing comma in block args</li>
  <li>Remove code for Ruby versions prior to 1.9</li>
</ul>

<h3 id="initial-rails-6-support">Initial Rails 6 Support</h3>

<p>Rails 6 is (almost?) here!</p>

<p>This release adds basic support internally for Rails 6 as well as the <code class="highlighter-rouge">-6</code> option to force Rails 6 mode.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1335">changes</a>)</p>

<h3 id="optional-check-for-force-ssl-option">Optional Check for Force SSL Option</h3>

<p>In Rails, <code class="highlighter-rouge">config.force_ssl = true</code> turns on HSTS, redirects HTTP to HTTPS, and sets the <code class="highlighter-rouge">secure</code> flag on all cookies.</p>

<p>A new optional check has been added to check if this option is enabled.</p>

<p>To enable this new check, use <code class="highlighter-rouge">-A</code> or <code class="highlighter-rouge">--enable ForceSSL</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1344">changes</a>)</p>

<h3 id="deserialization-with-oj">Deserialization with Oj</h3>

<p>The deserialization check now looks for unsafe use of the <code class="highlighter-rouge">Oj</code> JSON library.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1334">changes</a>)</p>

<h3 id="new-sql-injection-sinks">New SQL Injection Sinks</h3>

<p>The SQL injection check has been expanded to check for unsafe use of <code class="highlighter-rouge">destroy_by</code>/<code class="highlighter-rouge">delete_by</code> (new in Rails 6) and <code class="highlighter-rouge">find_or_create_by</code> and related methods.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1337">changes</a>)</p>

<h3 id="link_to-with-block"><code class="highlighter-rouge">link_to</code> with Block</h3>

<p>Brakeman now checks <code class="highlighter-rouge">link_to</code> calls with blocks for <code class="highlighter-rouge">javascript:</code> links.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1340">changes</a>)</p>

<h3 id="convert--to-boolean">Convert <code class="highlighter-rouge">!!</code> to Boolean</h3>

<p>Use of <code class="highlighter-rouge">!!</code> to convert values to booleans will be treated as safe (turned into <code class="highlighter-rouge">true or false</code>).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1345">changes</a>)</p>

<h3 id="relative-path-for-__file__">Relative Path for <code class="highlighter-rouge">__FILE__</code></h3>

<p>When ruby_parser parses <code class="highlighter-rouge">__FILE__</code>, it replaces it with the name of the current file. Unfortunately, Brakeman was passing in absolute paths for the current file.
This meant that the fingerprints for warnings including <code class="highlighter-rouge">__FILE__</code> would vary based on the path where the code was scanned.</p>

<p>Now a relative path is used instead, so fingerprints should stabilize.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1347">changes</a>)</p>

<h3 id="brakemanfilepath"><code class="highlighter-rouge">Brakeman::FilePath</code></h3>

<p>Internally, file paths are now represented with <code class="highlighter-rouge">Brakeman::FilePath</code> to make it easier to manage absolute/relative paths as needed. This was a pretty huge change, so please report any issues.</p>

<p>As a result, the <code class="highlighter-rouge">--no-separate-models</code> option no longer works (it used to combine all model-level mass assignment warnings into one warning).
That old option used to report a completely messed-up file name, which is incompatible with <code class="highlighter-rouge">Brakeman::FilePath</code>. Also, it was weird and wrong.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1354">changes</a>)</p>

<h3 id="empty-partial-names">Empty Partial Names</h3>

<p>If any empty string ends up as a partial name in a <code class="highlighter-rouge">render</code> call, Brakeman will ignore it.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1352">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>c8c48a88e9cd837122a590837ff5dbb4bd8214ad72baaffb75e5e5cd3585166f  brakeman-4.5.1.gem
48eaff4eb661f63d43c2f8b33da8efbabc6196ae5ff2ec58ad711e1649eff686  brakeman-lib-4.5.1.gem
c6fcfc5c32ec79a50281b0b97be5b703385ffb20ef45f770e7888ca6ba0b1666  brakeman-min-4.5.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/03/15/4-dot-5-0-released">Brakeman 4.5.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-03-15 13:14:00 -0700" pubdate  updated >2019-03-15 13:14:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release drops support for running Brakeman with versions of Ruby older than 2.3.0. As always, scanning code with older syntax continues to be supported.</p>

<p>Also in this release: better supported for embedded “filters” in templates and (relatedly) the Sass dependency was removed!</p>

<p><em>Changes since 4.4.0:</em></p>

<ul>
  <li>Officially drop support for running with older Ruby versions</li>
  <li>More thoroughly handle <code class="highlighter-rouge">Shellwords</code> escaping (<a href="https://github.com/presidentbeef/brakeman/issues/1323">#1323</a>)</li>
  <li>Handle non-integer version number comparisons (<a href="https://github.com/presidentbeef/brakeman/issues/1305">#1305</a>)</li>
  <li>Better handling of splat/kwsplat arguments (<a href="https://github.com/presidentbeef/brakeman/issues/1204">#1204</a>)</li>
  <li>Handle <code class="highlighter-rouge">**</code> inside Hash literals</li>
  <li>Add support for CoffeeScript in Slim templates</li>
  <li>Improve support for embedded template “filters”</li>
  <li>Remove Sass dependency</li>
  <li>Avoid joining strings with different encodings</li>
  <li>Improve “user input” reported for SQL injection</li>
  <li>Stop swallowing exceptions in <code class="highlighter-rouge">AliasProcessor</code></li>
  <li>Add original exception to <code class="highlighter-rouge">Tracker#errors</code> list</li>
  <li>Use <code class="highlighter-rouge">FileParser</code> in <code class="highlighter-rouge">Scanner</code> to parse files</li>
  <li>Set location information in <code class="highlighter-rouge">CheckContentTag</code></li>
  <li>Update RubyParser to 3.13.0</li>
</ul>

<h3 id="dropped-support-for-older-rubies">Dropped Support for Older Rubies</h3>

<p>Brakeman code will no longer attempt to maintain compatibility with Ruby 1.9.3, instead setting the minimum version to Ruby 2.3.0.</p>

<p>Note that Ruby 2.2.0 reached end of life almost a year ago and is no longer receiving security updates.</p>

<p>This does <em>not</em> affect the versions of Ruby code Brakeman can analyze. Thanks to RubyParser, scanning syntax back to Ruby 1.8 is still supported.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1329">changes</a>)</p>

<h3 id="more-shell-escaping">More Shell Escaping</h3>

<p>Brakeman is now better at handling shell escaping with <code class="highlighter-rouge">Shellwords</code> when checking for command injection.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1327">changes</a>)</p>

<h3 id="non-integer-version-numbers">Non-Integer Version Numbers</h3>

<p>When comparing non-integer version numbers (e.g., <code class="highlighter-rouge">"beta1"</code>), Brakeman will compare integers to integers and strings to strings instead of
incorrectly converting some strings to integers.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1326">changes</a>)</p>

<h3 id="more-splats">More Splats</h3>

<p>Splat args (<code class="highlighter-rouge">*arg</code>) and double splat/keyword splats (<code class="highlighter-rouge">**kwargs</code>) are better supported now (instead of being ignored).
Keyward splats inside of hash literals will be merged into the hash literal.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1315">changes</a>)</p>

<h3 id="embedded-template-filters">Embedded Template Filters</h3>

<p>Support for embedded filters in templates (e.g. <code class="highlighter-rouge">markdown</code> inside of Haml or Slim) has been completely rewritten. As a result, it is simpler to support embedded filters <em>and</em> it was possible to drop the Sass dependency. (The Sass gem itself is deprecated and will be <a href="https://sass-lang.com/ruby-sass">end of life as of March 31st, 2019</a>.)</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1314">changes</a>)</p>

<h3 id="string-encoding">String Encoding</h3>

<p>Previously, it was possible to run into errors when Brakeman attempted to join or concatenate strings with different encodings. Now it will just fail and leave the strings apart.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1293">changes</a>)</p>

<h3 id="better-reporting-of-sql-injection">Better Reporting of SQL Injection</h3>

<p>SQL injection warnings now have better information about which value triggered the warning. Previously, sometimes the value highlighted as “dangerous” was misleading and confusing.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1297">changes</a>)</p>

<h3 id="rubyparser-updated">RubyParser Updated</h3>

<p>Thanks to <a href="http://www.zenspider.com/">Ryan Davis</a>, RubyParser now has better support for newer Ruby 2.5 and Ruby 2.6 syntax, along with many other fixes!</p>

<p>This should address many of the parsing errors folks have been seeing.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1330">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>c82c73e47668e1381829bcf50d09b952f7968bc36af9c5abd6ee20ee03882130  brakeman-4.5.0.gem
0d372dac72e6bf7f9ff9c2558e3f5d92ef62cd4c6ab051fcea88016f3bfa7470  brakeman-lib-4.5.0.gem
8565a780be3595ffc5a8d847f6eece8746a272138290fff115555d7aecaa1a38  brakeman-min-4.5.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2019/01/17/brakeman-4-dot-4-dot-0-released">Brakeman 4.4.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2019-01-17 13:14:00 -0800" pubdate  updated >2019-01-17 13:14:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>Happy new year and apologies for the delay in releases! Brakeman should now return to the normal 1-2 month release cycle. There are already pull requests lined up for the next release.</p>

<p>This release includes a number of fixes and new features. In particular, please note there are large changes to how reports and warning messages are generated. Please report any issues!</p>

<p>Also, the <code class="highlighter-rouge">brakeman</code> gem version of this release no longer supports use of Slim with Ruby 1.9.3. See below for details.</p>

<p>As noted previously, due to the <a href="https://brakemanscanner.org/blog/2018/06/28/brakeman-has-been-acquired-by-synopsys/index.html">Synopsys acquisition</a> Brakeman is now distributed under a non-OSS license. See below for details.</p>

<p><em>Changes since 4.3.1:</em></p>

<ul>
  <li>Add check for CVE-2018-3760</li>
  <li>Add <code class="highlighter-rouge">--enable</code> option to enable optional checks</li>
  <li>Add Dockerfile to run Brakeman inside Docker (<a href="https://github.com/ryankemper">Ryan Kemper</a>)</li>
  <li>Handle empty <code class="highlighter-rouge">secrets.yml</code> files (<a href="https://github.com/naokikimura">Naoki Kimura</a>)</li>
  <li>Ignore Tempfiles in FileAccess warnings (<a href="https://github.com/cmkoller">Christina Koller</a>)</li>
  <li>Avoid warning about command injection when <code class="highlighter-rouge">String#shellescape</code> and <code class="highlighter-rouge">Shellwords.shelljoin</code> are used (<a href="https://github.com/oggy">George Ogata</a>)</li>
  <li>Treat <code class="highlighter-rouge">if not</code> like <code class="highlighter-rouge">unless</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1225">#1225</a>)</li>
  <li>Fix Rails 4 configuration handling</li>
  <li>Set default encoding to UTF-8</li>
  <li>Support reading gem versions from gemspecs</li>
  <li>Support gem versions which are just major.minor (e.g. 3.0)</li>
  <li>Correctly set <code class="highlighter-rouge">rel="noreferrer"</code> in HTML reports</li>
  <li>Fix thread-safety issue in CallIndex</li>
  <li>Fix trim mode for ERb templates in old Rails versions</li>
  <li>Avoid <code class="highlighter-rouge">nil</code> errors when concatenating arrays</li>
  <li>Add rendered template information to render paths</li>
  <li>Trim some unnecessary files from bundled gems</li>
  <li>Deadcode and typo fixes found via Coverity</li>
  <li>Complete overhaul of warning message construction</li>
  <li>Update to Slim 4.0.1 (<a href="https://github.com/Jakenberg">Jake Peterson</a>)</li>
  <li>Update to RubyParser 3.12.0</li>
  <li>Updated license</li>
</ul>

<h3 id="cve-2018-3760">CVE-2018-3760</h3>

<p>A new check was added for <a href="https://groups.google.com/d/msg/rubyonrails-security/ft_J--l55fM/7roDfQ50BwAJ">CVE-2018-3760</a> (Sprockets path traversal vulnerability).
Brakeman will warn about use of the affected Sprockets version and <code class="highlighter-rouge">config.assets.compile = true</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1241">changes</a>)</p>

<h3 id="enable-optional-checks">Enable Optional Checks</h3>

<p>Brakeman has options to enable <em>all</em> checks, to disable <em>some</em> checks, and to enable a subset of checks, but not to enable <em>default</em>+<em>some optional</em> checks.</p>

<p>The <code class="highlighter-rouge">--enable</code> option has been added to allow enabling individual optional checks.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1263">changes</a>)</p>

<h3 id="docker-support">Docker Support</h3>

<p>Thanks to <a href="https://github.com/ryankemper">Ryan Kemper</a>, Brakeman now has a Dockerfile to enable local building and running of Brakeman inside Docker.</p>

<p>Additionally, there is now a <a href="https://hub.docker.com/r/presidentbeef/brakeman">Docker image available for Brakeman</a>:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>docker pull presidentbeef/brakeman
docker run -v "$(pwd)":/code brakeman --color
</code></pre></div></div>

<p>See the Brakeman <a href="https://github.com/presidentbeef/brakeman#running-with-docker">README</a> for more details.</p>

<p>Please note the Docker image is built from the master Brakeman branch. The master branch is typically stable, but it will typically be ahead of the gem release.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1252">changes</a>)</p>

<h3 id="empty-secrets">Empty Secrets</h3>

<p>Thanks to <a href="https://github.com/naokikimura">Naoki Kimura</a>, Brakeman will no longer show an error when the <code class="highlighter-rouge">secrets.yml</code> file is empty.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1254">changes</a>)</p>

<h3 id="file-access-with-tempfiles">File Access with Tempfiles</h3>

<p>Thanks to <a href="https://github.com/cmkoller">Christina Koller</a>, Brakeman will no longer warn about file access issues when Tempfiles are used.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1244">changes</a>)</p>

<h3 id="shellescape-and-command-injection">Shellescape and Command Injection</h3>

<p>Thanks to <a href="https://github.com/oggy">George Ogata</a>, Brakeman will no longer warn about command injection when <code class="highlighter-rouge">shelljoin</code> or <code class="highlighter-rouge">shellescape</code> are used.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1242">changes</a>)</p>

<h3 id="rails-4-configuration">Rails 4 Configuration</h3>

<p>When implementing the check for CVE-2018-3760, it was discovered that Brakeman was not handling the Rails 4 configuration format properly:</p>

<p>Brakeman was not picking up any configuration options if this format was used:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;AppName&gt;.application.configure do
  #...
end
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1241/commits/515a2f9e185f2488e227f39ed930ef6cf2bcee3a">changes</a>)</p>

<h3 id="default-encoding">Default Encoding</h3>

<p>Brakeman now sets the default external encoding to <code class="highlighter-rouge">UTF-8</code> to avoid issues where the environment might set a different encoding.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1288">changes</a>)</p>

<h3 id="gem-versions">Gem Versions</h3>

<p>Brakeman can now read gem versions from <code class="highlighter-rouge">gemspec</code> files. This is common for Rails engines.</p>

<p>Additionally, Brakeman now understands versions which only specify major/minor versions (e.g. <code class="highlighter-rouge">~&gt;4.0</code>).</p>

<p>The order of precedence is <code class="highlighter-rouge">Gemfile.lock</code> &gt; <code class="highlighter-rouge">Gemfile</code> &gt; <code class="highlighter-rouge">*.gemspec</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1257/">changes</a>)</p>

<h3 id="no-referrer-in-html-reports">No Referrer in HTML Reports</h3>

<p>Brakeman has unfortunately been setting <code class="highlighter-rouge">rel="no-referrer"</code> instead of <code class="highlighter-rouge">rel="noreferrer"</code> in HTML reports.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1259/commits/d3e487bfd1d080971af56f7658bf2c8888e4cdb2">changes</a>)</p>

<h3 id="thread-safety-in-call-index">Thread-Safety in Call Index</h3>

<p>In rare cases (heavy CPU load?), accessing the CallIndex when running checks caused thread-unsafe behavior. This would have been reflected in a Ruby error about modifying the index during iteration, although checks don’t actual modify the CallIndex.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1271">changes</a>)</p>

<h3 id="erb-trim-mode">ERb Trim Mode</h3>

<p>Brakeman has been accidentally setting the “trim mode” to the template file path (oops!) which silently (!) worked in tests. This only affects Rails 2.x.</p>

<p>This has been corrected and Ruby will now warn about <a href="https://redmine.ruby-lang.org/issues/15294">incorrect trim modes</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1278">changes</a>)</p>

<h3 id="array-joins">Array Joins</h3>

<p>This release fixes a <code class="highlighter-rouge">nil</code> error when attempting to concatenate arrays.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1251">changes</a>)</p>

<h3 id="rendered-template-information">Rendered Template Information</h3>

<p>Template “render paths” now include <em>which</em> template was rendered.</p>

<p>This is reflected in the JSON report:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>      "render_path": [
        {
          "type": "controller",
          "class": "HomeController",
          "method": "test_to_json",
          "line": 148,
          "file": "app/controllers/home_controller.rb",
          "rendered": {
            "name": "home/test_to_json",
            "file": "app/views/home/test_to_json.html.erb"
          }
        }
      ]
</code></pre></div></div>

<p>In the future this information may be used to improve other report formats as well.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1280">changes</a></p>

<h3 id="reduced-gem-size">Reduced Gem Size</h3>

<p>The <code class="highlighter-rouge">brakeman</code> gem <a href="https://blog.presidentbeef.com/blog/2016/08/09/bundling-gem-dependencies-inside-ruby-gems/">bundles all its dependencies</a>, which makes the gem a bit big.</p>

<p>This change removes some of the unneeded files (such as tests) and reduces the file size by about a third.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1253">changes</a>)</p>

<h3 id="dead-code-and-typos">Dead Code and Typos</h3>

<p>A few bits of dead code and minor typos were found via <a href="https://www.synopsys.com/software-integrity/security-testing/static-analysis-sast.html">Coverity</a> and fixed.</p>

<h3 id="warning-message-overhaul">Warning Message Overhaul</h3>

<p>Brakeman warning messages were previously just strings.</p>

<p>In order to introduce some formatting flexibility, Brakeman warning messages are now constructed as arrays of <code class="highlighter-rouge">Message</code> objects.
These objects specify the type of the message string (e.g. “code” or “plain”). At report generation time, the messages can be converted to a particular format,
such as HTML, plaintext, etc.</p>

<p>Along with this change, quite a bit of cleanup was performed on report generation in general.</p>

<p>These changes make it easier to produce consistent messages as well as potentially supporting translation in the future.</p>

<p>You may notice warning message text and/or formatting has changed as a result of these changes.
Please report any issues.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1259">changes</a>)</p>

<h3 id="dependency-updates">Dependency Updates</h3>

<p>Thanks to <a href="https://github.com/Jakenberg">Jake Peterson</a>, the Slim dependency has been updated to 4.0.1 to support newer syntax.</p>

<p>Note that Slim 4.x not longer supports Ruby 1.9.3. You may need to use the <code class="highlighter-rouge">brakeman-lib</code> gem or update your Ruby version.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1285">changes</a>)</p>

<p>RubyParser has been updated to 3.12.0 which includes <a href="https://github.com/seattlerb/ruby_parser/blob/master/History.rdoc#3120--2018-12-04">some added syntax support and is faster!</a></p>

<blockquote class="twitter-tweet" data-conversation="none" data-lang="en"><p lang="en" dir="ltr">Here are some example Brakeman scan times with the RubyParser improvements. <a href="https://t.co/yTxPVTGELH">pic.twitter.com/yTxPVTGELH</a></p>&mdash; Justin Collins (@presidentbeef) <a href="https://twitter.com/presidentbeef/status/1068232020478717952?ref_src=twsrc%5Etfw">November 29, 2018</a></blockquote>
<script async="" src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1286">changes</a>)</p>

<h3 id="new-license">New License</h3>

<p>Brakeman is now distributed under the <a href="https://github.com/presidentbeef/brakeman/blob/master/LICENSE.md">Brakeman Public Use License</a> which restricts commercial use of Brakeman.</p>

<p>It does not restrict use of Brakeman to scan <em>your own code</em> or your organization’s code, regardless of whether that code is proprietary, commercial, free, open source, etc.</p>

<p>Feel free to message <a href="https://twitter.com/presidentbeef">@presidentbeef</a> if you have questions.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1301">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>d3204cfe9d26782954ee8805fd748d11e8f950d2c1aee7c806c1856f273ee3b9  brakeman-4.4.0.gem
88849f05b1c85756fee8974b8061383493714676187af3b94b6a7978a7e1e58d  brakeman-lib-4.4.0.gem
0417c20b0b6dab00c5cf5e9341868dc5d8139bca463bf45fefa925cac286127e  brakeman-min-4.4.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
<script type='text/javascript'>
    $(document).ready(function(){
        $("#github").GitHubBadge({
          login: "presidentbeef",
          kind: "project",
          repo_name: "brakeman",
          include_github_logo: false,
          image_path: "",
          commit_count: "1",
          issue_count: "0",
          repo_count: "0"
      });
    });
</script>
<div id="github"></div>
<a href="https://travis-ci.org/#!/presidentbeef/brakeman"><img src="https://secure.travis-ci.org/presidentbeef/brakeman.png" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2022/05/01/brakeman-5-dot-2-dot-3-released">Brakeman 5.2.3 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">Brakeman 5.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/01/30/5-dot-2-dot-1-released">Brakeman 5.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/12/15/brakeman-5-dot-2-dot-0-released">Brakeman 5.2.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/28/brakeman-5-dot-1-dot-2-released">Brakeman 5.1.2 Released</a>
      </li>
    
  </ul>
</section>

  <section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <a class="twitter-timeline" data-dnt=true href="https://twitter.com/brakeman" data-widget-id="258654953097273345">Tweets by @brakeman</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
