
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/4/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2021/07/19/brakeman-5-dot-1-dot-0-released">Brakeman 5.1.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2021-07-19 15:00:00 -0600" pubdate  updated >2021-07-19 15:00:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a <em>huge</em> release! (So many changes, I had to look up how to nest lists in Markdown…)</p>

<p>Thank you to the many contributors!</p>

<p>There are several new features, take a look below.</p>

<p><em>Changes since 5.0.4:</em></p>

<ul>
  <li>Report Formats
    <ul>
      <li>Add GitHub Actions format (<a href="https://github.com/klausbadelt">Klaus Badelt</a>)</li>
      <li>Add ignored warnings to SARIF report (<a href="https://github.com/eliblock">Eli Block</a>)</li>
      <li>Fix SARIF report when checks have no description (<a href="https://github.com/eliblock">Eli Block</a>)</li>
      <li>Adjust copy of <code class="language-plaintext highlighter-rouge">--interactive</code> menu (<a href="https://github.com/elia">Elia Schito</a>)</li>
    </ul>
  </li>
  <li>Performance
    <ul>
      <li>Read and parse files in parallel</li>
    </ul>
  </li>
  <li>Ruby Interpretation
    <ul>
      <li>Initial support for ActiveRecord enums (<a href="https://github.com/presidentbeef/brakeman/issues/1492">#1492</a>)</li>
      <li>Interprocedural dataflow from very simple class methods</li>
      <li>Support <code class="language-plaintext highlighter-rouge">Array#fetch</code> and <code class="language-plaintext highlighter-rouge">Hash#fetch</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1571">#1571</a>)</li>
      <li>Support <code class="language-plaintext highlighter-rouge">Array#push</code></li>
      <li>Support <code class="language-plaintext highlighter-rouge">Array#*</code></li>
      <li>Better <code class="language-plaintext highlighter-rouge">Array#join</code> support</li>
      <li>Support <code class="language-plaintext highlighter-rouge">Hash#values</code> and <code class="language-plaintext highlighter-rouge">Hash#values_at</code></li>
      <li>Support <code class="language-plaintext highlighter-rouge">Hash#include?</code></li>
    </ul>
  </li>
  <li>SQL Injection
    <ul>
      <li>Update SQL injection check for Rails 6.0/6.1</li>
      <li>Add <code class="language-plaintext highlighter-rouge">--sql-safe-methods</code> option (<a href="https://github.com/escheiner">Esty Scheiner</a>)</li>
      <li>Ignore dates in SQL</li>
      <li>Ignore <code class="language-plaintext highlighter-rouge">sanitize_sql_like</code> in SQL (<a href="https://github.com/presidentbeef/brakeman/issues/1571">#1571</a>)</li>
      <li>Ignore method calls on numbers in SQL (<a href="https://github.com/presidentbeef/brakeman/issues/1571">#1571</a>)</li>
    </ul>
  </li>
  <li>Other Fixes
    <ul>
      <li>Ignore renderables in dynamic render path check (<a href="https://github.com/bradparker">Brad Parker</a>)</li>
      <li>Fix false positive in command injection with <code class="language-plaintext highlighter-rouge">Open3.capture</code> (<a href="https://github.com/xulaus">Richard Fitzgerald</a>)</li>
      <li>Fix infinite loop on mixin self-includes (<a href="https://github.com/Skipants">Andrew Szczepanski</a>)</li>
      <li>Check for user-controlled evaluation even if it’s a call target (<a href="https://github.com/presidentbeef/brakeman/issues/1590">#1590</a>)</li>
    </ul>
  </li>
  <li>Refactoring
    <ul>
      <li>Refactor <code class="language-plaintext highlighter-rouge">cookie?</code>/<code class="language-plaintext highlighter-rouge">param?</code> methods (<a href="https://github.com/kbrock">Keenan Brock</a>)</li>
      <li>Better method definition tracking and lookup</li>
    </ul>
  </li>
</ul>

<h2 id="report-formats">Report Formats</h2>

<p><a href="https://github.com/klausbadelt">Klaus Badelt</a> added support for GitHub Actions annotation format with <code class="language-plaintext highlighter-rouge">-f github</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1580">changes</a>)</p>

<p><a href="https://github.com/eliblock">Eli Block</a> added support for reporting ignored warnings in SARIF using the “suppressed” property and fixed a SARIF bug.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1620">changes</a>)</p>

<p><a href="https://github.com/elia">Elia Schito</a> clarified some text in the <code class="language-plaintext highlighter-rouge">--interactive</code> menu for ignoring warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1598">changes</a>)</p>

<h2 id="parallel-file-parsing">Parallel File Parsing</h2>

<p>Brakeman now uses the <a href="https://rubygems.org/gems/parallel"><code class="language-plaintext highlighter-rouge">parallel</code></a> gem to read and parse files in parallel.</p>

<p>By default, <code class="language-plaintext highlighter-rouge">parallel</code> will split the reading/parsing into a number of separate processes based on
number of CPUs.</p>

<p>In testing, this has dramatically improved speed for large code bases - around 35% reduction in overall scan time.</p>

<p>However, if you run into weird behavior (e.g. scanning just hangs during file parsing), this feature
can be disabled using <code class="language-plaintext highlighter-rouge">--no-threads</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1617">changes</a>)</p>

<h2 id="ruby-interpretation">Ruby Interpretation</h2>

<h3 id="simple-class-methods">Simple Class Methods</h3>

<p>Brakeman will now track and return <em>very simple</em> literal values (e.g. strings, hashes of literals, arrays of literals) from <em>very simple</em> class methods (e.g. single line).</p>

<p>For example:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span>
  <span class="k">def</span> <span class="nc">self</span><span class="o">.</span><span class="nf">path_prefix</span>
    <span class="s1">'/user'</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="no">User</span><span class="p">.</span><span class="nf">path_prefix</span> <span class="c1"># =&gt; '/user'</span>
</code></pre></div></div>

<p>This should help prevent some false positives.</p>

<h3 id="enums">Enums</h3>

<p>Since <a href="https://api.rubyonrails.org/v6.1.4/classes/ActiveRecord/Enum.html">ActiveRecord enums</a> essentially generate some class (and instance) methods that return fixed literal values, the above class method return values
is also used to support <code class="language-plaintext highlighter-rouge">enum</code>.</p>

<p>For example:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">User</span> <span class="o">&lt;</span> <span class="no">ActiveRecord</span><span class="o">::</span><span class="no">Base</span>
  <span class="n">enum</span> <span class="ss">status: </span><span class="p">[</span><span class="ss">:pending</span><span class="p">,</span> <span class="ss">:active</span><span class="p">,</span> <span class="ss">:locked</span><span class="p">]</span>
<span class="k">end</span>

<span class="no">User</span><span class="p">.</span><span class="nf">statuses</span><span class="p">[</span><span class="ss">:pending</span><span class="p">]</span> <span class="c1"># =&gt; 0</span>
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1572">changes</a>)</p>

<h3 id="hash-and-array-methods">Hash and Array Methods</h3>

<p>In some ways, Brakeman is a very poor Ruby interpreter.
To “understand” the code it analyzes, Brakeman essentially evaluates some methods.
This release adds and improves support for evaluating a number of <code class="language-plaintext highlighter-rouge">Hash</code> and <code class="language-plaintext highlighter-rouge">Array</code> methods.</p>

<ul>
  <li>Support <code class="language-plaintext highlighter-rouge">Array#fetch</code> and <code class="language-plaintext highlighter-rouge">Hash#fetch</code>
(<a href="https://github.com/presidentbeef/brakeman/pull/1589">changes</a>)</li>
  <li>Support <code class="language-plaintext highlighter-rouge">Array#push</code>
(<a href="https://github.com/presidentbeef/brakeman/pull/1600">changes</a>)</li>
  <li>Support <code class="language-plaintext highlighter-rouge">Array#*</code> and improve <code class="language-plaintext highlighter-rouge">Array#join</code>
(<a href="https://github.com/presidentbeef/brakeman/pull/1599">changes</a>)</li>
  <li>Support <code class="language-plaintext highlighter-rouge">Hash#values</code> and <code class="language-plaintext highlighter-rouge">Hash#values_at</code>
(<a href="https://github.com/presidentbeef/brakeman/pull/1595">changes</a>)</li>
  <li>Support <code class="language-plaintext highlighter-rouge">Hash#include?</code>
(<a href="https://github.com/presidentbeef/brakeman/pull/1618/commits/3554a2c7f259b3a96dc69877c9596c81190eed8d">changes</a>)</li>
</ul>

<h2 id="sql-injection">SQL Injection</h2>

<h3 id="updates-for-rails-6061">Updates for Rails 6.0/6.1</h3>

<p>Some new Rails 6.0 methods were previously added for SQL injection (<code class="language-plaintext highlighter-rouge">destroy_by</code>/<code class="language-plaintext highlighter-rouge">delete_by</code>), but this release is more thorough.</p>

<p>Newly vulnerable methods:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">reselect</code></li>
  <li><code class="language-plaintext highlighter-rouge">rewhere</code></li>
</ul>

<p>No longer vulnerable:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">delete_all</code></li>
  <li><code class="language-plaintext highlighter-rouge">destroy_all</code></li>
  <li><code class="language-plaintext highlighter-rouge">pluck</code> (in Rails 6.1)</li>
</ul>

<p>Not <em>really</em> vulnerable:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">order</code> (in Rails 6.1)</li>
  <li><code class="language-plaintext highlighter-rouge">reorder</code> (in Rails 6.1)</li>
</ul>

<p>(Also, [https://rails-sqli.org/] has also been updated with Rails 6 information!)</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1619">changes</a>)</p>

<h3 id="safe-methods">Safe Methods</h3>

<p><a href="https://github.com/escheiner">Esty Scheiner</a> added the <code class="language-plaintext highlighter-rouge">--sql-safe-methods</code> option to ignore some methods when checking for SQL injection.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1601">changes</a>)</p>

<h3 id="false-positives">False Positives</h3>

<p>Brakeman no longer warns about SQL injection for:</p>

<ul>
  <li>Dates and methods called on dates
(<a href="https://github.com/presidentbeef/brakeman/pull/1615">changes</a>)</li>
  <li>Method calls on number literals
(<a href="https://github.com/presidentbeef/brakeman/pull/1586">changes</a>)</li>
  <li><code class="language-plaintext highlighter-rouge">sanitize_sql_like</code>
(<a href="https://github.com/presidentbeef/brakeman/pull/1587">changes</a>)</li>
</ul>

<h2 id="misc-fixes">Misc Fixes</h2>

<p><a href="https://github.com/bradparker">Brad Parker</a> updated the dynamic render path check to ignore “renderables”.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/issues/1529">changes</a>)</p>

<p><a href="https://github.com/xulaus">Richard Fitzgerald</a> fixed a command injection false positive when using <code class="language-plaintext highlighter-rouge">Open3.capture</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1612">changes</a>)</p>

<p><a href="https://github.com/Skipants">Andrew Szczepanski</a> fixed an infinite loop when a mixin appears to include itself.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1611">changes</a>)</p>

<p>Brakeman will now warn about user-controlled evaluation even if the evaluation is a call target itself.</p>

<p>For example:</p>
<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">eval</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="ss">:debug</span><span class="p">]).</span><span class="nf">do_something_else</span>
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1592">changes</a>)</p>

<h2 id="refactoring">Refactoring</h2>

<p><a href="https://github.com/kbrock">Keenan Brock</a> cleaned up the <code class="language-plaintext highlighter-rouge">cookie?</code>/<code class="language-plaintext highlighter-rouge">param?</code> utility methods.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1608">changes</a>)</p>

<p>In support of <code class="language-plaintext highlighter-rouge">enum</code> and simple class methods, Brakeman now has a cleaner way of tracking and looking up method definitions.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1596">changes</a>)</p>

<h2 id="new-and-updated-options">New and Updated Options</h2>

<p><code class="language-plaintext highlighter-rouge">--sql-safe-methods</code> can be used to specify methods that should be ignored in the context of SQL injection.</p>

<p><code class="language-plaintext highlighter-rouge">--format github</code>/<code class="language-plaintext highlighter-rouge">-f github</code> will output code the annotation format used by GitHub Actions.</p>

<p><code class="language-plaintext highlighter-rouge">--no-threads</code>/<code class="language-plaintext highlighter-rouge">-n</code> will disable use of threads (actually forked processes) for reading and parsing files.
(Previously, this method only disabled use of threads when running checks.)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>2cc7a174bc9ebb90161f218ea35905de8d749210f69a0bfda9fba71429dc5047  brakeman-5.1.0.gem
b8182c9fd7d6d116b2b531c5d8fe0bf9c8da14118b755ed00be8de8c4684ad10  brakeman-lib-5.1.0.gem
e38ff386530bc5585e2efd183ba73c08abb740c3b26072662025a3d9395b707a  brakeman-min-5.1.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2021/06/08/brakeman-5-dot-0-dot-4-released">Brakeman 5.0.4 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2021-06-08 10:50:00 -0600" pubdate  updated >2021-06-08 10:50:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a tiny bugfix release!</p>

<p><em>What happened to 5.0.2 and 5.0.3??</em></p>

<p>They were messed up. Sorry. Don’t use them.</p>

<p><em>Changes since 5.0.1:</em></p>

<ul>
  <li>Fix Loofah version check (<a href="https://github.com/presidentbeef/brakeman/issues/1603">#1603</a>)</li>
</ul>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4d1af5c3e65a0c2319396a796bd9a587a13317faff92bd09b74c44ba70aef8b3  brakeman-5.0.4.gem
6b529ae8f1e16aed711759c3b52fc01c60befeb896042de02aaa5aabf5c24cb5  brakeman-lib-5.0.4.gem
5a402076af48fc526211212d70a751c80c27cae535077c1c7a63dadc314efe97  brakeman-min-5.0.4.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2021/04/27/brakeman-5-dot-0-dot-1-released">Brakeman 5.0.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2021-04-27 12:00:00 -0600" pubdate  updated >2021-04-27 12:00:00 -0600</time>


</p>
    
  </header>


  <div class="entry-content"><p>Has it really been three months since Brakeman 5.0? Yikes!</p>

<p>Here’s a small update with some bugfixes before we move on to 5.1.</p>

<p><em>Changes since 5.0.0:</em></p>

<ul>
  <li>Support loading <code class="language-plaintext highlighter-rouge">slim/smart</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1570">#1570</a>)</li>
  <li>Set more line numbers on Sexps (<a href="https://github.com/presidentbeef/brakeman/issues/1579">#1579</a>)</li>
  <li>Detect <code class="language-plaintext highlighter-rouge">::Rails.application.configure</code> too (<a href="https://github.com/presidentbeef/brakeman/issues/1584">#1584</a>)</li>
  <li>Always ignore <code class="language-plaintext highlighter-rouge">slice</code>/<code class="language-plaintext highlighter-rouge">only</code> calls for mass assignment</li>
  <li>Don’t fail if $HOME/$USER are not defined</li>
  <li>Convert splat array arguments to arguments</li>
  <li>Bundle unreleased RubyParser changes</li>
</ul>

<h3 id="support-smart-text-in-slim-templates">Support Smart Text in Slim Templates</h3>

<p>In order to support “<a href="https://github.com/slim-template/slim/blob/master/doc/smart.md">Smart Text</a>” in Slim templates,
Brakeman will load <code class="language-plaintext highlighter-rouge">slim/smart</code> if <code class="language-plaintext highlighter-rouge">slim/smart</code> is mentioned in the <code class="language-plaintext highlighter-rouge">Gemfile</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1582">changes</a>)</p>

<h3 id="more-line-numbers">More Line Numbers</h3>

<p>Setting <code class="language-plaintext highlighter-rouge">nil</code> value for the line number of a Sexp raises an exception.</p>

<p>This is usually from creating a Sexp without a line number in the first place.</p>

<p>More instances of this have been fixed in this release.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1581">changes</a>)</p>

<h3 id="always-ignore-sliceonly-for-mass-assignment">Always Ignore slice/only for Mass Assignment</h3>

<p>If <code class="language-plaintext highlighter-rouge">slice</code> or <code class="language-plaintext highlighter-rouge">only</code> are called for arguments to mass assignment (e.g. <code class="language-plaintext highlighter-rouge">User.new(some_hash.slice(:name, :email))</code>),
Brakeman will not warn about mass assignment.</p>

<p>These have been ignored for a while, but a logic error caused Brakeman to sometimes still warn about them.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1565">changes</a>)</p>

<h3 id="convert-splats-to-arguments">Convert Splats to Arguments</h3>

<p>In really obvious cases like</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">some_call</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">])</span>
</code></pre></div></div>

<p>Brakeman will convert the arguments to</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">some_call</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1564">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>4c1b7c7747ecfca11a822a4bab5ad05f13515e195d7d34590d3add215573b431  brakeman-5.0.1.gem
79129c2977936113fc87a9a2e9490b734f088286d0b33ed9ca61cb6587dc18c7  brakeman-lib-5.0.1.gem
549034d7aeb2a5ca8fe299c41b91938d502a89e70a1afa68643ca3c9e5ccaf96  brakeman-min-5.0.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2021/01/26/brakeman-5-dot-0-dot-0-released">Brakeman 5.0.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2021-01-26 12:00:00 -0700" pubdate  updated >2021-01-26 12:00:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>It has been a long time coming, but it is finally here! Lots of changes in this one…</p>

<p>Brakeman now scans (almost) all Ruby (and ERB, Haml, Slim) files in an application.
This may have a significant impact on reported warnings and scan times - see below for more information.</p>

<p><em>Changes since 4.10.1:</em></p>

<ul>
  <li>Scan (almost) all Ruby files in project</li>
  <li>Revamp CSV report to a CSV list of warnings</li>
  <li>Add Sonarqube report format (<a href="https://github.com/adamnengland">Adam England</a>)</li>
  <li>Add check for (more) unsafe method reflection (<a href="https://github.com/presidentbeef/brakeman/issues/1488">#1488</a>, <a href="https://github.com/presidentbeef/brakeman/issues/1507">#1507</a>, and <a href="https://github.com/presidentbeef/brakeman/issues/1508">#1508</a>)</li>
  <li>Add check for potential HTTP verb confusion (<a href="https://github.com/presidentbeef/brakeman/issues/1432">#1432</a>)</li>
  <li>Add <code class="language-plaintext highlighter-rouge">--[no-]skip-vendor</code> option</li>
  <li>Ignore <code class="language-plaintext highlighter-rouge">uuid</code> as a safe attribute</li>
  <li>Ignore <code class="language-plaintext highlighter-rouge">Tempfile#path</code> in shell commands</li>
  <li>Ignore development environment</li>
  <li>Collapse <code class="language-plaintext highlighter-rouge">__send__</code> calls</li>
  <li>Set Rails configuration defaults based on <code class="language-plaintext highlighter-rouge">load_defaults</code> version</li>
  <li>Update Ruby requirement to version 2.4.0</li>
  <li>Suggest using <code class="language-plaintext highlighter-rouge">--force</code> if no Rails application is detected</li>
</ul>

<h3 id="scan-almost-all-ruby-files">Scan Almost All Ruby Files</h3>

<p>Since the beginning, Brakeman has been picky about what directories it searches for files.
In general, Brakeman has looked in ‘normal’ Rails directores like <code class="language-plaintext highlighter-rouge">app/controllers/</code>, <code class="language-plaintext highlighter-rouge">app/models/</code>, <code class="language-plaintext highlighter-rouge">app/views/</code>, <code class="language-plaintext highlighter-rouge">lib/</code>, <code class="language-plaintext highlighter-rouge">config</code>, etc.
This is because Rails has some default logic based on file paths - like mapping a controller action to a given view.</p>

<p>But if an application varied from the norm, Brakeman would simply not scan those other directories.
This behavior led to a lot of confusion with folks wondering why Brakeman was not finding certain vulnerabilities.</p>

<p>Brakeman now attempts to deduce the contents of a file first, then falls back to the path name if necessary.
This has been surprisingly effective.</p>

<p>However, scanning more files means Brakeman runs slower and may report more false positives because the new files
are harder to reason about and less likely to be exposed as part of the attack surface.</p>

<p>Brakeman does ignore <code class="language-plaintext highlighter-rouge">test</code>, <code class="language-plaintext highlighter-rouge">spec</code>, and <code class="language-plaintext highlighter-rouge">vendor</code> directories. To scan the <code class="language-plaintext highlighter-rouge">vendor</code> directory as well, use <code class="language-plaintext highlighter-rouge">--no-skip-vendor</code>.</p>

<p>Please report any issues!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1520">changes</a>)</p>

<h3 id="csv-report-update">CSV Report Update</h3>

<p>The CSV report format has been completely changed! Previously, it was meant as an ‘Excel-lite’ format, only really useful for viewing in a spreadsheet program.</p>

<p>Now it is regular CSV with normalized columns to mostly match the JSON report (except for nested fields).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1547">changes</a>)</p>

<h3 id="sonarqube-report-format">Sonarqube Report Format</h3>

<p>Thanks to <a href="https://github.com/adamnengland">Adam England</a>, Brakeman now supports the Sonarqube “<a href="https://docs.sonarqube.org/latest/analysis/generic-issue/">Generic Issue Import Format</a>”.</p>

<p>(And thanks Adam for your patience.)</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1505">changes</a>)</p>

<h3 id="more-unsafe-method-reflection">More Unsafe Method Reflection</h3>

<p>A new check was added for unsafe use of <code class="language-plaintext highlighter-rouge">method</code>, <code class="language-plaintext highlighter-rouge">to_proc</code>, and <code class="language-plaintext highlighter-rouge">tap</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1527">changes</a>)</p>

<h3 id="http-verb-confusion-check">HTTP Verb Confusion Check</h3>

<p>In Rails, <code class="language-plaintext highlighter-rouge">HEAD</code> requests are routed like <code class="language-plaintext highlighter-rouge">GET</code> requests, but <code class="language-plaintext highlighter-rouge">request.get?</code> will be false.</p>

<p>Some code may assume if <code class="language-plaintext highlighter-rouge">request.get?</code> is false, then <code class="language-plaintext highlighter-rouge">request.post?</code> is true:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="n">request</span><span class="p">.</span><span class="nf">get?</span>
  <span class="c1"># Do something benign</span>
<span class="k">else</span>
  <span class="c1"># Do something sensitive because it's a POST</span>
  <span class="c1"># but actually it could be a HEAD :(</span>
<span class="k">end</span>
</code></pre></div></div>

<p>Brakeman will warn when an <code class="language-plaintext highlighter-rouge">if</code> expression checks <code class="language-plaintext highlighter-rouge">request.get?</code> but has an <code class="language-plaintext highlighter-rouge">else</code> clause instead of <code class="language-plaintext highlighter-rouge">elseif ...</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1524">changes</a>)</p>

<h3 id="uuids-as-safe-attributes">UUIDs as Safe Attributes</h3>

<p><code class="language-plaintext highlighter-rouge">#uuid</code> will be treated as a safe value, particular in SQL.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1553">changes</a>)</p>

<h3 id="tempfile-paths-in-shell-commands">Tempfile Paths in Shell Commands</h3>

<p><code class="language-plaintext highlighter-rouge">Tempfile#path</code> will be considered as safe value for command injection.</p>

<p>Also adds support for Tempfiles like:</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Tempfile</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="s1">'...'</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
  <span class="c1"># Brakeman knows `file` is a Tempfile</span>
<span class="k">end</span>
</code></pre></div></div>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1544">changes</a></p>

<h3 id="ignore-development-environment">Ignore Development Environment</h3>

<p>Brakeman will ignore code that is guarded like</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> <span class="no">Rails</span><span class="p">.</span><span class="nf">env</span><span class="p">.</span><span class="nf">development?</span>
  <span class="c1"># ...whatever code</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This was already true for <code class="language-plaintext highlighter-rouge">Rails.env.test?</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1549">changes</a>)</p>

<h3 id="collapse-__send__-calls">Collapse <code class="language-plaintext highlighter-rouge">__send__</code> Calls</h3>

<p>Brakeman will treat</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Blah</span><span class="p">.</span><span class="nf">__send__</span><span class="p">(</span><span class="ss">:something</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">)</span>
</code></pre></div></div>

<p>as</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Blah</span><span class="p">.</span><span class="nf">something</span><span class="p">(</span><span class="mf">5.0</span><span class="p">)</span>
</code></pre></div></div>

<p>This was already true for <code class="language-plaintext highlighter-rouge">send</code> and <code class="language-plaintext highlighter-rouge">try</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1551">changes</a>)</p>

<h3 id="set-rails-defaults">Set Rails Defaults</h3>

<p>Brakeman will set default values for Rails configuration options based on the version argument to <code class="language-plaintext highlighter-rouge">config.load_defaults</code> which is usually called in <code class="language-plaintext highlighter-rouge">application.rb</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1532">changes</a>)</p>

<h3 id="requires-ruby-240">Requires Ruby 2.4.0</h3>

<p>The minimal Ruby version for running Brakeman is now 2.4.0 (which is already EOL!)</p>

<p>Note Brakeman can analyze Ruby syntax from 1.8 to 2.6 (some 2.7+ syntax is not supported yet).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1515">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>21b91f67cde4cf487df0a4dbf6e54729064c665bb0b4b370b71bac9435b63e4c  brakeman-5.0.0.gem
3641c52448ca1d12423595ca1a874c1362f438cd58196825be648bb797096cb5  brakeman-lib-5.0.0.gem
50bab26fe8fcf8d962baaf5b08b7c178315b7c0e4be07d1b134e8ae00338c908  brakeman-min-5.0.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2020/12/24/brakeman-4-dot-10-dot-1-released">Brakeman 4.10.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2020-12-24 12:30:00 -0700" pubdate  updated >2020-12-24 12:30:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This releases fixes Ruby 3.0 compatibility (meaning running under 3.0, new syntax is not supported yet).</p>

<p><em>Changes since 4.10.0:</em></p>

<ul>
  <li>Declare REXML as a dependency (Ruby 3.0 compatibility)</li>
  <li>Use <code class="language-plaintext highlighter-rouge">Sexp#sexp_body</code> instead of <code class="language-plaintext highlighter-rouge">Sexp#[..]</code> (Ruby 3.0 compatibility)</li>
  <li>Prevent render loops when template names are absolute paths (<a href="https://github.com/presidentbeef/brakeman/issues/1536">#1536</a>)</li>
  <li>Ensure RubyParser is passed file path as a String (<a href="https://github.com/presidentbeef/brakeman/issues/1534">#1534</a>)</li>
  <li>Support new Haml 5.2.0 escaping method (<a href="https://github.com/presidentbeef/brakeman/issues/1517">#1517</a>)</li>
</ul>

<h3 id="rexml-as-an-explicit-dependency">REXML as an Explicit Dependency</h3>

<p>In Ruby 3.0, REXML has become a ‘bundled’ gem. It is distributed with Ruby, but if Bundler is involved then it needs to be declared as an explicit dependency.</p>

<p>If you like minimal dependencies, you can always use the <code class="language-plaintext highlighter-rouge">brakeman-min</code> gem which declares only strict dependencies.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1538">changes</a>)</p>

<h3 id="avoid-slicing-with-sexp">Avoid Slicing with Sexp#[]</h3>

<p><code class="language-plaintext highlighter-rouge">Sexp</code> subclasses from <code class="language-plaintext highlighter-rouge">Array</code>, and <code class="language-plaintext highlighter-rouge">Array</code> no longer returns subclasses from methods that create new arrays.</p>

<p>Brakeman was unfortunately using <code class="language-plaintext highlighter-rouge">Sexp#[]</code> with ranges (e.g. <code class="language-plaintext highlighter-rouge">s(:a, :b, :c)[1..-1]</code>), which runs into this behavior.
Happily, the <code class="language-plaintext highlighter-rouge">Sexp#sexp_body</code> method already exists to properly slice and return a <code class="language-plaintext highlighter-rouge">Sexp</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1538">changes</a>)</p>

<h3 id="recursive-renders-with-absolute-paths">Recursive Renders with Absolute Paths</h3>

<p>Brakeman has long been able to detect recursive render loops, but that detection did not work if the partial name was an ‘absolute’ path.</p>

<p>This is now fixed!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1537">changes</a>)</p>

<h3 id="ensure-rubyparser-path-is-a-string">Ensure RubyParser Path is a String</h3>

<p>In some cases, the parser was given a <code class="language-plaintext highlighter-rouge">Brakeman::FilePath</code> for the file name.
This only caused an issue in some weird corner cases, but it was wrong nonetheless.</p>

<p>Now <code class="language-plaintext highlighter-rouge">Brakeman::FileParser</code> will ensure the file name is passed as a string.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1535">changes</a>)</p>

<h3 id="support-haml-52">Support Haml 5.2</h3>

<p>Haml 5.2.0 introduced a new method for escaping output, which caused some false positives.</p>

<p><em>(Note this was avoided in Brakeman 4.10.0 by bundling an earlier version of Haml.)</em></p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1518">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>e40451080554884a63d73a2933c36518a3cf7a2bb471e6d864ce39a9d3455c98  brakeman-4.10.1.gem
ec69e04e087b74862629e952d7817dd7b73e30810166e01d69d24d7164101455  brakeman-lib-4.10.1.gem
3deee68eadd8eb6850254a8e753d6bbe933194c883f12a2455bdf5fd97b1eba2  brakeman-min-4.10.1.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2024/12/30/brakeman-7-dot-0-dot-0-released">Brakeman 7.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/10/18/brakeman-6-dot-2-dot-2-released">Brakeman 6.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/08/22/brakeman-6-dot-2-released">Brakeman 6.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/02/01/brakeman-6-dot-1-dot-2-released">Brakeman 6.1.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/12/04/brakeman-6-dot-1-dot-0-released">Brakeman 6.1.0 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
