
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/18/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2013/03/01/brakeman-1-dot-9-3-released">Brakeman 1.9.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2013-03-01 09:22:00 -0800" pubdate  updated >2013-03-01 09:22:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p><em>Changes since 1.9.2</em>:</p>

<ul>
  <li>Add warning fingerprints</li>
  <li>Add check for unsafe reflection (<a href="https://github.com/gquadros">Gabriel Quadros</a>)</li>
  <li>Add support for Slim templates (<a href="https://github.com/presidentbeef/brakeman/issues/214">#214</a>)</li>
  <li>Add check for skipping authentication methods with blacklist (<a href="https://github.com/presidentbeef/brakeman/issues/199">#199</a>)</li>
  <li>Add render path to JSON report</li>
  <li>Remove empty tables from reports (<a href="https://github.com/obduk">Owen Ben Davies</a>)</li>
  <li>Handle <code class="language-plaintext highlighter-rouge">prepend/append_before_filter</code></li>
  <li>Performance improvements when handling branches</li>
  <li>Fix processing of <code class="language-plaintext highlighter-rouge">production.rb</code> (<a href="https://github.com/presidentbeef/brakeman/issues/264">#264</a>)</li>
  <li>Fix version check for Ruby 2.0</li>
  <li>Expand HAML dependency to include 4.0 (<a href="https://github.com/presidentbeef/brakeman/issues/263">#263</a>)</li>
  <li>Scroll errors into view when expanding in HTML report</li>
</ul>

<h3 id="warning-fingerprints-and-new-identifiers">Warning Fingerprints and New Identifiers</h3>

<p><em>This is a breaking change: <code class="language-plaintext highlighter-rouge">brakeman --compare</code> will not work with reports generated from earlier versions.</em></p>

<p>Tracking of new and fixed warnings is often required when integrating Brakeman with other tools. Current approaches rely on fragile values such as the warning messages or formatting of the code output.</p>

<p>Additionally, warnings are grouped into large categories, such as “SQL Injection”. Sometimes more fine-grained categorization is required that does not rely on a value intended for display that may need to changed.</p>

<p>With these two issues in mind, warnings now have a “warning code” and a “fingerprint”. Warning codes are integers which will never change and provide more specific categorization of warnings. For example, each CVE has a separate code. This should make tracking and sorting warnings easier, but also allow for fixes to warning category names in the future.</p>

<p>The warning fingerprint is a SHA256 hash of five values:</p>

<ul>
  <li>Warning code</li>
  <li>S-expression of code that caused the warning</li>
  <li>Location (i.e., template name or class/method)</li>
  <li>Relative file path</li>
  <li>Confidence level</li>
</ul>

<p>Note that line numbers are <em>not</em> included. Identical warnings on different lines will have the same fingerprint. External tools can make the decision for how to handle this situation.</p>

<p>Warning fingerprints allow quick comparison of warnings (either by fingerprint, or fingerprint + line number) but are also less fragile than existing approaches. The fingerprint will not change if the warning category (meant for display) changes, if the formatting of the code changes, or if the line number changes (e.g., some blank lines are added at the top of a file).</p>

<p>If there are any issues with fingerprints, please report them before Brakeman 2.0!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/280">changes</a>)</p>

<h3 id="check-for-unsafe-constant-creation">Check for Unsafe Constant Creation</h3>

<p>Gabriel Quadros has contributed a check for methods that create constants (usually classes) from user input. <a href="http://blog.conviso.com.br/2013/02/exploiting-unsafe-reflection-in.html">His blog post</a> on the subject provides a good explanation of why this should be considered very dangerous.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/274">changes</a>)</p>

<h3 id="support-for-slim">Support for Slim</h3>

<p>Support for templates using <a href="http://slim-lang.com/">Slim</a> is now here! This should be considered experimental, as it has not yet been tested on a wide set of applications. Also, thanks <a href="https://github.com/tubaxenor">tubaxenor</a> for reporting a require issue with this change.</p>

<p>Please report any issues, especially false negatives!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/271">changes</a>)</p>

<h3 id="check-for-skipping-of-authentication-methods">Check for Skipping of Authentication Methods</h3>

<p>The check for <code class="language-plaintext highlighter-rouge">skip_before_filter</code>s using <code class="language-plaintext highlighter-rouge">except</code> instead of <code class="language-plaintext highlighter-rouge">only</code> has been expanded to include authentication filters from popular libraries.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/268">changes</a>)</p>

<h3 id="render-paths-in-json-reports">Render Paths in JSON Reports</h3>

<p>In HTML reports, templates which have a render path longer than one entry have been “expandable” to show the entire render path instead of just one level up. For example, a partial is usually rendered from a view, which is rendered from a controller action.</p>

<p>JSON reports now also include this information in the <code class="language-plaintext highlighter-rouge">render_path</code> value.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/279">changes</a>)</p>

<h3 id="no-empty-report-tables">No Empty Report Tables</h3>

<p>Owen Ben Davies contributed a patch to hide empty warning tables in the text and HTML reports. Looks much cleaner, thanks Owen!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/282">changes</a>)</p>

<h3 id="handle-preappended-filters">Handle (Pre|Ap)pended Filters</h3>

<p>Brakeman will now recognize before filters added with <code class="language-plaintext highlighter-rouge">prepend_before_filter</code> and <code class="language-plaintext highlighter-rouge">append_before_filter</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/266">changes</a>)</p>

<h3 id="branching-performance-improvements">Branching Performance Improvements</h3>

<p>It is entirely embarrassing, but Brakeman stopped working on Redmine some time ago due to how assignments in <code class="language-plaintext highlighter-rouge">if</code> expressions are handled.</p>

<p>In order to be somewhat flow sensitive, Brakeman combines variables assignments in <code class="language-plaintext highlighter-rouge">if</code> branches into <code class="language-plaintext highlighter-rouge">or</code> expressions. This captures the possible values a variable may have. However, Brakeman was doing that for <em>every</em> assignment in an <code class="language-plaintext highlighter-rouge">if</code> branch, even if there were multiple assignments to the same variable in the same branch (i.e., the value was not actually branching since the assignments were sequential). This release fixes that issue.</p>

<p>Additionally, simple arithmetic operations are now distributed across <code class="language-plaintext highlighter-rouge">or</code> expressions containing simple values (strings or numbers at this point), providing some memory savings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/270">changes</a>)</p>

<h3 id="fix-processing-of-production-environment-settings">Fix Processing of Production Environment Settings</h3>

<p>Processing of <code class="language-plaintext highlighter-rouge">production.rb</code> has been broken for some time, but poor test coverage meant it went unnoticed. But it is fixed now, so settings in <code class="language-plaintext highlighter-rouge">production.rb</code> should override those found in <code class="language-plaintext highlighter-rouge">environment.rb</code>. This only applies to Rails 3 applications.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/265">changes</a>)</p>

<h3 id="fix-version-check-for-ruby-20">Fix Version Check for Ruby 2.0</h3>

<p>Brakeman appears to work fine with Ruby 2.0, but the version check for Ruby 1.9 (which affected some behavior and checks) needed to be modified to include 2.0. Definitely report any issues with Ruby 2.0!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/277">changes</a>)</p>

<h3 id="allow-haml-40">Allow HAML 4.0</h3>

<p>There appear to be no changes in HAML 4.0 that affect Brakeman, so the gem dependency has been expanded to include the 4.x series.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/269">changes</a>)</p>

<h3 id="fix-error-showhide-in-html-report">Fix Error Show/Hide in HTML Report</h3>

<p>Now clicking on “Exceptions” to show or hide scan errors will keep the errors in view.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/267">changes</a>)</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<h3 id="roadmap">Roadmap</h3>

<p>The <a href="https://github.com/presidentbeef/brakeman/wiki/Roadmap">Brakeman roadmap</a> has one more release (1.9.4) planned before 2.0. The next release will likely only include bug and false positive fixes. Brakeman 2.0 will <em>definitely</em> include breaking changes, especially for JSON reports.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2013/02/13/brakeman-1-dot-9-2-released">Brakeman 1.9.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2013-02-13 15:48:00 -0800" pubdate  updated >2013-02-13 15:48:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release is almost entirely enhancements to old checks or new checks for recent vulnerabilities. New features in the next release, I promise.</p>

<p><em>Changes since 1.9.1</em>:</p>

<ul>
  <li>Add check for CVE-2013-0269</li>
  <li>Add check for CVE-2013-0276</li>
  <li>Add check for CVE-2013-0277</li>
  <li>Add check for CVE-2013-0333</li>
  <li>Check for more send-like methods (<a href="https://github.com/joernchen">joernchen</a>)</li>
  <li>Check for more SQL injection locations</li>
  <li>Check for more dangerous YAML methods (<a href="https://github.com/presidentbeef/brakeman/issues/246">#246</a>)</li>
  <li>Support MultiJSON 1.2 for Rails 3.0 and 3.1 (<a href="https://github.com/presidentbeef/brakeman/issues/247">#247</a>)</li>
</ul>

<h3 id="cve-2013-0269---vulnerabilities-in-json-gems">CVE-2013-0269 - Vulnerabilities in JSON gems</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/4_YvCpLzL58/discussion">CVE-2013-0269</a> is not strictly a Rails issue, but since it was announced on the Rails security list and was relatively easy to check, Brakeman will warn on it.</p>

<p>Versions of the json/json_pure gem on the 1.7.x branch will raise remote code execution warnings, while any other affected version will be reported as a denial of service vulnerability.</p>

<p>Applications which do not parse user input are not affected by these issues, but it is a good idea to upgrade anyway, as it should be relatively painless.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/262">changes</a>)</p>

<h3 id="cve-2013-0276---attr_protected-bypass">CVE-2013-0276 - attr_protected Bypass</h3>

<p>Brakeman has been warning on uses of <code class="language-plaintext highlighter-rouge">attr_protected</code> since version 1.4.0, but it was reported with weak confidence, since it is really a best-practice issue.</p>

<p>Now, however, uses of <code class="language-plaintext highlighter-rouge">attr_protected</code> will be reported as medium confidence unless used in a Rails version affected by <a href="https://groups.google.com/d/topic/rubyonrails-security/AFBKNY7VSH8/discussion">CVE-2013-0276</a>, in which case it will be high confidence.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/262">changes</a>)</p>

<h3 id="cve-2013-0277---serialized-attributes">CVE-2013-0277 - Serialized Attributes</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/KtmwSbEpzrU/discussion">CVE-2013-0277</a> allows attackers to insert malicious YAML into serialized model attributes. Using <code class="language-plaintext highlighter-rouge">attr_accessible</code> or <code class="language-plaintext highlighter-rouge">attr_protected</code> somewhat mitigates this, but it is still possible for an application to manually assign user input to a serialized attribute.</p>

<p>Brakeman will warn on affected models, with confidence level depending on whether or not the attribute can be mass assigned.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/262">changes</a>)</p>

<h3 id="cve-2013-0333---json-parsing-vulnerability">CVE-2013-0333 - JSON Parsing Vulnerability</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/1h2DR63ViGo/discussion">CVE-2013-0333</a> is another side effect of the recent YAML vulnerabilities. Rails’ default JSON request parser converted requests to YAML then parsed them as YAML.</p>

<p>Brakeman will warn on affected versions unless the provided workaround (setting the JSON backend to <code class="language-plaintext highlighter-rouge">JSONGem</code>) is present.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/254">changes</a>)</p>

<h3 id="check-for-more-send-like-methods">Check for More Send-like Methods</h3>

<p>Thanks to joernchen, Brakeman will now warn if user input is passed to <code class="language-plaintext highlighter-rouge">try</code>, <code class="language-plaintext highlighter-rouge">public_send</code>, or <code class="language-plaintext highlighter-rouge">__send__</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/256">changes</a>)</p>

<h3 id="check-for-more-sql-injection-sites">Check for More SQL Injection Sites</h3>

<p>While researching for <a href="http://rails-sqli.org/">rails-sqli.org</a>, a few more methods came up for Brakeman to check.</p>

<p>Brakeman will now warn on SQL injection in <code class="language-plaintext highlighter-rouge">update_all</code> and <code class="language-plaintext highlighter-rouge">pluck</code> methods.</p>

<h3 id="check-for-more-dangerous-yaml-methods">Check for More Dangerous YAML Methods</h3>

<p>Brakeman will now warn on dangerous uses of <code class="language-plaintext highlighter-rouge">load_documents</code>, <code class="language-plaintext highlighter-rouge">load_stream</code>, <code class="language-plaintext highlighter-rouge">parse_documents</code>, and <code class="language-plaintext highlighter-rouge">parse_stream</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/249">changes</a>)</p>

<h3 id="support-multijson-12">Support MultiJSON 1.2</h3>

<p>The MultiJSON gem changed some APIs around version 1.3. For convenience, Brakeman supported 1.3 or higher. However, for the same reason, Rails 3.0 and 3.1 are locked at versions before 1.3.</p>

<p>For those using Rails 3.0 or 3.1 and including Brakeman in the Gemfile, Brakeman now supports both the old and new interfaces for MultiJSON and the depedency has been pushed back to MultiJSON 1.2.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/248">changes</a>)</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

<p>Finally, please check out <a href="http://rails-sqli.org/">rails-sqli.org</a> and send in any feedback. Thanks!</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2013/01/18/brakeman-1-dot-9-1-released">Brakeman 1.9.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2013-01-18 17:36:00 -0800" pubdate  updated >2013-01-18 17:36:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This released was forced due to messed up dependencies with Brakeman 1.9.0 and Ruby2Ruby - my fault entirely! As such, this release does not match the roadmap for 1.9.1, which will be changed to 1.9.2.</p>

<p><em>Changes since 1.9.0</em>:</p>

<ul>
  <li>Add check for CVE-2012-5664 - SQL Injection</li>
  <li>Add check for CVE-2013-0155 - SQL Injection</li>
  <li>Add check for CVE-2013-0156 - Remote Code Execution</li>
  <li>Add check for unsafe <code class="language-plaintext highlighter-rouge">YAML.load</code></li>
  <li>Update to RubyParser 3.1.1 (neersighted)</li>
  <li>Remove ActiveSupport dependency (Neil Matatall)</li>
  <li>Do not warn on arrays passed to <code class="language-plaintext highlighter-rouge">link_to</code> (Neil Matatall) (<a href="https://github.com/presidentbeef/brakeman/issues/232">#232</a>)</li>
  <li>Warn on secret tokens (<a href="https://github.com/presidentbeef/brakeman/issues/200">#200</a>)</li>
  <li>Warn on more mass assignment methods (<a href="https://github.com/presidentbeef/brakeman/issues/223">#223</a>)</li>
</ul>

<h3 id="cve-2012-5664---sql-injection">CVE-2012-5664 - SQL Injection</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/DCNTNp_qjFM/discussion">CVE-2012-5664</a> is a vulnerability Rails’ dynamic finders. While dynamic finders (such as <code class="language-plaintext highlighter-rouge">User.find_by_name</code>) appear to take a single argument, they also accept a hash options which can be used to modify the SQL query. Normally the hash of options would be the second argument, but it can also be the first. If an application passes in user code as the first argument, it will be interpreted as the options hash, leading to SQL injection.</p>

<p>The provided fix is to only accept the hash if the dynamic finder is called with the proper number of arguments. A workaround is to always cast input to dynamic finders.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/228">changes</a>)</p>

<h3 id="cve-2013-0155---sql-injection">CVE-2013-0155 - SQL Injection</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/c7jT-EeN9eI/discussion">CVE-2013-0155</a> is a SQL vulnerability where certain JSON input can cause <code class="language-plaintext highlighter-rouge">find</code> methods to add <code class="language-plaintext highlighter-rouge">NULL</code> as a valid value.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/239">changes</a>)</p>

<h3 id="cve-2013-0156---remote-code-execution">CVE-2013-0156 - Remote Code Execution</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/61bkgvnSGTQ/discussion">CVE-2013-0156</a> is the worst Rails vulnerability in recent memory. It allows attackers to easily execute arbitrary code on any Rails application.</p>

<p>Besides upgrading Rails, there are workarounds for this issue: disable XML request parsing or disable YAML/symbol types inside XML requests.</p>

<p>Exploits for this vulnerability are easily available and already in use in the wild. Please upgrade, patch, or use a workaround.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/239">changes</a>)</p>

<h3 id="check-for-yamlload">Check for <code class="language-plaintext highlighter-rouge">YAML.load</code></h3>

<p>In light of <a href="https://groups.google.com/d/topic/rubyonrails-security/61bkgvnSGTQ/discussion">CVE-2013-0156</a>, Brakeman will now warn on any uses of <code class="language-plaintext highlighter-rouge">YAML.load</code> with user input. Do not load arbitrary YAML in applications!</p>

<h3 id="dependency-changes">Dependency Changes</h3>

<p>Brakeman now uses the latest RubyParser and Ruby2Ruby versions.</p>

<p>Thanks to Neil, Brakeman no longer depends on any version of ActiveSupport or i18n.</p>

<h3 id="namespaced-urls-in-link_to">Namespaced URLs in <code class="language-plaintext highlighter-rouge">link_to</code></h3>

<p>Brakeman will no longer warn on array arguments to <code class="language-plaintext highlighter-rouge">link_to</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/233">changes</a>)</p>

<h3 id="secret-tokens">Secret Tokens</h3>

<p>Secret tokens stored in source control are bad! Doubly bad if the source code is available publicly. Anyone with access to an application’s secret token can generate any session cookies they would like. See <a href="http://phenoelit.org/blog/archives/2012/12/21/let_me_github_that_for_you/index.html">this post</a> for details.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/227">changes</a>)</p>

<h3 id="more-mass-assignment">More Mass Assignment</h3>

<p>Bryan Helmkamp pointed out more Rails methods which perform mass assignment. The following methods have been added: <code class="language-plaintext highlighter-rouge">first_or_create</code>, <code class="language-plaintext highlighter-rouge">first_or_create!</code>, <code class="language-plaintext highlighter-rouge">first_or_initialize!</code>, <code class="language-plaintext highlighter-rouge">assign_attributes</code>, and <code class="language-plaintext highlighter-rouge">update</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/234">changes</a>)</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/12/25/brakeman-1-dot-9-0-released">Brakeman 1.9.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-12-25 11:00:00 -0800" pubdate  updated >2012-12-25 11:00:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>Happy <a href="https://en.wikipedia.org/wiki/Eggnog_Riot">Eggnog Riot</a> day!</p>

<p>This is a major release: 95 changed files with 1,775 additions and 14,484 deletions. This provides ample room for new bugs, so please report any issues.</p>

<p><em>Changes since 1.8.3</em>:</p>

<ul>
  <li>Update to RubyParser 3</li>
  <li>Ignore route information by default</li>
  <li>Add optional “interprocedural” analysis for controllers</li>
  <li>Properly pass instance variables between before_filters</li>
  <li>Support <code class="language-plaintext highlighter-rouge">strong_parameters</code> (<a href="https://github.com/presidentbeef/brakeman/issues/88">#88</a>)</li>
  <li>Support newer <code class="language-plaintext highlighter-rouge">validates :format</code> call (<a href="https://github.com/presidentbeef/brakeman/issues/198">#198</a>)</li>
  <li>Add scan time to reports (<a href="https://github.com/presidentbeef/brakeman/issues/158">#158</a>)</li>
  <li>Add Brakeman version to reports</li>
  <li>Don’t mangle whitespace in JSON code formatting</li>
  <li>Fix <code class="language-plaintext highlighter-rouge">CheckExecute</code> to warn on all string interpolation (<a href="https://github.com/presidentbeef/brakeman/issues/213">#213</a>)</li>
  <li>Fix false positive on <code class="language-plaintext highlighter-rouge">to_sql</code> calls</li>
  <li>Add AppTree as facade for filesystem (<a href="https://github.com/brynary">Bryan Helmkamp</a>)</li>
  <li>Add link for translate vulnerability warning (<a href="https://github.com/grosser">Michael Grosser</a>)</li>
  <li>Add Rakefile to run tests (<a href="https://github.com/grosser">Michael Grosser</a>)</li>
  <li>Better default config file locations (<a href="https://github.com/grosser">Michael Grosser</a>)</li>
  <li>Remove “find by regex” feature from <code class="language-plaintext highlighter-rouge">CallIndex</code></li>
  <li>Reduce Sexp creation</li>
  <li>Handle empty model files</li>
</ul>

<h3 id="update-to-rubyparser-3">Update to RubyParser 3</h3>

<p>With the update to use RubyParser 3.x, Brakeman no longer includes a vendored version of RubyParser (which was only used with running with Ruby 1.9), which reduced code size by about 14,000 lines.</p>

<p>RubyParser 3 supports Ruby 1.9 much more fully, so there should be very few parse errors. Additionally, Brakeman no longer chooses parsers based on the current Ruby version.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/190">changes</a>)</p>

<h3 id="route-information-ignored-by-default">Route Information Ignored by Default</h3>

<p>Route information is only used in Brakeman to determine whether a controller method should perform an implicit render. Since determining Rails routes statically is quite difficult to get right, it is better to assume a method is a routable action. Previous versions provided the <code class="language-plaintext highlighter-rouge">-a</code> option for this, which is now on by default. To turn off this behavior (and revert to the old), use <code class="language-plaintext highlighter-rouge">--no-assume-routes</code>.</p>

<p>This does not affect default route warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/219">changes</a>)</p>

<h3 id="optional-interprocedural-analysis-for-controllers">Optional Interprocedural Analysis for Controllers</h3>

<p>Currently, Brakeman essentially looks at each method in isolation. Values are propagated from controller actions (including before_filters) through rendered views and templates. But if a controller action calls another method which has an effect on the eventual output of the action, Brakeman does not processed the invoked method.</p>

<p>This release includes optional, experimental support for analyzing controller methods called from within controller actions.</p>

<p>For a simple example, instance variables set in helper methods will now be added to a rendered view. Also, values returned from called methods will be tracked:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>def create
  get_user 
  #@user is now User.find(params[:id])

  @account = find_account(@user)  
  #@account is now Account.where(:user =&gt; User.find(params[:id]).id
end

private

def get_user
  @user = User.find(params[:id])
end

def find_account
  Account.where(:user =&gt; @user.id)
end
</code></pre></div></div>

<p>This is limited to methods available in the controller (via a parent class or mixins). It is also limited to a “depth of one”, meaning it will not try to analyze methods called by helper methods (<code class="language-plaintext highlighter-rouge">get_user</code> and <code class="language-plaintext highlighter-rouge">find_account</code> above).</p>

<p>Since this feature is still experimental and will definitely increase scan times, it is turned off by default. Use <code class="language-plaintext highlighter-rouge">--interprocedural</code> to enable it. (Better name pending suggestions…)</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/218">changes</a>)</p>

<h3 id="pass-instance-variables-between-filters">Pass Instance Variables between Filters</h3>

<p>While instance variables set in <code class="language-plaintext highlighter-rouge">before_filters</code> were set properly, <code class="language-plaintext highlighter-rouge">before_filter</code> which used instance variables from an earlier filter could not see those variables. This has been fixed, which will likely lead to new or more accurate warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/224">changes</a>)</p>

<h3 id="support-for-strong_parameters">Support for <code class="language-plaintext highlighter-rouge">strong_parameters</code></h3>

<p>In Rails 4, the responsibility for mass assignment protection will move from models to controllers where mass assignment is actually used. A preview of the new functionality is available in the <a href="https://github.com/rails/strong_parameters">strong_parameters</a> gem. Brakeman should no longer warn on mass assignment for models protected with <code class="language-plaintext highlighter-rouge">strong_parameters</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/204">changes</a>)</p>

<h3 id="support-validates-format">Support <code class="language-plaintext highlighter-rouge">validates :format</code></h3>

<p>In Rails 3, format validation changed from <code class="language-plaintext highlighter-rouge">validates_format_of</code> to the more generic <code class="language-plaintext highlighter-rouge">validates</code> method. Brakeman will now check <code class="language-plaintext highlighter-rouge">validates</code> calls for proper anchors on regular expressions for <code class="language-plaintext highlighter-rouge">:format</code>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/205">changes</a>)</p>

<h3 id="report-changes">Report Changes</h3>

<p>Reports will now contain Brakeman version and scan duration. JSON reports contain <code class="language-plaintext highlighter-rouge">start_time</code> and <code class="language-plaintext highlighter-rouge">end_time</code> timestamps. For now, JSON reports will still have a <code class="language-plaintext highlighter-rouge">timestamp</code> key, but it will be identical to <code class="language-plaintext highlighter-rouge">end_time</code>. It will be removed in Brakeman 2.0.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/193">changes</a>)</p>

<p>Additionally, code formatting in JSON reports has changed slightly. Previously, code was formatted with the HTML output in mind, so line breaks were removed. Now JSON reports include the code formatted from Ruby2Ruby without any mangling.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/191">changes</a>)</p>

<h3 id="fix-command-injection-check">Fix Command Injection Check</h3>

<p>The command injection check will now (again) warn on any form on string interpolation used for process execution, whether or not user input is involved.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/216">changes</a>)</p>

<h3 id="fix-to_sql-false-positives">Fix <code class="language-plaintext highlighter-rouge">to_sql</code> False Positives</h3>

<p>SQL code generated from Arel’s <code class="language-plaintext highlighter-rouge">to_sql</code> method will be considered safe.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/194">changes</a>)</p>

<h3 id="file-system-facade">File System Facade</h3>

<p>Bryan Helmkamp cleaned up Brakeman’s file access into a single object. This should simplify future changes and add some consistency to how Brakeman handles files.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/197">changes</a>)</p>

<h3 id="run-tests-via-rake">Run Tests via Rake</h3>

<p>Thanks to Michael Grosser, running <code class="language-plaintext highlighter-rouge">rake</code> will now run Brakeman’s tests.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/183">changes</a>)</p>

<h3 id="improved-config-file-locations">Improved Config File Locations</h3>

<p>Also thanks to Michael Grosser, Brakeman will check more sane locations for Brakeman configuration files. This version adds <code class="language-plaintext highlighter-rouge">./config/brakeman.yml</code>, <code class="language-plaintext highlighter-rouge">~/.brakeman/config.yml</code>, and <code class="language-plaintext highlighter-rouge">/etc/brakeman/config.yml</code> as default locations for configuration files. The old locations are deprecated now, and will be removed in Brakeman 2.0.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/182">changes</a></p>

<h3 id="more-internal-changes">More Internal Changes</h3>

<p>Call indexing performance has been given another <a href="http://blog.presidentbeef.com/">slight boost</a> with the removal of the ability to search for call targets via regular expressions (which was not being used anywhere).</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/189">changes</a>)</p>

<p>The number of s-expressions generated by Brakeman has been reduced, although this did not lead to any major performance improvement.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/207">changes</a>)</p>

<p>Data-flow/alias processing was performing two passes. This has been reduced to just one.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/224">changes</a>)</p>

<p>Empty model files will no longer cause errors.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/11/13/brakeman-1-dot-8-3-released">Brakeman 1.8.3 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-11-13 09:20:00 -0800" pubdate  updated >2012-11-13 09:20:00 -0800</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is primarily a false positive reduction release. One major change is the change in dependency from the <code class="language-plaintext highlighter-rouge">json_pure</code> gem to <code class="language-plaintext highlighter-rouge">multi_json</code>.</p>

<p><em>Changes since 1.8.2</em>:</p>

<ul>
  <li>Use <code class="language-plaintext highlighter-rouge">multi_json</code> gem for better harmony (<a href="https://github.com/presidentbeef/brakeman/issues/164">#164</a>)</li>
  <li>Performance improvement for call indexing</li>
  <li>Fix issue with processing HAML files (<a href="https://github.com/presidentbeef/brakeman/issues/168">#168</a>)</li>
  <li>Handle pre-release versions when processing <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> (<a href="https://github.com/presidentbeef/brakeman/issues/174">#174</a>)</li>
  <li>Only check first argument of <code class="language-plaintext highlighter-rouge">redirect_to</code> (<a href="https://github.com/presidentbeef/brakeman/issues/98">#98</a>)</li>
  <li>Fix false positives from <code class="language-plaintext highlighter-rouge">Model.arel_table</code> accesses</li>
  <li>Fix false positives on redirects to models decorated with Draper gem (<a href="https://github.com/presidentbeef/brakeman/issues/172">#172</a>)</li>
  <li>Fix false positive on redirect to model association (<a href="https://github.com/presidentbeef/brakeman/issues/111">#111</a>)</li>
  <li>Fix false positive on <code class="language-plaintext highlighter-rouge">YAML.load</code> (<a href="https://github.com/presidentbeef/brakeman/issues/142">#142</a>)</li>
  <li>Fix false positive XSS on any <code class="language-plaintext highlighter-rouge">to_i</code> output</li>
  <li>Fix error on Rails 2 named routes with no args</li>
  <li>Fix error in rescan of mixins with symbols in method name</li>
  <li>Do not rescan non-Ruby files in config/</li>
</ul>

<h3 id="change-to-multijson">Change to MultiJSON</h3>

<p>Brakeman now depends on the <a href="http://rdoc.info/github/intridea/multi_json">multijson</a> gem instead of <code class="language-plaintext highlighter-rouge">json_pure</code>. This should make it easier for people who include Brakeman as a dependency.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/166">changes</a>)</p>

<h3 id="faster-call-indexing">Faster Call Indexing</h3>

<p>Dumb code in the <code class="language-plaintext highlighter-rouge">CallIndex</code> was causing call indexing to be slow on some large applications. This should now be faster and require less memory!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/180">changes</a>)</p>

<h3 id="fix-haml-processing">Fix HAML Processing</h3>

<p>Some HAML files were causing Brakeman’s alias processing to slow to a crawl. This was due to the template code (sometimes) directly appending to the output variable via <code class="language-plaintext highlighter-rouge">&lt;&lt;</code>. Since Brakeman attempts to treat targets of <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> as arrays, Brakeman was generating large data structures each time <code class="language-plaintext highlighter-rouge">&lt;&lt;</code> was encountered.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/170">changes</a>]</p>

<h3 id="handle-pre-release-versions">Handle Pre-release Versions</h3>

<p>When a <code class="language-plaintext highlighter-rouge">Gemfile.lock</code> file is present in a Rails application, Brakeman uses it to determine the version of Rails in use. Previous versions did not accept pre-release version numbers (like <code class="language-plaintext highlighter-rouge">3.1.2.rc1</code>), leading to version inappropriate warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/176">changes</a>)</p>

<h3 id="redirect-false-positives">Redirect False Positives</h3>

<p>Several false positives related to redirects have been fixed, and the scope of the redirect check is somewhat reduced.</p>

<p>Calls beginning with <code class="language-plaintext highlighter-rouge">Model.arel_table</code> should no longer be treated as user input (in any context).</p>

<p>Model instances returned by the <code class="language-plaintext highlighter-rouge">decorate</code> method in the <a href="https://github.com/drapergem/draper">Draper</a> gem are considered safe.</p>

<p>Redirects to model associations (e.g, <code class="language-plaintext highlighter-rouge">belongs_to :account</code>) are considered safe.</p>

<p>Redirects to method calls with safe values should no longer warn. For example:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>redirect_to blah(User.first) #No warning
</code></pre></div></div>

<p>Additionally, only the first argument of <code class="language-plaintext highlighter-rouge">redirect_to</code> will be checked for user input.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/177">changes</a>)</p>

<h3 id="yaml-false-positive">YAML False Positive</h3>

<p>File access warnings for YAML calls have been reduced to only those calls which actually access files.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/178">changes</a>)</p>

<h3 id="integer-output-false-positives">Integer Output False Positives</h3>

<p>Calls to <code class="language-plaintext highlighter-rouge">to_i</code> should not trigger XSS warnings.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/179">changes</a>)</p>

<h3 id="errors-on-named-routes">Errors on Named Routes</h3>

<p>Rails 2 named routes with no arguments were causing errors, which have now been fixed.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/181">changes</a>)</p>

<h3 id="future-work">Future Work</h3>

<p>Now that RubyParser 3.x is officially released, work is underway to use the new version. This will increase Ruby 1.9 syntax compatibility and remove the need to parse applications with the same Ruby version as the application uses. Additionally, it will allow us to get rid of the vendored version of RubyParser that Brakeman uses for Ruby 1.9. Unfortunately, RubyParser 3.x introduces a lot of incompatibilities and upgrading requires a significant amount of effort.</p>

<p>Another exciting feature in development is limited interprocedural analysis. Brakeman will be able to handle simple things like calls to helper methods in controllers which set instance variables or return user input. This should help with the “obvious” vulnerabilities that Brakeman often misses.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release! Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>

</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2023/07/20/brakeman-6-dot-0-dot-1-released">Brakeman 6.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/05/24/brakeman-6-dot-0-released">Brakeman 6.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2023/02/21/brakeman-5-dot-4-dot-1-released">Brakeman 5.4.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/11/17/brakeman-5-dot-4-dot-0-released">Brakeman 5.4.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/08/09/brakeman-5-dot-3-dot-0-released">Brakeman 5.3.0 Released</a>
      </li>
    
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
