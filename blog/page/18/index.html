
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/page/18/"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman Security Scanner" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">



  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/09/24/brakeman-1-dot-8-1-released">Brakeman 1.8.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-09-24 12:09:00 -0700" pubdate  updated >2012-09-24 12:09:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>Bug fixes!</p>

<p><em>Changes since 1.8.0</em>:</p>

<ul>
  <li>Recover from errors in output formatting (<a href="https://github.com/presidentbeef/brakeman/pull/148">#148</a>)</li>
  <li>Fix false positive in <code class="highlighter-rouge">redirect_to</code> (Neil Matatall) (<a href="https://github.com/presidentbeef/brakeman/issues/143">#143</a>)</li>
  <li>Fix problems with removal of <code class="highlighter-rouge">Sexp#method_missing</code> (<a href="https://github.com/presidentbeef/brakeman/pull/150">#150</a>)</li>
  <li>Fix array indexing in alias processing (<a href="https://github.com/presidentbeef/brakeman/pull/145">#145</a>)</li>
  <li>Fix old <code class="highlighter-rouge">mail_to</code> vulnerability check (<a href="https://github.com/presidentbeef/brakeman/pull/147">#147</a>)</li>
  <li>Fix rescans when only controller action changes (<a href="https://github.com/presidentbeef/brakeman/pull/141">#141</a>)</li>
  <li>Allow comparison of versions with unequal lengths (<a href="https://github.com/presidentbeef/brakeman/pull/144">#144</a>)</li>
  <li>Handle super calls with blocks (<a href="https://github.com/presidentbeef/brakeman/pull/146">#146</a>)</li>
  <li>Remove malformed Sexps from HAML processing  (<a href="https://github.com/presidentbeef/brakeman/pull/149">#149</a>)</li>
  <li>Respect <code class="highlighter-rouge">-q</code> flag for “Rails 3 detected” message</li>
</ul>

<h3 id="fix-crashes-when-generating-report">Fix Crashes when Generating Report</h3>

<p>Some scans were causing Brakeman to crash while generating reports with an error like:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lib/brakeman/warning.rb:78:in `format_code': undefined method `gsub' for nil:NilClass (NoMethodError)
</code></pre></div></div>

<p>This was due to a combination of the removal of <code class="highlighter-rouge">method_missing</code> behavior from <code class="highlighter-rouge">Sexp</code> and the <code class="highlighter-rouge">OutputProcessor</code> not handling errors well.</p>

<p>The problem should be fixed now, but please report an issue if “[Format Error]” shows up in reports.</p>

<h3 id="false-positive-in-redirect-check">False Positive in Redirect Check</h3>

<p>Neil Matatall fixed <a href="https://github.com/presidentbeef/brakeman/issues/143">an issue</a> with a false positive when redirecting to an array.</p>

<p>When <code class="highlighter-rouge">redirect_to</code> is given an array, Rails eventually falls through to <code class="highlighter-rouge">polymorphic_path</code>, which will only return a path, not a full URL. Brakeman only checks for redirects that can redirect to a different host, so this is considered safe.</p>

<h3 id="sexp-and-method_missing">Sexp and <code class="highlighter-rouge">method_missing</code></h3>

<p>The original <code class="highlighter-rouge">Sexp</code> code from RubyParser uses <code class="highlighter-rouge">method_missing</code> to find and optionally delete nodes. This functionality is not used very often (never in Brakeman) but has covered up bugs that would otherwise been found. Therefore, <code class="highlighter-rouge">Sexp#method_missing</code> has been removed in Brakeman. However, it turns out that <a href="https://github.com/seattlerb/ruby2ruby">Ruby2Ruby</a> uses it in a couple places. Brakeman uses Ruby2Ruby to covert s-expressions back to readable Ruby code, particularly when generating reports. This lead to some crashes.</p>

<h3 id="fix-array-indexing">Fix Array Indexing</h3>

<p>Brakeman can handle pulling values out of simple arrays. Or it should be able to, but it keeps breaking. Should be fixed now!</p>

<h3 id="fix-mail_to-check">Fix <code class="highlighter-rouge">mail_to</code> Check</h3>

<p>There is a Brakeman check for an <a href="https://groups.google.com/d/topic/rubyonrails-security/8CpI7egxX4E/discussion">old vulnerability</a> in <code class="highlighter-rouge">mail_to</code>. However, it turns out this check has been broken for a while. But now it is fixed! And there are regression tests.</p>

<h3 id="fix-rescans-on-controller-changes">Fix Rescans on Controller Changes</h3>

<p>There were some crashes when rescanning was triggered by a controller change.</p>

<h3 id="haml-processing">HAML Processing</h3>

<p>Some very old code for HAML processing was generating malformed s-expressions, which then had to be handled specially in the output formatter. It turns out these nodes were not even used, so they were removed. Please report any problems arising from this! We do not have a lot of HAML test cases.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/09/04/brakeman-1-dot-8-0-released">Brakeman 1.8.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-09-04 11:26:00 -0700" pubdate  updated >2012-09-04 11:26:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p><em>Changes since 1.7.1</em>:</p>

<ul>
  <li>Support relative paths in reports (fsword)</li>
  <li>Allow Brakeman to be run without tty (fsword)</li>
  <li>Fix exit code with <code class="highlighter-rouge">--compare</code> (fsword)</li>
  <li>Fix <code class="highlighter-rouge">--rake</code> option (Deepak Kumar)</li>
  <li>Add high confidence warnings for <code class="highlighter-rouge">to_json</code> XSS (Neil Matatall)</li>
  <li>Fix <code class="highlighter-rouge">redirect_to</code> false negative</li>
  <li>Fix duplicate warnings with <code class="highlighter-rouge">raw</code> calls</li>
  <li>Fix shadowing of rendered partials</li>
  <li>Add “render chain” to HTML reports</li>
  <li>Add check for XSS in <code class="highlighter-rouge">content_tag</code></li>
  <li>Add full backtrace for errors in debug mode</li>
  <li>Treat model attributes in <code class="highlighter-rouge">or</code> expressions as immediate values</li>
  <li>Switch to method access for Sexp nodes</li>
</ul>

<h3 id="relative-paths-in-reports">Relative Paths in Reports</h3>

<p>The <code class="highlighter-rouge">--relative-paths</code> option will now cause Brakeman to output relative paths for warnings in reports in either JSON or tabs format. This is useful when comparing reports run on different machines or just in different directories.</p>

<h3 id="brakeman-without-tty">Brakeman without TTY</h3>

<p>Thanks to <a href="http://fsword.github.com/">fsword</a>, Brakeman can now run without a TTY available.</p>

<h3 id="exit-code-for-compare">Exit Code for Compare</h3>

<p>Also thanks to fsword, Brakeman will return a proper exit code when run with <code class="highlighter-rouge">-z --compare</code>. If any changes are found, the exit code will be nonzero.</p>

<h3 id="rake-task-generation-fixed">Rake Task Generation Fixed</h3>

<p>The <code class="highlighter-rouge">--rake</code> option was broken, but <a href="https://github.com/deepakinseattle">Deepak Kumar</a> noticed and fixed it!</p>

<h3 id="high-confidence-warnings-for-json">High Confidence Warnings for JSON</h3>

<p>Older versions of Rails default to not escaping <code class="highlighter-rouge">to_json</code> calls, leading to <a href="http://brakemanscanner.org/docs/warning_types/cross_site_scripting_to_json/">cross site scripting problems</a>. Since Rails 2.1.0, Rails has provided an option to escape JSON output by default. Brakeman will check this option, and warn on unescaped <code class="highlighter-rouge">to_json</code> calls.</p>

<h3 id="fix-redirect-false-negative">Fix Redirect False Negative</h3>

<p>Brakeman was incorrectly checking for <code class="highlighter-rouge">:only_path =&gt; true</code> in <em>any</em> argument to <code class="highlighter-rouge">redirect_to</code>. However, it is only valid as part of the first argument.</p>

<h3 id="fix-duplicate-warnings-on-raw-calls">Fix Duplicate Warnings on Raw Calls</h3>

<p>A logic mistake sometimes caused a high and weak confidence warning to be reported for the same code using <code class="highlighter-rouge">raw</code>. This has been fixed.</p>

<h3 id="fix-shadowing-of-rendered-partials">Fix Shadowing of Rendered Partials</h3>

<p>Due to the way Brakeman was storing rendered partials, a view that was rendered multiple times via different code paths would only store a single instance of the rendered view. This could result in some vulnerabilities not being reported.</p>

<p>To fix this, Brakeman now stores the entire “render chain” (that is, each location of a <code class="highlighter-rouge">render</code>). This ensures a unique key for each rendered template.</p>

<h3 id="report-render-chain-in-html">Report Render Chain in HTML</h3>

<p>HTML reports now have a new feature that reports the “render chain” for view warnings (if the chain is more than a single call deep).</p>

<p>A warning like this:</p>

<p><img src="/images/unexpanded_call_chain.png" alt="Unexpanded" /></p>

<p>Might expand to show this chain:</p>

<p><img src="/images/expanded_call_chain.png" alt="Expanded" /></p>

<h3 id="check-for-xss-in-content_tag">Check for XSS in <code class="highlighter-rouge">content_tag</code></h3>

<p><code class="highlighter-rouge">content_tag</code> is a view helper for generating HTML tags containing some content. In Rails 2.x, <code class="highlighter-rouge">content_tag</code> did not escape this content. In Rails 3.x, this changed so that now it is escaped. While <code class="highlighter-rouge">content_tag</code> does have an <code class="highlighter-rouge">escape</code> parameter (true by default), this only applies to the tag attribute <em>values</em>.</p>

<p>Brakeman now warns on possible cross site scripting via <code class="highlighter-rouge">content_tag</code> calls. <a href="/docs/warning_types/content_tag">See here</a> for more details.</p>

<h3 id="backtraces-in-debug-mode">Backtraces in Debug Mode</h3>

<p>By default, Brakeman tries its best to recover from errors and produce a report. However, this can sometimes make it difficult to track down the sources of errors. Now, with the <code class="highlighter-rouge">-d</code> option, Brakeman will report backtraces for errors encountered while running, as well as including backtraces in HTML reports.</p>

<h3 id="convenience-methods-for-sexp-access">Convenience Methods for Sexp Access</h3>

<p>Previously, all code dealing with <a href="https://en.wikipedia.org/wiki/S-exp">s-expressions</a> in the <code class="highlighter-rouge">Sexp</code> class accessed nodes via array access, e.g. <code class="highlighter-rouge">exp[1]</code> or <code class="highlighter-rouge">exp[2]</code>. This led to hard-to-read code like <code class="highlighter-rouge">exp[2][3][1][1..-1]</code>. This release includes convenience methods to replace those types of calls. Available methods are <a href="http://rdoc.info/gems/brakeman/Sexp">documented here</a>.</p>

<p>Hopefully this leads to code that is both easier to read and easier to write.</p>

<h3 id="reporting-problems">Reporting Problems</h3>

<p>This release touches a lot of code (76 changed files with 1,515 additions and 598 deletions), so there is ample opportunity for bugs to sneak in. Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a>!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> and following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/08/13/brakeman-1-dot-7-1-released">Brakeman 1.7.1 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-08-13 11:04:00 -0700" pubdate  updated >2012-08-13 11:04:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This is a small release to add checks for the <a href="http://weblog.rubyonrails.org/2012/8/9/ann-rails-3-2-8-has-been-released/">Rails vulnerabilities reported last week</a>.</p>

<p><em>Changes since 1.7.0</em>:</p>

<ul>
  <li>Add check for <a href="https://groups.google.com/d/topic/rubyonrails-security/fV3QUToSMSw/discussion">CVE-2012-3463</a></li>
  <li>Add check for <a href="https://groups.google.com/d/topic/rubyonrails-security/kKGNeMrnmiY/discussion">CVE-2012-3464</a></li>
  <li>Add check for <a href="https://groups.google.com/d/topic/rubyonrails-security/FgVEtBajcTY/discussion">CVE-2012-3465</a></li>
  <li>Add charset to HTML report (<a href="https://github.com/hooopo">hooopo</a>)</li>
  <li>Report XSS in select() for Rails 2</li>
</ul>

<h3 id="cve-2012-3463---xss-in-select_tag-prompt">CVE-2012-3463 - XSS in select_tag Prompt</h3>

<p>In Rails 3.x, values supplied to the <code class="highlighter-rouge">:prompt</code> option in the <code class="highlighter-rouge">select_tag</code> helper are not escaped, leading to a cross-site scripting vulnerability.</p>

<p>Brakeman will warn on all uses of <code class="highlighter-rouge">select_tag</code> with unescaped user input in the <code class="highlighter-rouge">:prompt</code> option.</p>

<h3 id="cve-2012-3464---single-quotes-are-unescaped">CVE-2012-3464 - Single Quotes are Unescaped</h3>

<p>This is pretty much a known issue (<a href="http://www.ruby-forum.com/topic/166894">example from 2008</a>), but Rails 3.2.8 fixes it.</p>

<p>Single quotes are most dangerous when interpolating values into HTML attributes that use single quotes, which is why it is often recommended to always use double quotes in HTML.</p>

<p>There is a <a href="https://groups.google.com/d/topic/rubyonrails-security/kKGNeMrnmiY/discussion">provided workaround</a> for earlier versions of Rails which replaces <code class="highlighter-rouge">ERB::Util.html_escape</code> with <code class="highlighter-rouge">Rack::Utils.escape_html</code>. This method adds escaping for both single quotes (<code class="highlighter-rouge">'</code>) and forward slashes (<code class="highlighter-rouge">/</code>).</p>

<p>If the provided workaround is used in an initializer, as suggested, then Brakeman will not generate a warning for this vulnerability. Otherwise, Brakeman will generate a warning for affected versions.</p>

<h3 id="cve-2012-3465---xss-in-strip_tags">CVE-2012-3465 - XSS in strip_tags</h3>

<p>Another vulnerability has been reported for <code class="highlighter-rouge">strip_tags</code> (earlier report was <a href="https://groups.google.com/d/topic/rubyonrails-security/K5EwdJt06hI/discussion">CVE-2011-2931</a>).</p>

<p>Brakeman will warn on affected versions if uses of <code class="highlighter-rouge">strip_tags</code> are detected.</p>

<h3 id="xss-in-select-helper">XSS in select Helper</h3>

<p>This vulnerability was <a href="https://groups.google.com/d/topic/rubyonrails-security/CdoMUVpsRmQ/discussion">reported a while ago</a>, but it was unclear if it applied to Rails 2.x or just Rails 3. Thanks to Neil Matatall, it has been confirmed to be an issue in Rails 2.x as well.</p>

<p>Therefore, Brakeman will be reporting the vulnerability (<code class="highlighter-rouge">select</code> does not escape options list if supplied as a straight string) for Rails 2.x as well.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/07/31/brakeman-1-dot-7-0-released">Brakeman 1.7.0 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-07-31 17:44:00 -0700" pubdate  updated >2012-07-31 17:44:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>This release includes improvements to Rails 3 route processing, better performance, several bug fixes, and more!</p>

<p><em>Changes since 1.6.2</em>:</p>

<ul>
  <li>Add check for CVE-2012-3424</li>
  <li>Link report types to descriptions on website</li>
  <li>Report errors raised while running check</li>
  <li>Improve processing of Rails 3 routes</li>
  <li>Improve file access check</li>
  <li>Avoid warning on non-ActiveModel models</li>
  <li>Fix how <code class="highlighter-rouge">params[:x] ||=</code> is handled</li>
  <li>Treat user input in <code class="highlighter-rouge">or</code> expressions as immediate values</li>
  <li>Fix processing of negative array indexes</li>
  <li>Fix “empty char-class” error</li>
  <li>Speed improvements by stripping down SexpProcessor</li>
  <li>Add line breaks to truncated table rows</li>
</ul>

<h3 id="check-for-http-auth-digest-dos">Check for HTTP Auth Digest DoS</h3>

<p><a href="https://groups.google.com/d/topic/rubyonrails-security/vxJjrc15qYM/discussion">CVE-2012-3424</a>, a potential denial of service vulnerability in how Rails handles HTTP authentication digest parameters, was recently announced. It affects Rails 3.x, and is fixed in 3.0.16, 3.1.7, and 3.2.7.</p>

<p>Brakeman will generate a warning for the Rails versions affected, but will only report a high confidence warning if <code class="highlighter-rouge">authenticate_or_request_with_http_digest</code> or <code class="highlighter-rouge">authenticate_with_http_digest</code> methods are called.</p>

<h3 id="links-to-warning-information">Links to Warning Information</h3>

<p>HTML reports now link warning types to descriptions on the Brakeman website. JSON reports will also include the link information. Due to this change, it is not possible to compare JSON reports from previous versions using the <code class="highlighter-rouge">--compare</code> option.</p>

<p>Suggestions and <a href="https://github.com/presidentbeef/brakeman-site">pull requests</a> for improving the documention are welcome!</p>

<h3 id="report-check-errors">Report Check Errors</h3>

<p>Previously, errors encounted while running checks were not included in reports. This has been fixed.</p>

<h3 id="better-rails-3-route-processing">Better Rails 3 Route Processing</h3>

<p>Even the simple information Brakeman uses (which methods are routes) is difficult to extract from Rails 3 routes due to all the different options it offers. This release should decrease the number of “Error while processing routes” messages that come up.</p>

<p>See <a href="https://github.com/presidentbeef/brakeman/pull/116">this pull request</a> for more information about specific fixes.</p>

<h3 id="improved-file-access-check">Improved File Access Check</h3>

<p>The check for user input in file access calls has been improved so the confidence of the warnings will vary according to how the user input is used, like most other checks.</p>

<p>Additionally, the check will now respect the <code class="highlighter-rouge">--report-direct</code> option.</p>

<h3 id="no-sqli-warnings-for-non-activemodel">No SQLi Warnings for Non-ActiveModel</h3>

<p>Models which do not inherit from <code class="highlighter-rouge">ActiveRecord::Base</code> will no longer be reported in SQL injection warnings.</p>

<h3 id="default-assignment-to-params">Default Assignment to <code class="highlighter-rouge">params</code></h3>

<p>Normally, when Brakeman processes an assignment like <code class="highlighter-rouge">x ||= y</code>, it will assign <code class="highlighter-rouge">y</code> to <code class="highlighter-rouge">x</code> if no previous value is found for <code class="highlighter-rouge">x</code>.</p>

<p>However, in this case:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>params[:x] ||= y
</code></pre></div></div>

<p>The information that the left hand side is a <code class="highlighter-rouge">params</code> hash is lost.</p>

<p>This has been changed so default assignment to a <code class="highlighter-rouge">params</code> hash will not replace the entire value, but will handle it as <code class="highlighter-rouge">params[:x] || y</code>.</p>

<h3 id="user-input-in-or-expressions">User Input in <code class="highlighter-rouge">or</code> Expressions</h3>

<p>Previously, unescaped output like</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= params[:x] || z %&gt;
</code></pre></div></div>

<p>would have been reported as a weak confidence warning. This has been changed so that any user input in an <code class="highlighter-rouge">or</code> expression will be considered immediate (versus “indirect”) output and will likely result in high confidence warnings.</p>

<h3 id="speed-improvements">Speed Improvements</h3>

<p>Scan times should decrease by 15-25% with this release. This is mostly due to stripping unused bits out of SexpProcessor.</p>

<h3 id="bug-fixes">Bug Fixes</h3>

<p>Besides errors raised when processing Rails 3 routes, the <code class="highlighter-rouge">Result must be a Sexp, was Symbol::array</code> and <code class="highlighter-rouge">empty char-class</code> errors should be resolved now.</p>

<p>Please report any errors raised when performing scans, as they are usually bugs.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>


  <article>
    
  <header>
    <div class="articlelogo">&nbsp;</div>
    
    <h1 class="entry-title"><a href="/blog/2012/06/12/brakeman-1-dot-6-2-released">Brakeman 1.6.2 Released</a></h1>
    
    
      <p class="meta">




<time datetime="2012-06-12 17:07:00 -0700" pubdate  updated >2012-06-12 17:07:00 -0700</time>


</p>
    
  </header>


  <div class="entry-content"><p>Besides checks for the latest CVEs, this release includes a slightly improved redirect check, noiser output with <code class="highlighter-rouge">--compare</code>, and better handling of <code class="highlighter-rouge">before_filter</code>.</p>

<p><em>Changes since 1.6.1</em>:</p>

<ul>
  <li>Add checks for CVE-2012-2660, CVE-2012-2661, CVE-2012-2694, CVE-2012-2695 (Dave Worth)</li>
  <li>Avoid warning when redirecting to a model instance</li>
  <li>Raise confidence level for model attributes in redirects</li>
  <li>Add <code class="highlighter-rouge">request.parameters</code> as a parameters hash</li>
  <li>Return non-zero exit code when missing dependencies</li>
  <li>Fix <code class="highlighter-rouge">before_filter :except</code> logic</li>
  <li>Only accept symbol literals as before_filter names</li>
  <li>Cache before_filter lookups</li>
  <li>Turn off quiet mode by default for <code class="highlighter-rouge">--compare</code></li>
</ul>

<h3 id="latest-cves">Latest CVEs</h3>

<p>A number of Rails vulnerabilities were announced recently, although there are really only two issues.</p>

<p>One issue is that query parameters like <code class="highlighter-rouge">?name[]</code> and <code class="highlighter-rouge">?name[]=1&amp;name[]</code> get converted to <code class="highlighter-rouge">{"name" =&gt; [nil]}</code> and <code class="highlighter-rouge">{"name" =&gt; ["1", nil]}</code>. This, in turn, causes ActiveRecord to produce SQL queries with either <code class="highlighter-rouge">IS NULL</code> or <code class="highlighter-rouge">IN ('1', NULL)</code>. This is probably unexpected behavior.</p>

<p>The other issue is that query parameters like <code class="highlighter-rouge">?name[users.id]=1</code> or <code class="highlighter-rouge">?name[users][id]=1</code> get converted to <code class="highlighter-rouge">{"name" =&gt; { "users.id" =&gt; 1 }}</code> or <code class="highlighter-rouge">{"name" =&gt; { "users" =&gt; { "id" =&gt; 1 }}}</code>. ActiveRecord interprets <code class="highlighter-rouge">"users.id"</code> and <code class="highlighter-rouge">"users" =&gt; { "id" ...}</code> as <code class="highlighter-rouge">"users"."id"</code> in the WHERE clause, allowing an attacker to control the table/columns being queried.</p>

<p>Updated versions for Rails 3.x have been released.</p>

<p>For Rails 2.3, I believe <a href="https://github.com/presidentbeef/rails/pull/1/files">these changes</a> will fix the first issue, and there is another <a href="https://rubyonrails-security.googlegroups.com/attach/aee3413fb038bf56/2-3-sql-injection.patch?view=1&amp;part=3">patch available</a> for the second issue.</p>

<p>Older versions of Rails 2.x may be vulnerable to the “NULL” issue, but not to the nested hashes problem.</p>

<h3 id="unprotected-redirect-check">Unprotected Redirect Check</h3>

<p>There have been some minor changes to <code class="highlighter-rouge">CheckRedirect</code>. In most cases, it should no longer warn when redirecting to a model instance. If there are still false positives with this scenario, please report them.</p>

<p>The other change is that redirects to model attributes will now be marked as high confidence, instead of weak.</p>

<h3 id="exit-code-on-missing-dependencies">Exit Code on Missing Dependencies</h3>

<p>Brakeman catches errors from missing dependencies in order to show a nicer error message. Unfortunately, it was also returning <code class="highlighter-rouge">0</code> on exit. This is undesirable behavior when chaining commands together.</p>

<p>This has been changed to return a non-zero exit code.</p>

<h3 id="before-filter-changes">Before Filter Changes</h3>

<p>There were some isues with how <code class="highlighter-rouge">before_filter</code> was being handled. The logic when using <code class="highlighter-rouge">:except</code> was broken, causing Brakeman to treat it like <code class="highlighter-rouge">:only</code>.</p>

<p>The other issue caused Brakeman to interpret arguments such as method calls as method names. For example, <code class="highlighter-rouge">before_filter blah</code> would be treated like <code class="highlighter-rouge">before_filter :blah</code>.</p>

<p>While dealing with this, caching of filter lookups was also added for a minor performance improvement.</p>

<h3 id="noisier---compare">Noisier <code class="highlighter-rouge">--compare</code></h3>

<p>Using the <code class="highlighter-rouge">--compare</code> option now shows the same output as a regular scan. If you are piping the output of <code class="highlighter-rouge">--compare</code> to a file or elsewhere, you may wish to use the <code class="highlighter-rouge">--quiet</code> option.</p>

<h3 id="report-issues">Report Issues</h3>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release!</p>

<p>Also consider joining the <a href="http://brakemanscanner.org/contact/">mailing list</a> or following <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter.</p>
</div>
  
  


  </article>

<nav role="pagination">
  <div>
    <a href="/blog/archives">Blog Archives</a>
  </div>
</nav>

</div>
<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
<script type='text/javascript'>
    $(document).ready(function(){
        $("#github").GitHubBadge({
          login: "presidentbeef",
          kind: "project",
          repo_name: "brakeman",
          include_github_logo: false,
          image_path: "",
          commit_count: "1",
          issue_count: "0",
          repo_count: "0"
      });
    });
</script>
<div id="github"></div>
<a href="https://travis-ci.org/#!/presidentbeef/brakeman"><img src="https://secure.travis-ci.org/presidentbeef/brakeman.png" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">Brakeman 5.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2022/01/30/5-dot-2-dot-1-released">Brakeman 5.2.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/12/15/brakeman-5-dot-2-dot-0-released">Brakeman 5.2.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/10/28/brakeman-5-dot-1-dot-2-released">Brakeman 5.1.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2021/07/19/brakeman-5-dot-1-dot-0-released">Brakeman 5.1.0 Released</a>
      </li>
    
  </ul>
</section>

  <section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <a class="twitter-timeline" data-dnt=true href="https://twitter.com/brakeman" data-widget-id="258654953097273345">Tweets by @brakeman</a>
    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
  </ul>
</section>

</aside>

    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
