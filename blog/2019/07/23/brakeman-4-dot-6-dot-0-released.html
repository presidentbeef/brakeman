
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Brakeman: Brakeman 4.6.0 Released</title>
  <meta name="description" content="Brakeman is a static analysis security vulnerability scanner for Ruby on Rails applications."/>

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta name="keywords" content="brakeman,ruby on rails,security,scanner,vulnerabilities,static analysis"/>

  <link rel="canonical" href="https://brakemanscanner.org/blog/2019/07/23/brakeman-4-dot-6-dot-0-released"/>
  <link href="/favicon.png" rel="shortcut icon" />
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="feed.xml" rel="alternate" title="Brakeman" type="application/atom+xml"/>
  

  

  <!--Fonts from Google's Web font directory at http://google.com/webfonts -->
<link href='https://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<link href='https://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic' rel='stylesheet' type='text/css'>
<script language="javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.3/jquery.min.js" type="text/javascript"></script>
<script src="/javascripts/jquery.github_badge.js"></script>
<meta property="twitter:account_id" content="23978537" />

<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@brakeman" />
<meta name="twitter:title" content="Brakeman - Brakeman 4.6.0 Released" />
<meta name="twitter:description" content="Brakeman Static Analysis Security Scanner for Ruby on Rails" />
<meta name="twitter:image" content="https://brakemanscanner.org/images/brakeman_logo_dark.png" />

</head>

<body  >
  <header><hgroup>
  <h1><a href="/">Brakeman</a></h1>
  
    <h2>Ruby on Rails Static Analysis Security Tool</h2>
  
</hgroup>

</header>
  <nav role=navigation><ul role=subscription data-subscription="rss">
  <li><a href="feed.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
<form action="" method="get">
  <fieldset role="site-search">
    <input type="hidden" name="q" value="site:https://brakemanscanner.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
<ul role=main-navigation>
  <li><a href="/">Home</a></li>
  <li><a href="/docs">Documentation</a></li>
  <li><a href="https://github.com/presidentbeef/brakeman">Source</a></li>
  <li><a href="/docs/contributing">Contributing</a></li>
  <li><a href="/brakeman_users">Users</a></li>
  <li><a href="/contact">Contact</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry">
  
  <header>
    <div class="articlelogo">&nbsp;</div>
    
      <h1 class="entry-title">Brakeman 4.6.0 Released</h1>
    
    
      <p class="meta">




<time datetime="2019-07-23 13:14:00 -0600" pubdate  updated >2019-07-23 13:14:00 -0600</time>


</p>
    
  </header>


<div class="entry-content"><p>This release has two new checks!</p>

<p><em>Changes since 4.5.1:</em></p>

<ul>
  <li>Add check for cookie serialization with Marshal (<a href="https://github.com/presidentbeef/brakeman/issues/1316">#1316</a>)</li>
  <li>Add reverse tabnabbing check (<a href="https://github.com/linosgian">Linos Giannopoulos</a>)</li>
  <li>Avoid warning about file access with <code class="language-plaintext highlighter-rouge">ActiveStorage::Filename#sanitized</code> (<a href="https://github.com/tejasbubane">Tejas Bubane</a>)</li>
  <li>Update loofah version for fixing <a href="https://nvd.nist.gov/vuln/detail/CVE-2018-8048">CVE-2018-8048</a> (<a href="https://github.com/MartyBeGood">Markus Nölle</a>)</li>
  <li>Warn people that Haml 5 is not fully supported (<a href="https://github.com/jaredbeck">Jared Beck</a>)</li>
  <li>Index calls in initializers</li>
  <li>Improve template output handling in conditional branches</li>
  <li>Avoid assigning <code class="language-plaintext highlighter-rouge">nil</code> line numbers to <code class="language-plaintext highlighter-rouge">Sexp</code>s</li>
  <li>Add special warning code for custom checks</li>
  <li>Add call matching by regular expression</li>
  <li>Skip calls to <code class="language-plaintext highlighter-rouge">dup</code> (<a href="https://github.com/presidentbeef/brakeman/issues/1374">#1374</a>)</li>
  <li>Restore <code class="language-plaintext highlighter-rouge">Warning#relative_path</code></li>
  <li>Better handling of gems with no version declared</li>
</ul>

<h3 id="cookie-serialization-check">Cookie Serialization Check</h3>

<p>Brakeman will now warn if <code class="language-plaintext highlighter-rouge">Rails.application.config.action_dispatch.cookies_serializer</code> is set to <code class="language-plaintext highlighter-rouge">:marshal</code> or <code class="language-plaintext highlighter-rouge">:json</code>.</p>

<p>This options allow cookies to be deserialized via <code class="language-plaintext highlighter-rouge">Marshal</code>. If an attacker is able to construct a valid encrypted cookie, this could lead to arbitrary code execution.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1364">changes</a>)</p>

<h3 id="reverse-tabnabbing-check">Reverse Tabnabbing Check</h3>

<p><a href="https://github.com/linosgian">Linos Giannopoulos</a> has added an optional check for cases of “reverse tabnabbing”. This occurs when a link is opened in a new window/tab via a link (with <code class="language-plaintext highlighter-rouge">target: '_blank'</code>).
The new window can control the location of the old window. If an attacker controls the new window, they can redirect the old window to a malicious site. This is especially useful for 
phishing attacks. These kinds of attacks are most likely on applications that allow arbitrary links to external sites.</p>

<p>To completely remove the ability of an attacker to control the old window, add <code class="language-plaintext highlighter-rouge">rel: "noreferrer noopener"</code> to the <code class="language-plaintext highlighter-rouge">link_to</code> call. Note: this will cause the new window to lose referrer information.</p>

<p>To enable this new check, use <code class="language-plaintext highlighter-rouge">--enable ReverseTabnabbing</code> or <code class="language-plaintext highlighter-rouge">-A</code> to enable all optional checks.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1367">changes</a>)</p>

<h3 id="file-access-false-positive">File Access False Positive</h3>

<p><a href="https://github.com/tejasbubane">Tejas Bubane</a> provided a fix to ignore use of <code class="language-plaintext highlighter-rouge">ActiveStorage::Filename#sanitized</code> inside file access calls.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1375">changes</a>)</p>

<h3 id="fixed-loofah-version">Fixed Loofah Version</h3>

<p><a href="https://github.com/MartyBeGood">Markus Nölle</a> corrected the “fixed” version of Loofah for CVE-2018-8048 from <code class="language-plaintext highlighter-rouge">2.1.2</code> to <code class="language-plaintext highlighter-rouge">2.2.1</code>. Oops!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1371">changes</a>)</p>

<h3 id="haml-5-support">Haml 5 Support</h3>

<p><a href="https://github.com/jaredbeck">Jared Beck</a> added a notification when Haml 5 is in use by an application. At the moment, Brakeman does not support Haml 5.x.
There appear to be only a few syntax differences between Haml 4.x and 5.x, so most users are unaffected.</p>

<p>Support is planned for a future release.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1379">changes</a>)</p>

<h3 id="initializers-more-fully-supported">Initializers More Fully Supported</h3>

<p>When Brakeman scans an application, <a href="https://blog.presidentbeef.com/blog/2012/11/28/faster-call-indexing-in-brakeman-1-dot-8-3/">it “indexes” all method calls of interest</a>. Most checks then operated on those indexed calls.</p>

<p>However, for historical reasons, initializers (files in <code class="language-plaintext highlighter-rouge">config/initializers/</code>) were not included in that index.</p>

<p>Now they are! Besides some modest speed gains and simpler/more consistent checks, now regular old checks can “see” initializers.
This may result in previously-unreported warnings now popping up in initializers.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1363">changes</a>)</p>

<h3 id="conditional-branches-in-templates">Conditional Branches in Templates</h3>

<p>Very obvious code like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;%= blah ? x : params[:x].html_safe %&gt;
</code></pre></div></div>

<p>Was not being handled correctly and the cross-site scripting issue would not be reported. This is now fixed!</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1361">changes</a>)</p>

<h3 id="empty-line-numbers">Empty Line Numbers</h3>

<p><a href="https://github.com/seattlerb/sexp_processor/commit/ce284487f057203360c41b14d2b25f8c5453fbb9">A change in <code class="language-plaintext highlighter-rouge">sexp_processor</code></a> causes it to raise an exception if an <code class="language-plaintext highlighter-rouge">Sexp</code> is assigned a <code class="language-plaintext highlighter-rouge">nil</code> line.
Brakeman was a bit cavalier when assigning line numbers, so this caused an issue for some users.</p>

<p>As a result, line numbers should be assigned a bit more consistently now.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1360">changes</a>)</p>

<h3 id="custom-check-warning-code">Custom Check Warning Code</h3>

<p>Every warning reported by Brakeman refers to an integer “warning code”. This is so the “warning type” or category can be a bit more flexible if we want to change the name or formatting.
However, this list of warning codes is hardcoded into Brakeman. The hardcoding makes it hard for users to add their own checks, because they need to either use an existing code or monkey-patch in a new one.</p>

<p>To help with this situation, custom checks/rules can now use the <code class="language-plaintext highlighter-rouge">:custom_check</code> warning code.</p>

<p><a href="https://github.com/presidentbeef/brakeman/wiki/Creating-Custom-Brakeman-Rules">A tutorial on writing custom checks is in progress</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1377">changes</a>)</p>

<h3 id="call-matching-via-regex">Call Matching via Regex</h3>

<p>It is now possible to search for call targets by regular expression, although it is discouraged for performance reasons.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1358">changes</a>)</p>

<h3 id="dup-calls">Dup Calls</h3>

<p>Brakeman now skips calls to <code class="language-plaintext highlighter-rouge">#dup</code> as if they aren’t there.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1386">changes</a>)</p>

<h3 id="warningrelative_path"><code class="language-plaintext highlighter-rouge">Warning#relative_path</code></h3>

<p><code class="language-plaintext highlighter-rouge">Warning#relative_path</code> has been added back for dependencies that might need it, such as <a href="https://github.com/guard/guard-brakeman/pull/36/">guard-brakeman</a>.</p>

<p>(<a href="https://github.com/presidentbeef/brakeman/pull/1365">changes</a>)</p>

<h3 id="checksums">Checksums</h3>

<p>The SHA256 sums for this release are:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>48be7f5a8d814ad42bbb9a2222a331e59a8ece9b50103d8e809a0bbc9d128ef9  brakeman-4.6.0.gem
ff81f5d6fb258a1b83c78ba4144163d1183bd9f31536782722617e880ff85917  brakeman-lib-4.6.0.gem
ef3ad0f59dc32630b1e39f289257cf33a882f2838f455e6009c0cb973ee1d378  brakeman-min-4.6.0.gem
</code></pre></div></div>

<h3 id="reporting-issues">Reporting Issues</h3>

<p>Thank you to everyone who reported bugs and contributed to this release!</p>

<p>Please report any <a href="https://github.com/presidentbeef/brakeman/issues">issues</a> with this release. Take a look at <a href="https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue">this guide</a> to reporting Brakeman problems.</p>

<p>Follow <a href="https://twitter.com/brakeman">@brakeman</a> on Twitter and hang out <a href="https://gitter.im/presidentbeef/brakeman">on Gitter</a> for questions and discussion.</p>

</div>


  <footer>
    <p class="meta">
      


      




<time datetime="2019-07-23 13:14:00 -0600" pubdate  updated >2019-07-23 13:14:00 -0600</time>



      


    </p>
    
      <div class="sharing">
  
  
</div>

    
  </footer>
</article>

</div>

<aside role=sidebar>
  <section>
  <p></p>
  <p>Brakeman is a free vulnerability scanner specifically designed for Ruby on Rails applications. It statically analyzes Rails application code to find security issues at any stage of development.</p>
  <p><a href="/docs/quickstart">Get started!</a></p>
</section>

  <section>
  <script type='text/javascript'>
    $(document).ready(function(){
      $("#github").GitHubBadge({
        login: "presidentbeef",
        kind: "project",
        repo_name: "brakeman",
        include_github_logo: false,
        image_path: "",
        commit_count: "1",
        issue_count: "0",
        repo_count: "0"
      });
    });
  </script>
  <div id="github"></div>
  <a href="https://dl.circleci.com/status-badge/redirect/gh/presidentbeef/brakeman/tree/main"><img src="https://dl.circleci.com/status-badge/img/gh/presidentbeef/brakeman/tree/main.svg?style=svg" /></a>
</section>

  <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2025/04/04/brakeman-7-dot-0-dot-2-released">Brakeman 7.0.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2025/04/03/brakeman-7-dot-0-dot-1-released">Brakeman 7.0.1 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/12/30/brakeman-7-dot-0-dot-0-released">Brakeman 7.0.0 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/10/18/brakeman-6-dot-2-dot-2-released">Brakeman 6.2.2 Released</a>
      </li>
    
      <li class="post">
        <a href="/blog/2024/08/22/brakeman-6-dot-2-released">Brakeman 6.2.1 Released</a>
      </li>
    
  </ul>
</section>

</aside>


    </div>
  </div>
  <footer><p>
<span class="credit">Powered by <a href="http://octopress.org">Octopress</a> | <a href="/content_license">Content license</a></span>
</p>

</footer>
</body>
</html>
