<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.3">Jekyll</generator><link href="https://brakemanscanner.org/feed.xml" rel="self" type="application/atom+xml" /><link href="https://brakemanscanner.org/" rel="alternate" type="text/html" /><updated>2024-01-03T16:50:39-08:00</updated><id>https://brakemanscanner.org/feed.xml</id><title type="html">Brakeman</title><entry><title type="html">Brakeman 6.1.0 Released</title><link href="https://brakemanscanner.org/blog/2023/12/04/brakeman-6-dot-1-dot-0-released" rel="alternate" type="text/html" title="Brakeman 6.1.0 Released" /><published>2023-12-04T22:30:00-08:00</published><updated>2023-12-04T22:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2023/12/04/brakeman-6-dot-1-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2023/12/04/brakeman-6-dot-1-dot-0-released">&lt;p&gt;It’s been a while!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 6.0.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add check for unfiltered search with Ransack&lt;/li&gt;
  &lt;li&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--timing&lt;/code&gt; to add timing duration for scan steps&lt;/li&gt;
  &lt;li&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;PG::Connection.escape_string&lt;/code&gt; as a SQL sanitization method (&lt;a href=&quot;https://github.com/joevin-slq-docto&quot;&gt;Joévin Soulenq&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Handle &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; self&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Fix class method lookup in parent classes&lt;/li&gt;
  &lt;li&gt;Fix keyword splats in filter arguments&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ransack-searches&quot;&gt;Ransack Searches&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://activerecord-hackery.github.io/ransack/&quot;&gt;Ransack&lt;/a&gt; is a popular library for enabling search against ActiveRecord attributes.&lt;/p&gt;

&lt;p&gt;It was originally intended for administrative interfaces (like those provided by ActiveAdmin).&lt;/p&gt;

&lt;p&gt;Use usually looks like&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Car&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;ransack&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:q&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And a url might look like&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;example.com?q[make_start]=vol
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This might generate a query like&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;cars&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;LIKE&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;vol%&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The library does clever things with the query parameter key.
In this case, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;make&lt;/code&gt; is the column and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;start&lt;/code&gt; means match values that start with the search term
passed in.&lt;/p&gt;

&lt;p&gt;However, it’s also possible to specify columns on related tables, such as&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;example.com?q[owner_name_start]=just
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which would search the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;name&lt;/code&gt; column on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;owners&lt;/code&gt; table (assuming &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Car&lt;/code&gt; has an association to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Owner&lt;/code&gt;).&lt;/p&gt;

&lt;p&gt;Prior to Ransack 4.0, the default configuration allowed searching &lt;em&gt;all&lt;/em&gt; columns on a table as
well as &lt;em&gt;all&lt;/em&gt; columns on associated tables.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://positive.security/blog/ransack-data-exfiltration&quot;&gt;Some folks figured out this can be used to extract secret values&lt;/a&gt; by brute-forcing the value one character at a time.&lt;/p&gt;

&lt;p&gt;To fix this issue, explicitly &lt;a href=&quot;https://activerecord-hackery.github.io/ransack/going-further/other-notes/#authorization-allowlistingdenylisting&quot;&gt;allow list the attributes and associations available&lt;/a&gt; to search.&lt;/p&gt;

&lt;p&gt;In Ransack 4.0 and later, it is required to set up an allowlist.&lt;/p&gt;

&lt;p&gt;Brakeman will warn about unrestricted use of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ransack&lt;/code&gt;:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;strong&gt;High&lt;/strong&gt; if no allow-listing methods are found in the class hierarchy of the model on which &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ransack&lt;/code&gt; is called&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Medium&lt;/strong&gt; if the use happens to be in a file with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;admin&lt;/code&gt; in the path&lt;/li&gt;
  &lt;li&gt;&lt;strong&gt;Low&lt;/strong&gt; if the call to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ransack&lt;/code&gt; is not on a class&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1799&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;timing-output&quot;&gt;Timing Output&lt;/h3&gt;

&lt;p&gt;Use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--timing&lt;/code&gt; to output duration of various steps during the scan.&lt;/p&gt;

&lt;p&gt;Useful for debugging slowness.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1801&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;another-sql-escaping-method&quot;&gt;Another SQL Escaping Method&lt;/h3&gt;

&lt;p&gt;Brakeman will not warn about use of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;escape_string&lt;/code&gt; in SQL queries.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1789&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;class-methods&quot;&gt;Class Methods&lt;/h3&gt;

&lt;p&gt;Brakeman will now treat methods defined inside of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;class &amp;lt;&amp;lt; self&lt;/code&gt; as class methods.&lt;/p&gt;

&lt;p&gt;This does mean fingerprints of warnings found inside those methods will change.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1792&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;class-method-lookups&quot;&gt;Class Method Lookups&lt;/h3&gt;

&lt;p&gt;Searching for class method definitions in parent classes will now actually look for class methods, not instance methods.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1796&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;keyword-splats-in-filters&quot;&gt;Keyword Splats in Filters&lt;/h3&gt;

&lt;p&gt;Code like&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;before_action&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;**&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;kwargs&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Will no longer cause an error.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1800&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;0d4066936dd58f0fe757d0ff1ec0744479be9ff06c771be4b581bdf0cb8d7403  brakeman-6.1.0.gem
e7c9e739a43ec719d981e9b401b980c11cbe81a333ccb166965b9264ef413cc8  brakeman-lib-6.1.0.gem
709813eff010c9605dc09b9fcbe60742dd3b9e757ec7131808988a14b83eee23  brakeman-min-6.1.0.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Hang out &lt;a href=&quot;https://github.com/presidentbeef/brakeman/discussions&quot;&gt;on Github&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">It’s been a while!</summary></entry><entry><title type="html">Brakeman 6.0.1 Released</title><link href="https://brakemanscanner.org/blog/2023/07/20/brakeman-6-dot-0-dot-1-released" rel="alternate" type="text/html" title="Brakeman 6.0.1 Released" /><published>2023-07-20T13:30:00-07:00</published><updated>2023-07-20T13:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2023/07/20/brakeman-6-dot-0-dot-1-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2023/07/20/brakeman-6-dot-0-dot-1-released">&lt;p&gt;Very tiny release this time!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 6.0.0:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Accept strings for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;load_defaults&lt;/code&gt; version (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1784&quot;&gt;#1784&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Bundle latest &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;strings-for-load_defaults&quot;&gt;Strings for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;load_defaults&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;While the default for Rails generators and documentation is to use floats for versions, e.g. &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;load_defaults 6.1&lt;/code&gt;, internally it uses strings. It appears quite a few apps also use strings.&lt;/p&gt;

&lt;p&gt;Now Brakeman supports and uses strings.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1785&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;latest-rubyparser&quot;&gt;Latest RubyParser&lt;/h3&gt;

&lt;p&gt;Bundled with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt; 3.20.3, which includes additional support for Ruby 3.2 syntax.&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;39641c63bc247bbdf993a349de90a13e146c464c872191f2adc12555bde591be  brakeman-6.0.1.gem
e029fbd43c97bbb9c084fa4f0e13ee259bf193b79d66ba7ef94fa9496bab62cd  brakeman-lib-6.0.1.gem
ef2ff1234ba2a9e7216a0a047b9df0def8c3b8d162d29853c907238901353a54  brakeman-min-6.0.1.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://github.com/presidentbeef/brakeman/discussions&quot;&gt;on Github&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Very tiny release this time!</summary></entry><entry><title type="html">Brakeman 6.0.0 Released</title><link href="https://brakemanscanner.org/blog/2023/05/24/brakeman-6-dot-0-released" rel="alternate" type="text/html" title="Brakeman 6.0.0 Released" /><published>2023-05-24T15:30:00-07:00</published><updated>2023-05-24T15:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2023/05/24/brakeman-6-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2023/05/24/brakeman-6-dot-0-released">&lt;p&gt;Brakeman 6.0 drops parsing support for Ruby 1.8/1.9, and raises the minimum Ruby version to run Brakeman to 3.0.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.4.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Drop support for Ruby 1.8/1.9 syntax&lt;/li&gt;
  &lt;li&gt;Raise minimum Ruby version to 3.0&lt;/li&gt;
  &lt;li&gt;Add obsolete fingerprints to comparison report (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1758&quot;&gt;#1758&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Warn about missing CSRF protection when defaults are not loaded (&lt;a href=&quot;https://github.com/montdidier&quot;&gt;Chris Kruger&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Fix false positive with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content_tag&lt;/code&gt; in newer Rails (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1778&quot;&gt;#1778&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Scan directories that include the word &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;public&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Fix end-of-life dates for Ruby&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;ruby-parsing-version-support&quot;&gt;Ruby Parsing Version Support&lt;/h3&gt;

&lt;p&gt;This version of Brakeman no longer supports parsing Ruby 1.8/1.9 syntax.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt;, the gem Brakeman depends on for parsing Ruby, dropped support quite a while ago. Brakeman was depending on the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby_parser-legacy&lt;/code&gt; gem for these older versions. But since it has been eight years since Ruby 1.9 has been unmaintained… it is time to let go.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1771&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;minimum-ruby-version&quot;&gt;Minimum Ruby Version&lt;/h3&gt;

&lt;p&gt;The minimum Ruby version to run Brakeman is now 3.0.0.&lt;/p&gt;

&lt;p&gt;Official support for the 2.x line of Ruby has ended, so it is a good time to bump up the minimum requirement and adopt more modern language features.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1771&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;missing-csrf-protection-warning&quot;&gt;Missing CSRF Protection Warning&lt;/h3&gt;

&lt;p&gt;Since Rails 5.2.0, new applications have had cross-site request forgery protection enabled. Brakeman assumed the protection was enabled based on the Rails version. However, this was incorrect.&lt;/p&gt;

&lt;p&gt;Now Brakeman correctly handles the default configuration values.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1776&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;content-tag-attributes&quot;&gt;Content Tag Attributes&lt;/h3&gt;

&lt;p&gt;Brakeman will no longer warn about user input in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;content_tag&lt;/code&gt; attribute names in Rails 6.1.6+&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1779&quot;&gt;changes&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;obsolete-warnings-in-comparison-report&quot;&gt;Obsolete Warnings in Comparison Report&lt;/h3&gt;

&lt;p&gt;When using the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--compare&lt;/code&gt; option, the output JSON will now include an &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;obsolete&lt;/code&gt; key with an array of fingerprints.&lt;/p&gt;

&lt;p&gt;These fingerprints are warnings that are configured to be ignored, but no longer exist.&lt;/p&gt;

&lt;p&gt;Note that the report will include &lt;em&gt;all&lt;/em&gt; fingerprints in the ignore configuration that are not in the current report, even if they were already obsolete.&lt;/p&gt;

&lt;p&gt;This report format matches the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--json&lt;/code&gt; output.&lt;/p&gt;

&lt;p&gt;The report will resemble:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
  &quot;new&quot;: [ ... ],
  &quot;fixed&quot;: [ ... ],
  &quot;obsolete&quot;: [
    &quot;abcdef01234567890ba28050e7faf1d54f218dfa9435c3f65f47cb378c18cf98&quot;
  ]
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1777&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;scan-public-directories&quot;&gt;Scan ‘public’ Directories&lt;/h3&gt;

&lt;p&gt;In the old days, Brakeman tried to scan only the “standard” Rails directories, mostly within &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/app/&lt;/code&gt;. With the 5.0 release, Brakeman was revised to make very few assumptions about what kinds of files live where, instead making decisions based on the content of files rather than their location.&lt;/p&gt;

&lt;p&gt;However, there was a lingering exception. Brakeman would ignore any directories that included &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/public/&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;This exception has been removed.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1774&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;eol-dates-for-ruby&quot;&gt;EOL Dates for Ruby&lt;/h3&gt;

&lt;p&gt;Fixed end-of-life date for Ruby 3.0 and added expected dates for 3.1 and 3.2.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1770&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;6ff908e5bfca4651d909a31f3d3ae5846e33732284860a23aff454761c4145d0  brakeman-6.0.0.gem
9a5e68e34c1cffe73b51952937ed2b4f427afd5d11d4a1c10c61e971253ba505  brakeman-lib-6.0.0.gem
db1d8e2118af4b4701fbe49bf1177ac5c89a6a956ca037fdc0e62eb062e2dbb9  brakeman-min-6.0.0.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://github.com/presidentbeef/brakeman/discussions&quot;&gt;on Github&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Brakeman 6.0 drops parsing support for Ruby 1.8/1.9, and raises the minimum Ruby version to run Brakeman to 3.0.</summary></entry><entry><title type="html">Brakeman 5.4.1 Released</title><link href="https://brakemanscanner.org/blog/2023/02/21/brakeman-5-dot-4-dot-1-released" rel="alternate" type="text/html" title="Brakeman 5.4.1 Released" /><published>2023-02-21T08:30:00-08:00</published><updated>2023-02-21T08:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2023/02/21/brakeman-5-dot-4-dot-1-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2023/02/21/brakeman-5-dot-4-dot-1-released">&lt;p&gt;Several changes in this release are updates to Brakeman’s open redirect check.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.4.0:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add Rails 6.1 and 7.0 default configuration values&lt;/li&gt;
  &lt;li&gt;Support Rails 7 redirect options&lt;/li&gt;
  &lt;li&gt;Add &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;redirect_back&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;redirect_back_or_to&lt;/code&gt; to open redirect check&lt;/li&gt;
  &lt;li&gt;Revise checking for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request.env&lt;/code&gt; to only consider request headers&lt;/li&gt;
  &lt;li&gt;Prevent redirects using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;url_from&lt;/code&gt; being marked as unsafe (&lt;a href=&quot;https://github.com/lsylvester&quot;&gt;Lachlan Sylvester&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Warn about unscoped find for &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find_by(id: ...)&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Support &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;presence&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;presence_in&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;in?&lt;/code&gt; (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1569&quot;&gt;#1569&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Fix issue with &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if&lt;/code&gt; expressions in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;when&lt;/code&gt; clauses (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1743&quot;&gt;#1743&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Fix file/line location for EOL software warnings&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;rails-61-and-rails-70-defaults&quot;&gt;Rails 6.1 and Rails 7.0 Defaults&lt;/h3&gt;

&lt;p&gt;The default configuration values for Rails 6.1 and Rails 7.0 have been added to Brakeman.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1751&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;open-redirect-updates&quot;&gt;Open Redirect Updates&lt;/h3&gt;

&lt;p&gt;Rails 7 introduced a new protection against open directs.&lt;/p&gt;

&lt;p&gt;If &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;config.action_controller.raise_on_open_redirects&lt;/code&gt; is set to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;true&lt;/code&gt;, then Rails prevents redirects that redirect to a different domain than &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;request.host&lt;/code&gt;.
This protection can be bypassed by passing in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;allow_other_host: true&lt;/code&gt; to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;redirect_to&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1755&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lsylvester&quot;&gt;Lachlan Sylvester&lt;/a&gt; pointed out it’s also possible to use &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;url_from&lt;/code&gt; to ensure a URL is for the same host. So &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;redirect_to(url_from(params[:url]))&lt;/code&gt; is safe.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1749&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;This release also expands the open redirect check to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;redirect_back&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;redirect_back_or_to&lt;/code&gt; which have options for a fallback URL.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1756&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;more-unscoped-finds&quot;&gt;More Unscoped Finds&lt;/h3&gt;

&lt;p&gt;Brakeman will now warn about use of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find_by(id: ...)&lt;/code&gt; the same way it would warn about &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find_by_id&lt;/code&gt; for “unscoped finds” (i.e., possible insecure direct object references).&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1748&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;presence-method-support&quot;&gt;Presence Method Support&lt;/h3&gt;

&lt;p&gt;Brakeman now handles &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;presence&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;presence_in&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;in?&lt;/code&gt; methods.&lt;/p&gt;

&lt;p&gt;Since &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;presence_in&lt;/code&gt; and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;in?&lt;/code&gt; are often used for guard clauses, this fixes some false positives.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1747&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;fileline-for-end-of-life-warnings&quot;&gt;File/Line for End-Of-Life Warnings&lt;/h3&gt;

&lt;p&gt;March is nearly here, which means support for Ruby 2.7 is ending!&lt;/p&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://github.com/jburns42891&quot;&gt;Jon Burns&lt;/a&gt; for pointing out Brakeman was reporting the wrong file and/or line number for EOL Ruby warnings.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1761&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;dc664d4b5d01dd81608db02ec9b7c383beb65a3169049df2939c4bbbd4edfb73  brakeman-5.4.1.gem
c1bf7e4cec5bde1d53122b41743343d3e38e4aa30145707b902278dd3b588fd4  brakeman-lib-5.4.1.gem
94d24f3ea881bfc213ead8fbf3568aa37b301272ccbecf383394c9d7d7f43eeb  brakeman-min-5.4.1.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://github.com/presidentbeef/brakeman/discussions&quot;&gt;on Github&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Several changes in this release are updates to Brakeman’s open redirect check.</summary></entry><entry><title type="html">Brakeman 5.4.0 Released</title><link href="https://brakemanscanner.org/blog/2022/11/17/brakeman-5-dot-4-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.4.0 Released" /><published>2022-11-17T21:30:00-08:00</published><updated>2022-11-17T21:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2022/11/17/brakeman-5-dot-4-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/11/17/brakeman-5-dot-4-dot-0-released">&lt;p&gt;Special thanks to &lt;a href=&quot;https://github.com/bdewater&quot;&gt;Bart de Water&lt;/a&gt; and &lt;a href=&quot;https://github.com/tehryanx&quot;&gt;Ryan Cartner&lt;/a&gt; for proposing new rules!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.3.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add check for weak RSA key sizes and padding modes (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1736&quot;&gt;#1736&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add check for absolute paths issue with Pathname (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1721&quot;&gt;#1721&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Handle multiple values and splats in case/when (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1730&quot;&gt;#1730&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Ignore more model methods in redirects (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1723&quot;&gt;#1723&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Fix &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;load_rails_defaults&lt;/code&gt; overwriting settings in the Rails application (&lt;a href=&quot;https://github.com/jamgregory&quot;&gt;James Gregory-Monk&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Use relative paths for CodeClimate report format (&lt;a href=&quot;https://github.com/RubyBrewsday&quot;&gt;Mike Poage&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;check-rsa-key-sizes-and-padding-modes&quot;&gt;Check RSA Key Sizes and Padding Modes&lt;/h3&gt;

&lt;p&gt;Brakeman now warns on:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;RSA key sizes less than 2048 bits&lt;/li&gt;
  &lt;li&gt;Use of padding modes other than OAEP (including &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;none&lt;/code&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1737&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;unexpected-absolute-paths&quot;&gt;Unexpected Absolute Paths&lt;/h3&gt;

&lt;p&gt;When joining paths using &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pathname#join&lt;/code&gt;, any arguments that start with a forward slash (&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;/&lt;/code&gt;) will cause the rest of the path to be relative to that absolute path. This may cause unexpected behavior and deviates from how &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;File.join&lt;/code&gt; works.&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Pathname&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;a&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;join&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;&apos;b&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;/c&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;s1&quot;&gt;&apos;d&apos;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
 &lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;#&amp;lt;Pathname:/c/d&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(There are more &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;Pathname&lt;/code&gt; methods with this issue - to be added in a future release.)&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1733&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;multiple-values-in-whens&quot;&gt;Multiple Values in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;when&lt;/code&gt;s&lt;/h3&gt;

&lt;p&gt;If a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;when&lt;/code&gt; clause contains only ‘safe’ values, Brakeman will treat the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;case&lt;/code&gt; value as safe:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;k&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;when&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;y&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;maybe_dangerous&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;x&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# `x` must be an integer, so not dangerous&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1734&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;ignore-more-redirects&quot;&gt;Ignore More Redirects&lt;/h3&gt;

&lt;p&gt;More model methods are ignored in redirects:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;first!&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;last!&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sole&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;find_by_sole&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1732&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;rails-defaults&quot;&gt;Rails Defaults&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jamgregory&quot;&gt;James Gregory-Monk&lt;/a&gt; fixed how Rails default configuration values are set so overrides were properly handled.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1719&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;bab990760949e999c5d52b297d8badda376754eb296c91abf829def733ed9d51  brakeman-5.4.0.gem
2b5a0cd5845b8c0e1b83e00122654af48b025ac3e6625c9ecbc5535226068416  brakeman-lib-5.4.0.gem
fcbd60456c5db62767d143696e1edf8e4eaee734f2a039903aeca7bb4e6b3dbf  brakeman-min-5.4.0.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://github.com/presidentbeef/brakeman/discussions&quot;&gt;on Github&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Special thanks to Bart de Water and Ryan Cartner for proposing new rules!</summary></entry><entry><title type="html">Brakeman 5.3.0 Released</title><link href="https://brakemanscanner.org/blog/2022/08/09/brakeman-5-dot-3-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.3.0 Released" /><published>2022-08-09T08:30:00-07:00</published><updated>2022-08-09T08:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2022/08/09/brakeman-5-dot-3-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/08/09/brakeman-5-dot-3-dot-0-released">&lt;p&gt;This release adds CWE information to reports - the first JSON report change in a long time!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.2.3:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add CWE information to warnings (&lt;a href=&quot;https://github.com/saghaulor&quot;&gt;Stephen Aghaulor&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Include explicit engine or lib paths in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vendor/&lt;/code&gt; (&lt;a href=&quot;https://github.com/jrafanie&quot;&gt;Joe Rafaniello&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add check for CVE-2022-32209&lt;/li&gt;
  &lt;li&gt;Load rexml as a Brakeman dependency&lt;/li&gt;
  &lt;li&gt;Fix “full call” information propagating unnecessarily&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;cwe-information&quot;&gt;CWE Information&lt;/h3&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://github.com/saghaulor&quot;&gt;Stephen Aghaulor&lt;/a&gt; for taking on the arduous task of adding CWE information
to every Brakeman warning type!&lt;/p&gt;

&lt;p&gt;CWE information is now available in most report formats. In particular, it is a new field for the JSON report.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;w&quot;&gt;    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;warning_type&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Cross-Site Scripting&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;warning_code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;124&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;fingerprint&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;c2cc471a99036432e03d83e893fe748c2b1d5c40a39e776475faf088717af97d&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;check_name&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;SanitizeConfigCve&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;message&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;rails-html-sanitizer 1.4.2 is vulnerable to cross-site scripting when `select` and `style` tags are allowed (CVE-2022-32209)&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;file&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;config/initializers/sanitizers.rb&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;line&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;link&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;https://groups.google.com/g/rubyonrails-security/c/ce9PhUANQ6s/m/S0fJfnkmBAAJ&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;code&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;Rails::Html::SafeListSanitizer.allowed_tags = [&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;select&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;, &lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;style&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\&quot;&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;]&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;render_path&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;location&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;user_input&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;confidence&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;High&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;nl&quot;&gt;&quot;cwe_id&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;79&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
      &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1693&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;explicit-paths-in-vendor-directory&quot;&gt;Explicit Paths in Vendor Directory&lt;/h3&gt;

&lt;p&gt;By default, Brakeman does not scan any code in the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vendor/&lt;/code&gt; directory.&lt;/p&gt;

&lt;p&gt;But it was also ignoring any paths in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vendor/&lt;/code&gt;, even if the user explicitly included them via &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--add-libs-path&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;--add-engines-path&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://github.com/jrafanie&quot;&gt;Joe Rafaniello&lt;/a&gt; this is now changed to respect the explicit additional paths, even if they reside in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;vendor/&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1699&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;cve-2022-32209&quot;&gt;CVE-2022-32209&lt;/h3&gt;

&lt;p&gt;&lt;em&gt;As a reminder, Brakeman does not keep up with every CVE for Rails or other libraries. Use a dependency analysis tool for that!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;A check was added for &lt;a href=&quot;https://hackerone.com/reports/1530898&quot;&gt;CVE-2022-32209&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If the vulnerable configuration is detected, the warning will be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;high&lt;/code&gt; confidence.&lt;/p&gt;

&lt;p&gt;If only the vulnerable version of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rails-html-sanitizer&lt;/code&gt; is detected, the warning will be &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;weak&lt;/code&gt; confidence.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1718&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;4fe584ef37c16e1011a0f2db36ebab540fef403ff8e26afed212e2d7ff5a3176  brakeman-5.3.0.gem
1f5caa0bd05fd8ea5b4f5791371dd0911f96d804612c7be986bab3ed0163a8cf  brakeman-lib-5.3.0.gem
4a4ccef090c4eb5857140c15fa69ff65167f3eb550f7a0ca555012642aafe7e9  brakeman-min-5.3.0.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://github.com/presidentbeef/brakeman/discussions&quot;&gt;on Github&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">This release adds CWE information to reports - the first JSON report change in a long time!</summary></entry><entry><title type="html">Brakeman 5.2.3 Released</title><link href="https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-2-dot-3-released" rel="alternate" type="text/html" title="Brakeman 5.2.3 Released" /><published>2022-05-01T08:30:00-07:00</published><updated>2022-05-01T08:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-2-dot-3-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-2-dot-3-released">&lt;p&gt;&lt;em&gt;Changes since 5.2.2:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fix error with hash shorthand syntax (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1700&quot;&gt;#1700&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Match order of interactive options with help message (&lt;a href=&quot;https://github.com/roryokane&quot;&gt;Rory O’kane&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hash-shorthand-syntax&quot;&gt;Hash Shorthand Syntax&lt;/h3&gt;

&lt;p&gt;Parsing shorthand hash syntax like this was added with RubyParser 3.19:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;thing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;blah&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but Brakeman needed to handle it properly, too.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1701&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;interative-options&quot;&gt;Interative Options&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/roryokane&quot;&gt;Rory O’kane&lt;/a&gt; updated the ordering of options in the help message for interative ignore so
the help message matches the order of the options in the prompt!&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1702&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;5b6efb6a1e5c2b79063553647638e17239d2d2f4d50561230c8b0acaae4728d4  brakeman-5.2.3.gem
3104abc8ac2b6558d9610ede40f4cac2ebc7ae45569876b8e5907b7422c4e3af  brakeman-lib-5.2.3.gem
10d743c930c03ed1d2bea021ade8fac10f1229d02b8f65bf2214f7f09ec7a0ff  brakeman-min-5.2.3.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.2.2:</summary></entry><entry><title type="html">Brakeman 5.2.2 Released</title><link href="https://brakemanscanner.org/blog/2022/04/06/brakeman-5-dot-2-dot-2-released" rel="alternate" type="text/html" title="Brakeman 5.2.2 Released" /><published>2022-04-06T08:30:00-07:00</published><updated>2022-04-06T08:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2022/04/06/brakeman-5-dot-2-dot-2-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">&lt;p&gt;&lt;em&gt;Changes since 5.2.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Respect equality in &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if&lt;/code&gt; conditions (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1683&quot;&gt;#1683&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Update message for unsafe reflection (&lt;a href=&quot;https://github.com/pedropb&quot;&gt;Pedro Baracho&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Handle &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; when joining values (&lt;a href=&quot;https://github.com/Capncavedan&quot;&gt;Dan Buettner&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add additional String methods for SQL injection check (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1669&quot;&gt;#1669&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Update &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt; for Ruby 3.1 support (&lt;a href=&quot;https://github.com/sqbell&quot;&gt;Merek Skubela&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;equality-checks-in-conditions&quot;&gt;Equality Checks in Conditions&lt;/h3&gt;

&lt;p&gt;When Brakeman comes across code like:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# do something with x&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will now assume &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;x&lt;/code&gt; is &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;1&lt;/code&gt; inside of the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;if&lt;/code&gt; branch.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1681&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;unsafe-reflection-messages&quot;&gt;Unsafe Reflection Messages&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/pedropb&quot;&gt;Pedro Baracho&lt;/a&gt; updated the messages for unsafe reflection to be clearer.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1670&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;another-string-joining-fix&quot;&gt;Another String Joining Fix&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/Capncavedan&quot;&gt;Dan Buettner&lt;/a&gt; fixed an exception when a &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;nil&lt;/code&gt; gets into a string joining operation.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1686&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;more-sql-injection&quot;&gt;More SQL Injection&lt;/h3&gt;

&lt;p&gt;When Brakeman checks for SQL injection, there are a number of methods (like &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;to_s&lt;/code&gt; or &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;strip&lt;/code&gt;) that essentially return the string itself.&lt;/p&gt;

&lt;p&gt;This list of methods has been expanded to include &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;chop&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;lstrip&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;rstrip&lt;/code&gt;, &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;scrub&lt;/code&gt;, and &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;tr&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1682&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;update-rubyparser&quot;&gt;Update RubyParser&lt;/h3&gt;

&lt;p&gt;This version of Brakeman includes &lt;a href=&quot;https://www.zenspider.com/releases/2022/03/ruby_parser-version-3-19-0-has-been-released.html&quot;&gt;RubyParser 3.19&lt;/a&gt; which adds support for Ruby 3.1 syntax. Thanks &lt;a href=&quot;https://github.com/sqbell&quot;&gt;Merek Skubela&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1695&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;language-plaintext highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;246c9540f5d90fbde39c95999d319f9706bf79668f66bb35419825c1cbef61ae  brakeman-5.2.2.gem
1b559598d78919c0f6f3a8e8602b86ab35f825810b1d7daf872b7791b452e78b  brakeman-lib-5.2.2.gem
4c34dcc1900bf872254eee2b313b1634ffacc9002fd7d26b8390259318cf6194  brakeman-min-5.2.2.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.2.1:</summary></entry><entry><title type="html">Brakeman 5.2.1 Released</title><link href="https://brakemanscanner.org/blog/2022/01/30/5-dot-2-dot-1-released" rel="alternate" type="text/html" title="Brakeman 5.2.1 Released" /><published>2022-01-30T11:30:00-08:00</published><updated>2022-01-30T11:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2022/01/30/5-dot-2-dot-1-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/01/30/5-dot-2-dot-1-released">&lt;p&gt;Oops! Minor emergency fix release.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.2.0:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add warning codes for EOL Ruby and Rails check&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Oops! Minor emergency fix release.</summary></entry><entry><title type="html">Brakeman 5.2.0 Released</title><link href="https://brakemanscanner.org/blog/2021/12/15/brakeman-5-dot-2-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.2.0 Released" /><published>2021-12-15T11:30:00-08:00</published><updated>2021-12-15T11:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2021/12/15/brakeman-5-dot-2-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/12/15/brakeman-5-dot-2-dot-0-released">&lt;p&gt;&lt;em&gt;Changes since 5.1.2:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Initial Rails 7 support (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1653&quot;&gt;#1653&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add new checks for unsupported Ruby and Rails version&lt;/li&gt;
  &lt;li&gt;Fix issue with calls to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;foo.root&lt;/code&gt; in routes (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1640&quot;&gt;#1640&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Ignore &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I18n.locale&lt;/code&gt; in SQL queries (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1597&quot;&gt;#1597&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Do not treat &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sanitize_sql_like&lt;/code&gt; as safe&lt;/li&gt;
  &lt;li&gt;Bundled version of &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt; updated to 3.18.1&lt;/li&gt;
  &lt;li&gt;Require Ruby 2.5.0+ (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1649&quot;&gt;#1649&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;initial-rails-7-support&quot;&gt;Initial Rails 7 Support&lt;/h3&gt;

&lt;p&gt;Nothing special here, but the &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;-7&lt;/code&gt; option is available and Brakeman won’t think a Rails 7 app is a Rails 2 app.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1654&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;new-checks-for-unmaintained-software&quot;&gt;New Checks for Unmaintained Software&lt;/h3&gt;

&lt;p&gt;Brakeman will now warn about use of Ruby or Rails versions which are no longer maintained.&lt;/p&gt;

&lt;p&gt;Unlike other warnings, these new checks have a time component and &lt;em&gt;will&lt;/em&gt; change as the end-of-life dates approach:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;60 days until EOL: Low warning&lt;/li&gt;
  &lt;li&gt;30 days until EOL: Medium warning&lt;/li&gt;
  &lt;li&gt;EOL+: High warning&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1660&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;bug-fix-in-routes&quot;&gt;Bug Fix in Routes&lt;/h3&gt;

&lt;p&gt;Calls to &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;something.root&lt;/code&gt; will no longer cause Brakeman to freak out.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1655&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;sql-injection-updates&quot;&gt;SQL Injection Updates&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;I18n.locale&lt;/code&gt; is ignored in SQL queries.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1658&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;sanitize_sql_like&lt;/code&gt; is no longer treated as “safe”. It only escapes &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;LIKE&lt;/code&gt;-specific characters such as &lt;code class=&quot;language-plaintext highlighter-rouge&quot;&gt;%&lt;/code&gt; but does not prevent SQL injection.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1657&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.1.2:</summary></entry></feed>