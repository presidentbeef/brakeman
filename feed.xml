<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.4">Jekyll</generator><link href="https://brakemanscanner.org/feed.xml" rel="self" type="application/atom+xml" /><link href="https://brakemanscanner.org/" rel="alternate" type="text/html" /><updated>2022-08-09T17:45:38-07:00</updated><id>https://brakemanscanner.org/feed.xml</id><title type="html">Brakeman</title><entry><title type="html">Brakeman 5.2.3 Released</title><link href="https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-2-dot-3-released" rel="alternate" type="text/html" title="Brakeman 5.2.3 Released" /><published>2022-05-01T08:30:00-07:00</published><updated>2022-05-01T08:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-2-dot-3-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-2-dot-3-released">&lt;p&gt;&lt;em&gt;Changes since 5.2.2:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fix error with hash shorthand syntax (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1700&quot;&gt;#1700&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Match order of interactive options with help message (&lt;a href=&quot;https://github.com/roryokane&quot;&gt;Rory O’kane&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hash-shorthand-syntax&quot;&gt;Hash Shorthand Syntax&lt;/h3&gt;

&lt;p&gt;Parsing shorthand hash syntax like this was added with RubyParser 3.19:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;thing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;blah&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but Brakeman needed to handle it properly, too.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1701&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;interative-options&quot;&gt;Interative Options&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/roryokane&quot;&gt;Rory O’kane&lt;/a&gt; updated the ordering of options in the help message for interative ignore so
the help message matches the order of the options in the prompt!&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1702&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;5b6efb6a1e5c2b79063553647638e17239d2d2f4d50561230c8b0acaae4728d4  brakeman-5.2.3.gem
3104abc8ac2b6558d9610ede40f4cac2ebc7ae45569876b8e5907b7422c4e3af  brakeman-lib-5.2.3.gem
10d743c930c03ed1d2bea021ade8fac10f1229d02b8f65bf2214f7f09ec7a0ff  brakeman-min-5.2.3.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.2.2:</summary></entry><entry><title type="html">Brakeman 5.2.3 Released</title><link href="https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-3-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.2.3 Released" /><published>2022-05-01T08:30:00-07:00</published><updated>2022-05-01T08:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-3-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/05/01/brakeman-5-dot-3-dot-0-released">&lt;p&gt;&lt;em&gt;Changes since 5.2.2:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fix error with hash shorthand syntax (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1700&quot;&gt;#1700&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Match order of interactive options with help message (&lt;a href=&quot;https://github.com/roryokane&quot;&gt;Rory O’kane&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;hash-shorthand-syntax&quot;&gt;Hash Shorthand Syntax&lt;/h3&gt;

&lt;p&gt;Parsing shorthand hash syntax like this was added with RubyParser 3.19:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;thing&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;n&quot;&gt;blah&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;thing&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but Brakeman needed to handle it properly, too.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1701&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;interative-options&quot;&gt;Interative Options&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/roryokane&quot;&gt;Rory O’kane&lt;/a&gt; updated the ordering of options in the help message for interative ignore so
the help message matches the order of the options in the prompt!&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1702&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;5b6efb6a1e5c2b79063553647638e17239d2d2f4d50561230c8b0acaae4728d4  brakeman-5.2.3.gem
3104abc8ac2b6558d9610ede40f4cac2ebc7ae45569876b8e5907b7422c4e3af  brakeman-lib-5.2.3.gem
10d743c930c03ed1d2bea021ade8fac10f1229d02b8f65bf2214f7f09ec7a0ff  brakeman-min-5.2.3.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.2.2:</summary></entry><entry><title type="html">Brakeman 5.2.2 Released</title><link href="https://brakemanscanner.org/blog/2022/04/06/brakeman-5-dot-2-dot-2-released" rel="alternate" type="text/html" title="Brakeman 5.2.2 Released" /><published>2022-04-06T08:30:00-07:00</published><updated>2022-04-06T08:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2022/04/06/brakeman-5-dot-2-dot-2-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/04/06/brakeman-5-dot-2-dot-2-released">&lt;p&gt;&lt;em&gt;Changes since 5.2.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Respect equality in &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; conditions (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1683&quot;&gt;#1683&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Update message for unsafe reflection (&lt;a href=&quot;https://github.com/pedropb&quot;&gt;Pedro Baracho&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Handle &lt;code class=&quot;highlighter-rouge&quot;&gt;nil&lt;/code&gt; when joining values (&lt;a href=&quot;https://github.com/Capncavedan&quot;&gt;Dan Buettner&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add additional String methods for SQL injection check (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1669&quot;&gt;#1669&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Update &lt;code class=&quot;highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt; for Ruby 3.1 support (&lt;a href=&quot;https://github.com/sqbell&quot;&gt;Merek Skubela&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;equality-checks-in-conditions&quot;&gt;Equality Checks in Conditions&lt;/h3&gt;

&lt;p&gt;When Brakeman comes across code like:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;x&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# do something with x&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It will now assume &lt;code class=&quot;highlighter-rouge&quot;&gt;x&lt;/code&gt; is &lt;code class=&quot;highlighter-rouge&quot;&gt;1&lt;/code&gt; inside of the &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; branch.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1681&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;unsafe-reflection-messages&quot;&gt;Unsafe Reflection Messages&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/pedropb&quot;&gt;Pedro Baracho&lt;/a&gt; updated the messages for unsafe reflection to be clearer.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1670&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;another-string-joining-fix&quot;&gt;Another String Joining Fix&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/Capncavedan&quot;&gt;Dan Buettner&lt;/a&gt; fixed an exception when a &lt;code class=&quot;highlighter-rouge&quot;&gt;nil&lt;/code&gt; gets into a string joining operation.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1686&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;more-sql-injection&quot;&gt;More SQL Injection&lt;/h3&gt;

&lt;p&gt;When Brakeman checks for SQL injection, there are a number of methods (like &lt;code class=&quot;highlighter-rouge&quot;&gt;to_s&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;strip&lt;/code&gt;) that essentially return the string itself.&lt;/p&gt;

&lt;p&gt;This list of methods has been expanded to include &lt;code class=&quot;highlighter-rouge&quot;&gt;chop&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;lstrip&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;rstrip&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;scrub&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;tr&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1682&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;update-rubyparser&quot;&gt;Update RubyParser&lt;/h3&gt;

&lt;p&gt;This version of Brakeman includes &lt;a href=&quot;https://www.zenspider.com/releases/2022/03/ruby_parser-version-3-19-0-has-been-released.html&quot;&gt;RubyParser 3.19&lt;/a&gt; which adds support for Ruby 3.1 syntax. Thanks &lt;a href=&quot;https://github.com/sqbell&quot;&gt;Merek Skubela&lt;/a&gt;!&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1695&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;246c9540f5d90fbde39c95999d319f9706bf79668f66bb35419825c1cbef61ae  brakeman-5.2.2.gem
1b559598d78919c0f6f3a8e8602b86ab35f825810b1d7daf872b7791b452e78b  brakeman-lib-5.2.2.gem
4c34dcc1900bf872254eee2b313b1634ffacc9002fd7d26b8390259318cf6194  brakeman-min-5.2.2.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.2.1:</summary></entry><entry><title type="html">Brakeman 5.2.1 Released</title><link href="https://brakemanscanner.org/blog/2022/01/30/5-dot-2-dot-1-released" rel="alternate" type="text/html" title="Brakeman 5.2.1 Released" /><published>2022-01-30T11:30:00-08:00</published><updated>2022-01-30T11:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2022/01/30/5-dot-2-dot-1-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2022/01/30/5-dot-2-dot-1-released">&lt;p&gt;Oops! Minor emergency fix release.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.2.0:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Add warning codes for EOL Ruby and Rails check&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Oops! Minor emergency fix release.</summary></entry><entry><title type="html">Brakeman 5.2.0 Released</title><link href="https://brakemanscanner.org/blog/2021/12/15/brakeman-5-dot-2-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.2.0 Released" /><published>2021-12-15T11:30:00-08:00</published><updated>2021-12-15T11:30:00-08:00</updated><id>https://brakemanscanner.org/blog/2021/12/15/brakeman-5-dot-2-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/12/15/brakeman-5-dot-2-dot-0-released">&lt;p&gt;&lt;em&gt;Changes since 5.1.2:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Initial Rails 7 support (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1653&quot;&gt;#1653&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add new checks for unsupported Ruby and Rails version&lt;/li&gt;
  &lt;li&gt;Fix issue with calls to &lt;code class=&quot;highlighter-rouge&quot;&gt;foo.root&lt;/code&gt; in routes (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1640&quot;&gt;#1640&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Ignore &lt;code class=&quot;highlighter-rouge&quot;&gt;I18n.locale&lt;/code&gt; in SQL queries (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1597&quot;&gt;#1597&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Do not treat &lt;code class=&quot;highlighter-rouge&quot;&gt;sanitize_sql_like&lt;/code&gt; as safe&lt;/li&gt;
  &lt;li&gt;Bundled version of &lt;code class=&quot;highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt; updated to 3.18.1&lt;/li&gt;
  &lt;li&gt;Require Ruby 2.5.0+ (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1649&quot;&gt;#1649&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;initial-rails-7-support&quot;&gt;Initial Rails 7 Support&lt;/h3&gt;

&lt;p&gt;Nothing special here, but the &lt;code class=&quot;highlighter-rouge&quot;&gt;-7&lt;/code&gt; option is available and Brakeman won’t think a Rails 7 app is a Rails 2 app.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1654&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;new-checks-for-unmaintained-software&quot;&gt;New Checks for Unmaintained Software&lt;/h3&gt;

&lt;p&gt;Brakeman will now warn about use of Ruby or Rails versions which are no longer maintained.&lt;/p&gt;

&lt;p&gt;Unlike other warnings, these new checks have a time component and &lt;em&gt;will&lt;/em&gt; change as the end-of-life dates approach:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;60 days until EOL: Low warning&lt;/li&gt;
  &lt;li&gt;30 days until EOL: Medium warning&lt;/li&gt;
  &lt;li&gt;EOL+: High warning&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1660&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;bug-fix-in-routes&quot;&gt;Bug Fix in Routes&lt;/h3&gt;

&lt;p&gt;Calls to &lt;code class=&quot;highlighter-rouge&quot;&gt;something.root&lt;/code&gt; will no longer cause Brakeman to freak out.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1655&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;sql-injection-updates&quot;&gt;SQL Injection Updates&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;I18n.locale&lt;/code&gt; is ignored in SQL queries.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1658&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sanitize_sql_like&lt;/code&gt; is no longer treated as “safe”. It only escapes &lt;code class=&quot;highlighter-rouge&quot;&gt;LIKE&lt;/code&gt;-specific characters such as &lt;code class=&quot;highlighter-rouge&quot;&gt;%&lt;/code&gt; but does not prevent SQL injection.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1657&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Changes since 5.1.2:</summary></entry><entry><title type="html">Brakeman 5.1.2 Released</title><link href="https://brakemanscanner.org/blog/2021/10/28/brakeman-5-dot-1-dot-2-released" rel="alternate" type="text/html" title="Brakeman 5.1.2 Released" /><published>2021-10-28T11:30:00-07:00</published><updated>2021-10-28T11:30:00-07:00</updated><id>https://brakemanscanner.org/blog/2021/10/28/brakeman-5-dot-1-dot-2-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/10/28/brakeman-5-dot-1-dot-2-released">&lt;p&gt;Here’s a small bugfix release with a big parser update!&lt;/p&gt;

&lt;p&gt;Huge thanks as always to &lt;a href=&quot;https://github.com/sponsors/zenspider?o=esb&quot;&gt;Ryan Davis&lt;/a&gt; for maintaining &lt;code class=&quot;highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.1.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Updated &lt;code class=&quot;highlighter-rouge&quot;&gt;ruby_parser&lt;/code&gt; (&lt;a href=&quot;https://www.zenspider.com/&quot;&gt;Ryan Davis&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Fix issue where the previous output is still visible (&lt;a href=&quot;https://github.com/Fryguy&quot;&gt;Jason Frey&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Handle cases where enums are not symbols (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1627&quot;&gt;#1627&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Support newer Haml with &lt;code class=&quot;highlighter-rouge&quot;&gt;::Haml::AttributeBuilder.build&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Fix sorting with &lt;code class=&quot;highlighter-rouge&quot;&gt;nil&lt;/code&gt; line numbers&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;updated-rubyparser&quot;&gt;Updated RubyParser&lt;/h2&gt;

&lt;p&gt;Once again, &lt;a href=&quot;https://github.com/sponsors/zenspider?o=esb&quot;&gt;Ryan Davis&lt;/a&gt; comes through with a great update of &lt;a href=&quot;https://github.com/seattlerb/ruby_parser&quot;&gt;ruby_parser&lt;/a&gt;
including support for newer Ruby 2.7 and 3.0 syntaxes as well as many other fixes and improvements.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://www.zenspider.com/releases/2021/10/ruby_parser-version-3-18-0-has-been-released.html&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;output-cleanup&quot;&gt;Output Cleanup&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/Fryguy&quot;&gt;Jason Frey&lt;/a&gt; cleaned up the &lt;code class=&quot;highlighter-rouge&quot;&gt;Processing libs...&lt;/code&gt; updates so it doesn’t look like &lt;code class=&quot;highlighter-rouge&quot;&gt;Processing libs...ssed&lt;/code&gt; anymore.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1629&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;enums-without-symbols&quot;&gt;Enums Without Symbols&lt;/h2&gt;

&lt;p&gt;Calls to &lt;code class=&quot;highlighter-rouge&quot;&gt;enum&lt;/code&gt; where the first argument is not a symbol will be ignored for now.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1631&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;newer-haml&quot;&gt;Newer Haml&lt;/h2&gt;

&lt;p&gt;In Haml 5.2.2 the &lt;code class=&quot;highlighter-rouge&quot;&gt;::Haml::AttributeBuilder.build&lt;/code&gt; method started popping up and Brakeman was treating it as suspicious.&lt;/p&gt;

&lt;p&gt;For now, ignoring it because it seems pretty safe.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1637&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;sorting-with-missing-line-numbers&quot;&gt;Sorting with Missing Line Numbers&lt;/h2&gt;

&lt;p&gt;In some, apparently rare cases, if two warnings have the same confidence, warning type, and are in the same file, but have &lt;code class=&quot;highlighter-rouge&quot;&gt;nil&lt;/code&gt; line numbers,
then it &lt;em&gt;could&lt;/em&gt; (but doesn’t always) cause a sorting error.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1641&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;d95b1cee8d751db8300c9390d8c90cf3e54f725c4d448f7ccfbdb9a723b6377a  brakeman-5.1.2.gem
8e6a25a4da113269e70a0e536325e8a18b02745f23dea25ecf640c675961961c  brakeman-lib-5.1.2.gem
7b272fa7efc2f25208614bd801993e2b161b4edbf8c423c93b6b13aaee09ae84  brakeman-min-5.1.2.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Here’s a small bugfix release with a big parser update!</summary></entry><entry><title type="html">Brakeman 5.1.0 Released</title><link href="https://brakemanscanner.org/blog/2021/07/19/brakeman-5-dot-1-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.1.0 Released" /><published>2021-07-19T15:00:00-07:00</published><updated>2021-07-19T15:00:00-07:00</updated><id>https://brakemanscanner.org/blog/2021/07/19/brakeman-5-dot-1-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/07/19/brakeman-5-dot-1-dot-0-released">&lt;p&gt;This is a &lt;em&gt;huge&lt;/em&gt; release! (So many changes, I had to look up how to nest lists in Markdown…)&lt;/p&gt;

&lt;p&gt;Thank you to the many contributors!&lt;/p&gt;

&lt;p&gt;There are several new features, take a look below.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.0.4:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Report Formats
    &lt;ul&gt;
      &lt;li&gt;Add GitHub Actions format (&lt;a href=&quot;https://github.com/klausbadelt&quot;&gt;Klaus Badelt&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Add ignored warnings to SARIF report (&lt;a href=&quot;https://github.com/eliblock&quot;&gt;Eli Block&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Fix SARIF report when checks have no description (&lt;a href=&quot;https://github.com/eliblock&quot;&gt;Eli Block&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Adjust copy of &lt;code class=&quot;highlighter-rouge&quot;&gt;--interactive&lt;/code&gt; menu (&lt;a href=&quot;https://github.com/elia&quot;&gt;Elia Schito&lt;/a&gt;)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Performance
    &lt;ul&gt;
      &lt;li&gt;Read and parse files in parallel&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Ruby Interpretation
    &lt;ul&gt;
      &lt;li&gt;Initial support for ActiveRecord enums (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1492&quot;&gt;#1492&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Interprocedural dataflow from very simple class methods&lt;/li&gt;
      &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#fetch&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#fetch&lt;/code&gt; (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1571&quot;&gt;#1571&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#push&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#*&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;Better &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#join&lt;/code&gt; support&lt;/li&gt;
      &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#values&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#values_at&lt;/code&gt;&lt;/li&gt;
      &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#include?&lt;/code&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;SQL Injection
    &lt;ul&gt;
      &lt;li&gt;Update SQL injection check for Rails 6.0/6.1&lt;/li&gt;
      &lt;li&gt;Add &lt;code class=&quot;highlighter-rouge&quot;&gt;--sql-safe-methods&lt;/code&gt; option (&lt;a href=&quot;https://github.com/escheiner&quot;&gt;Esty Scheiner&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Ignore dates in SQL&lt;/li&gt;
      &lt;li&gt;Ignore &lt;code class=&quot;highlighter-rouge&quot;&gt;sanitize_sql_like&lt;/code&gt; in SQL (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1571&quot;&gt;#1571&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Ignore method calls on numbers in SQL (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1571&quot;&gt;#1571&lt;/a&gt;)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Other Fixes
    &lt;ul&gt;
      &lt;li&gt;Ignore renderables in dynamic render path check (&lt;a href=&quot;https://github.com/bradparker&quot;&gt;Brad Parker&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Fix false positive in command injection with &lt;code class=&quot;highlighter-rouge&quot;&gt;Open3.capture&lt;/code&gt; (&lt;a href=&quot;https://github.com/xulaus&quot;&gt;Richard Fitzgerald&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Fix infinite loop on mixin self-includes (&lt;a href=&quot;https://github.com/Skipants&quot;&gt;Andrew Szczepanski&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Check for user-controlled evaluation even if it’s a call target (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1590&quot;&gt;#1590&lt;/a&gt;)&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
  &lt;li&gt;Refactoring
    &lt;ul&gt;
      &lt;li&gt;Refactor &lt;code class=&quot;highlighter-rouge&quot;&gt;cookie?&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;param?&lt;/code&gt; methods (&lt;a href=&quot;https://github.com/kbrock&quot;&gt;Keenan Brock&lt;/a&gt;)&lt;/li&gt;
      &lt;li&gt;Better method definition tracking and lookup&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;report-formats&quot;&gt;Report Formats&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/klausbadelt&quot;&gt;Klaus Badelt&lt;/a&gt; added support for GitHub Actions annotation format with &lt;code class=&quot;highlighter-rouge&quot;&gt;-f github&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1580&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/eliblock&quot;&gt;Eli Block&lt;/a&gt; added support for reporting ignored warnings in SARIF using the “suppressed” property and fixed a SARIF bug.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1620&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/elia&quot;&gt;Elia Schito&lt;/a&gt; clarified some text in the &lt;code class=&quot;highlighter-rouge&quot;&gt;--interactive&lt;/code&gt; menu for ignoring warnings.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1598&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;parallel-file-parsing&quot;&gt;Parallel File Parsing&lt;/h2&gt;

&lt;p&gt;Brakeman now uses the &lt;a href=&quot;https://rubygems.org/gems/parallel&quot;&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;parallel&lt;/code&gt;&lt;/a&gt; gem to read and parse files in parallel.&lt;/p&gt;

&lt;p&gt;By default, &lt;code class=&quot;highlighter-rouge&quot;&gt;parallel&lt;/code&gt; will split the reading/parsing into a number of separate processes based on
number of CPUs.&lt;/p&gt;

&lt;p&gt;In testing, this has dramatically improved speed for large code bases - around 35% reduction in overall scan time.&lt;/p&gt;

&lt;p&gt;However, if you run into weird behavior (e.g. scanning just hangs during file parsing), this feature
can be disabled using &lt;code class=&quot;highlighter-rouge&quot;&gt;--no-threads&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1617&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;ruby-interpretation&quot;&gt;Ruby Interpretation&lt;/h2&gt;

&lt;h3 id=&quot;simple-class-methods&quot;&gt;Simple Class Methods&lt;/h3&gt;

&lt;p&gt;Brakeman will now track and return &lt;em&gt;very simple&lt;/em&gt; literal values (e.g. strings, hashes of literals, arrays of literals) from &lt;em&gt;very simple&lt;/em&gt; class methods (e.g. single line).&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;self&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;path_prefix&lt;/span&gt;
    &lt;span class=&quot;s1&quot;&gt;'/user'&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;path_prefix&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; '/user'&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should help prevent some false positives.&lt;/p&gt;

&lt;h3 id=&quot;enums&quot;&gt;Enums&lt;/h3&gt;

&lt;p&gt;Since &lt;a href=&quot;https://api.rubyonrails.org/v6.1.4/classes/ActiveRecord/Enum.html&quot;&gt;ActiveRecord enums&lt;/a&gt; essentially generate some class (and instance) methods that return fixed literal values, the above class method return values
is also used to support &lt;code class=&quot;highlighter-rouge&quot;&gt;enum&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;User&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ActiveRecord&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;no&quot;&gt;Base&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;enum&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;status: &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:pending&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:active&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:locked&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;no&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;statuses&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:pending&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;c1&quot;&gt;# =&amp;gt; 0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1572&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;hash-and-array-methods&quot;&gt;Hash and Array Methods&lt;/h3&gt;

&lt;p&gt;In some ways, Brakeman is a very poor Ruby interpreter.
To “understand” the code it analyzes, Brakeman essentially evaluates some methods.
This release adds and improves support for evaluating a number of &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Array&lt;/code&gt; methods.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#fetch&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#fetch&lt;/code&gt;
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1589&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#push&lt;/code&gt;
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1600&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#*&lt;/code&gt; and improve &lt;code class=&quot;highlighter-rouge&quot;&gt;Array#join&lt;/code&gt;
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1599&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#values&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#values_at&lt;/code&gt;
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1595&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Support &lt;code class=&quot;highlighter-rouge&quot;&gt;Hash#include?&lt;/code&gt;
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1618/commits/3554a2c7f259b3a96dc69877c9596c81190eed8d&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;sql-injection&quot;&gt;SQL Injection&lt;/h2&gt;

&lt;h3 id=&quot;updates-for-rails-6061&quot;&gt;Updates for Rails 6.0/6.1&lt;/h3&gt;

&lt;p&gt;Some new Rails 6.0 methods were previously added for SQL injection (&lt;code class=&quot;highlighter-rouge&quot;&gt;destroy_by&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;delete_by&lt;/code&gt;), but this release is more thorough.&lt;/p&gt;

&lt;p&gt;Newly vulnerable methods:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;reselect&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rewhere&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;No longer vulnerable:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;delete_all&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;destroy_all&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;pluck&lt;/code&gt; (in Rails 6.1)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Not &lt;em&gt;really&lt;/em&gt; vulnerable:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;order&lt;/code&gt; (in Rails 6.1)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;reorder&lt;/code&gt; (in Rails 6.1)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;(Also, [https://rails-sqli.org/] has also been updated with Rails 6 information!)&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1619&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;safe-methods&quot;&gt;Safe Methods&lt;/h3&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/escheiner&quot;&gt;Esty Scheiner&lt;/a&gt; added the &lt;code class=&quot;highlighter-rouge&quot;&gt;--sql-safe-methods&lt;/code&gt; option to ignore some methods when checking for SQL injection.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1601&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;false-positives&quot;&gt;False Positives&lt;/h3&gt;

&lt;p&gt;Brakeman no longer warns about SQL injection for:&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Dates and methods called on dates
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1615&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Method calls on number literals
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1586&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;sanitize_sql_like&lt;/code&gt;
(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1587&quot;&gt;changes&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;misc-fixes&quot;&gt;Misc Fixes&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/bradparker&quot;&gt;Brad Parker&lt;/a&gt; updated the dynamic render path check to ignore “renderables”.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1529&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/xulaus&quot;&gt;Richard Fitzgerald&lt;/a&gt; fixed a command injection false positive when using &lt;code class=&quot;highlighter-rouge&quot;&gt;Open3.capture&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1612&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/Skipants&quot;&gt;Andrew Szczepanski&lt;/a&gt; fixed an infinite loop when a mixin appears to include itself.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1611&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;Brakeman will now warn about user-controlled evaluation even if the evaluation is a call target itself.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;params&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:debug&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]).&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;do_something_else&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1592&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;refactoring&quot;&gt;Refactoring&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/kbrock&quot;&gt;Keenan Brock&lt;/a&gt; cleaned up the &lt;code class=&quot;highlighter-rouge&quot;&gt;cookie?&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;param?&lt;/code&gt; utility methods.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1608&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;In support of &lt;code class=&quot;highlighter-rouge&quot;&gt;enum&lt;/code&gt; and simple class methods, Brakeman now has a cleaner way of tracking and looking up method definitions.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1596&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h2 id=&quot;new-and-updated-options&quot;&gt;New and Updated Options&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--sql-safe-methods&lt;/code&gt; can be used to specify methods that should be ignored in the context of SQL injection.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--format github&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;-f github&lt;/code&gt; will output code the annotation format used by GitHub Actions.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--no-threads&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;-n&lt;/code&gt; will disable use of threads (actually forked processes) for reading and parsing files.
(Previously, this method only disabled use of threads when running checks.)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;2cc7a174bc9ebb90161f218ea35905de8d749210f69a0bfda9fba71429dc5047  brakeman-5.1.0.gem
b8182c9fd7d6d116b2b531c5d8fe0bf9c8da14118b755ed00be8de8c4684ad10  brakeman-lib-5.1.0.gem
e38ff386530bc5585e2efd183ba73c08abb740c3b26072662025a3d9395b707a  brakeman-min-5.1.0.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">This is a huge release! (So many changes, I had to look up how to nest lists in Markdown…)</summary></entry><entry><title type="html">Brakeman 5.0.4 Released</title><link href="https://brakemanscanner.org/blog/2021/06/08/brakeman-5-dot-0-dot-4-released" rel="alternate" type="text/html" title="Brakeman 5.0.4 Released" /><published>2021-06-08T10:50:00-07:00</published><updated>2021-06-08T10:50:00-07:00</updated><id>https://brakemanscanner.org/blog/2021/06/08/brakeman-5-dot-0-dot-4-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/06/08/brakeman-5-dot-0-dot-4-released">&lt;p&gt;This is a tiny bugfix release!&lt;/p&gt;

&lt;p&gt;&lt;em&gt;What happened to 5.0.2 and 5.0.3??&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;They were messed up. Sorry. Don’t use them.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.0.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Fix Loofah version check (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1603&quot;&gt;#1603&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;4d1af5c3e65a0c2319396a796bd9a587a13317faff92bd09b74c44ba70aef8b3  brakeman-5.0.4.gem
6b529ae8f1e16aed711759c3b52fc01c60befeb896042de02aaa5aabf5c24cb5  brakeman-lib-5.0.4.gem
5a402076af48fc526211212d70a751c80c27cae535077c1c7a63dadc314efe97  brakeman-min-5.0.4.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">This is a tiny bugfix release!</summary></entry><entry><title type="html">Brakeman 5.0.1 Released</title><link href="https://brakemanscanner.org/blog/2021/04/27/brakeman-5-dot-0-dot-1-released" rel="alternate" type="text/html" title="Brakeman 5.0.1 Released" /><published>2021-04-27T12:00:00-07:00</published><updated>2021-04-27T12:00:00-07:00</updated><id>https://brakemanscanner.org/blog/2021/04/27/brakeman-5-dot-0-dot-1-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/04/27/brakeman-5-dot-0-dot-1-released">&lt;p&gt;Has it really been three months since Brakeman 5.0? Yikes!&lt;/p&gt;

&lt;p&gt;Here’s a small update with some bugfixes before we move on to 5.1.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 5.0.0:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Support loading &lt;code class=&quot;highlighter-rouge&quot;&gt;slim/smart&lt;/code&gt; (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1570&quot;&gt;#1570&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Set more line numbers on Sexps (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1579&quot;&gt;#1579&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Detect &lt;code class=&quot;highlighter-rouge&quot;&gt;::Rails.application.configure&lt;/code&gt; too (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1584&quot;&gt;#1584&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Always ignore &lt;code class=&quot;highlighter-rouge&quot;&gt;slice&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;only&lt;/code&gt; calls for mass assignment&lt;/li&gt;
  &lt;li&gt;Don’t fail if $HOME/$USER are not defined&lt;/li&gt;
  &lt;li&gt;Convert splat array arguments to arguments&lt;/li&gt;
  &lt;li&gt;Bundle unreleased RubyParser changes&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;support-smart-text-in-slim-templates&quot;&gt;Support Smart Text in Slim Templates&lt;/h3&gt;

&lt;p&gt;In order to support “&lt;a href=&quot;https://github.com/slim-template/slim/blob/master/doc/smart.md&quot;&gt;Smart Text&lt;/a&gt;” in Slim templates,
Brakeman will load &lt;code class=&quot;highlighter-rouge&quot;&gt;slim/smart&lt;/code&gt; if &lt;code class=&quot;highlighter-rouge&quot;&gt;slim/smart&lt;/code&gt; is mentioned in the &lt;code class=&quot;highlighter-rouge&quot;&gt;Gemfile&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1582&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;more-line-numbers&quot;&gt;More Line Numbers&lt;/h3&gt;

&lt;p&gt;Setting &lt;code class=&quot;highlighter-rouge&quot;&gt;nil&lt;/code&gt; value for the line number of a Sexp raises an exception.&lt;/p&gt;

&lt;p&gt;This is usually from creating a Sexp without a line number in the first place.&lt;/p&gt;

&lt;p&gt;More instances of this have been fixed in this release.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1581&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;always-ignore-sliceonly-for-mass-assignment&quot;&gt;Always Ignore slice/only for Mass Assignment&lt;/h3&gt;

&lt;p&gt;If &lt;code class=&quot;highlighter-rouge&quot;&gt;slice&lt;/code&gt; or &lt;code class=&quot;highlighter-rouge&quot;&gt;only&lt;/code&gt; are called for arguments to mass assignment (e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;User.new(some_hash.slice(:name, :email))&lt;/code&gt;),
Brakeman will not warn about mass assignment.&lt;/p&gt;

&lt;p&gt;These have been ignored for a while, but a logic error caused Brakeman to sometimes still warn about them.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1565&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;convert-splats-to-arguments&quot;&gt;Convert Splats to Arguments&lt;/h3&gt;

&lt;p&gt;In really obvious cases like&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;some_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Brakeman will convert the arguments to&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;n&quot;&gt;some_call&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;c&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1564&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;4c1b7c7747ecfca11a822a4bab5ad05f13515e195d7d34590d3add215573b431  brakeman-5.0.1.gem
79129c2977936113fc87a9a2e9490b734f088286d0b33ed9ca61cb6587dc18c7  brakeman-lib-5.0.1.gem
549034d7aeb2a5ca8fe299c41b91938d502a89e70a1afa68643ca3c9e5ccaf96  brakeman-min-5.0.1.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">Has it really been three months since Brakeman 5.0? Yikes!</summary></entry><entry><title type="html">Brakeman 5.0.0 Released</title><link href="https://brakemanscanner.org/blog/2021/01/26/brakeman-5-dot-0-dot-0-released" rel="alternate" type="text/html" title="Brakeman 5.0.0 Released" /><published>2021-01-26T12:00:00-08:00</published><updated>2021-01-26T12:00:00-08:00</updated><id>https://brakemanscanner.org/blog/2021/01/26/brakeman-5-dot-0-dot-0-released</id><content type="html" xml:base="https://brakemanscanner.org/blog/2021/01/26/brakeman-5-dot-0-dot-0-released">&lt;p&gt;It has been a long time coming, but it is finally here! Lots of changes in this one…&lt;/p&gt;

&lt;p&gt;Brakeman now scans (almost) all Ruby (and ERB, Haml, Slim) files in an application.
This may have a significant impact on reported warnings and scan times - see below for more information.&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Changes since 4.10.1:&lt;/em&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;Scan (almost) all Ruby files in project&lt;/li&gt;
  &lt;li&gt;Revamp CSV report to a CSV list of warnings&lt;/li&gt;
  &lt;li&gt;Add Sonarqube report format (&lt;a href=&quot;https://github.com/adamnengland&quot;&gt;Adam England&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add check for (more) unsafe method reflection (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1488&quot;&gt;#1488&lt;/a&gt;, &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1507&quot;&gt;#1507&lt;/a&gt;, and &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1508&quot;&gt;#1508&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add check for potential HTTP verb confusion (&lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues/1432&quot;&gt;#1432&lt;/a&gt;)&lt;/li&gt;
  &lt;li&gt;Add &lt;code class=&quot;highlighter-rouge&quot;&gt;--[no-]skip-vendor&lt;/code&gt; option&lt;/li&gt;
  &lt;li&gt;Ignore &lt;code class=&quot;highlighter-rouge&quot;&gt;uuid&lt;/code&gt; as a safe attribute&lt;/li&gt;
  &lt;li&gt;Ignore &lt;code class=&quot;highlighter-rouge&quot;&gt;Tempfile#path&lt;/code&gt; in shell commands&lt;/li&gt;
  &lt;li&gt;Ignore development environment&lt;/li&gt;
  &lt;li&gt;Collapse &lt;code class=&quot;highlighter-rouge&quot;&gt;__send__&lt;/code&gt; calls&lt;/li&gt;
  &lt;li&gt;Set Rails configuration defaults based on &lt;code class=&quot;highlighter-rouge&quot;&gt;load_defaults&lt;/code&gt; version&lt;/li&gt;
  &lt;li&gt;Update Ruby requirement to version 2.4.0&lt;/li&gt;
  &lt;li&gt;Suggest using &lt;code class=&quot;highlighter-rouge&quot;&gt;--force&lt;/code&gt; if no Rails application is detected&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;scan-almost-all-ruby-files&quot;&gt;Scan Almost All Ruby Files&lt;/h3&gt;

&lt;p&gt;Since the beginning, Brakeman has been picky about what directories it searches for files.
In general, Brakeman has looked in ‘normal’ Rails directores like &lt;code class=&quot;highlighter-rouge&quot;&gt;app/controllers/&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;app/models/&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;app/views/&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;lib/&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;config&lt;/code&gt;, etc.
This is because Rails has some default logic based on file paths - like mapping a controller action to a given view.&lt;/p&gt;

&lt;p&gt;But if an application varied from the norm, Brakeman would simply not scan those other directories.
This behavior led to a lot of confusion with folks wondering why Brakeman was not finding certain vulnerabilities.&lt;/p&gt;

&lt;p&gt;Brakeman now attempts to deduce the contents of a file first, then falls back to the path name if necessary.
This has been surprisingly effective.&lt;/p&gt;

&lt;p&gt;However, scanning more files means Brakeman runs slower and may report more false positives because the new files
are harder to reason about and less likely to be exposed as part of the attack surface.&lt;/p&gt;

&lt;p&gt;Brakeman does ignore &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;spec&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;vendor&lt;/code&gt; directories. To scan the &lt;code class=&quot;highlighter-rouge&quot;&gt;vendor&lt;/code&gt; directory as well, use &lt;code class=&quot;highlighter-rouge&quot;&gt;--no-skip-vendor&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Please report any issues!&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1520&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;csv-report-update&quot;&gt;CSV Report Update&lt;/h3&gt;

&lt;p&gt;The CSV report format has been completely changed! Previously, it was meant as an ‘Excel-lite’ format, only really useful for viewing in a spreadsheet program.&lt;/p&gt;

&lt;p&gt;Now it is regular CSV with normalized columns to mostly match the JSON report (except for nested fields).&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1547&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;sonarqube-report-format&quot;&gt;Sonarqube Report Format&lt;/h3&gt;

&lt;p&gt;Thanks to &lt;a href=&quot;https://github.com/adamnengland&quot;&gt;Adam England&lt;/a&gt;, Brakeman now supports the Sonarqube “&lt;a href=&quot;https://docs.sonarqube.org/latest/analysis/generic-issue/&quot;&gt;Generic Issue Import Format&lt;/a&gt;”.&lt;/p&gt;

&lt;p&gt;(And thanks Adam for your patience.)&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1505&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;more-unsafe-method-reflection&quot;&gt;More Unsafe Method Reflection&lt;/h3&gt;

&lt;p&gt;A new check was added for unsafe use of &lt;code class=&quot;highlighter-rouge&quot;&gt;method&lt;/code&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;to_proc&lt;/code&gt;, and &lt;code class=&quot;highlighter-rouge&quot;&gt;tap&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1527&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;http-verb-confusion-check&quot;&gt;HTTP Verb Confusion Check&lt;/h3&gt;

&lt;p&gt;In Rails, &lt;code class=&quot;highlighter-rouge&quot;&gt;HEAD&lt;/code&gt; requests are routed like &lt;code class=&quot;highlighter-rouge&quot;&gt;GET&lt;/code&gt; requests, but &lt;code class=&quot;highlighter-rouge&quot;&gt;request.get?&lt;/code&gt; will be false.&lt;/p&gt;

&lt;p&gt;Some code may assume if &lt;code class=&quot;highlighter-rouge&quot;&gt;request.get?&lt;/code&gt; is false, then &lt;code class=&quot;highlighter-rouge&quot;&gt;request.post?&lt;/code&gt; is true:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;request&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;get?&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Do something benign&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;else&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Do something sensitive because it's a POST&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# but actually it could be a HEAD :(&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Brakeman will warn when an &lt;code class=&quot;highlighter-rouge&quot;&gt;if&lt;/code&gt; expression checks &lt;code class=&quot;highlighter-rouge&quot;&gt;request.get?&lt;/code&gt; but has an &lt;code class=&quot;highlighter-rouge&quot;&gt;else&lt;/code&gt; clause instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;elseif ...&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1524&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;uuids-as-safe-attributes&quot;&gt;UUIDs as Safe Attributes&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;#uuid&lt;/code&gt; will be treated as a safe value, particular in SQL.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1553&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;tempfile-paths-in-shell-commands&quot;&gt;Tempfile Paths in Shell Commands&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Tempfile#path&lt;/code&gt; will be considered as safe value for command injection.&lt;/p&gt;

&lt;p&gt;Also adds support for Tempfiles like:&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Tempfile&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;open&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;'...'&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;file&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# Brakeman knows `file` is a Tempfile&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1544&quot;&gt;changes&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;ignore-development-environment&quot;&gt;Ignore Development Environment&lt;/h3&gt;

&lt;p&gt;Brakeman will ignore code that is guarded like&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;env&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;development?&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# ...whatever code&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This was already true for &lt;code class=&quot;highlighter-rouge&quot;&gt;Rails.env.test?&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1549&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;collapse-__send__-calls&quot;&gt;Collapse &lt;code class=&quot;highlighter-rouge&quot;&gt;__send__&lt;/code&gt; Calls&lt;/h3&gt;

&lt;p&gt;Brakeman will treat&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Blah&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;__send__&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:something&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;as&lt;/p&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Blah&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;something&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;5.0&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This was already true for &lt;code class=&quot;highlighter-rouge&quot;&gt;send&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;try&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1551&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;set-rails-defaults&quot;&gt;Set Rails Defaults&lt;/h3&gt;

&lt;p&gt;Brakeman will set default values for Rails configuration options based on the version argument to &lt;code class=&quot;highlighter-rouge&quot;&gt;config.load_defaults&lt;/code&gt; which is usually called in &lt;code class=&quot;highlighter-rouge&quot;&gt;application.rb&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1532&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;requires-ruby-240&quot;&gt;Requires Ruby 2.4.0&lt;/h3&gt;

&lt;p&gt;The minimal Ruby version for running Brakeman is now 2.4.0 (which is already EOL!)&lt;/p&gt;

&lt;p&gt;Note Brakeman can analyze Ruby syntax from 1.8 to 2.6 (some 2.7+ syntax is not supported yet).&lt;/p&gt;

&lt;p&gt;(&lt;a href=&quot;https://github.com/presidentbeef/brakeman/pull/1515&quot;&gt;changes&lt;/a&gt;)&lt;/p&gt;

&lt;h3 id=&quot;checksums&quot;&gt;Checksums&lt;/h3&gt;

&lt;p&gt;The SHA256 sums for this release are:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;21b91f67cde4cf487df0a4dbf6e54729064c665bb0b4b370b71bac9435b63e4c  brakeman-5.0.0.gem
3641c52448ca1d12423595ca1a874c1362f438cd58196825be648bb797096cb5  brakeman-lib-5.0.0.gem
50bab26fe8fcf8d962baaf5b08b7c178315b7c0e4be07d1b134e8ae00338c908  brakeman-min-5.0.0.gem
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;reporting-issues&quot;&gt;Reporting Issues&lt;/h3&gt;

&lt;p&gt;Thank you to everyone who reported bugs and contributed to this release!&lt;/p&gt;

&lt;p&gt;Please report any &lt;a href=&quot;https://github.com/presidentbeef/brakeman/issues&quot;&gt;issues&lt;/a&gt; with this release. Take a look at &lt;a href=&quot;https://github.com/presidentbeef/brakeman/wiki/How-to-Report-a-Brakeman-Issue&quot;&gt;this guide&lt;/a&gt; to reporting Brakeman problems.&lt;/p&gt;

&lt;p&gt;Follow &lt;a href=&quot;https://twitter.com/brakeman&quot;&gt;@brakeman&lt;/a&gt; on Twitter and hang out &lt;a href=&quot;https://gitter.im/presidentbeef/brakeman&quot;&gt;on Gitter&lt;/a&gt; for questions and discussion.&lt;/p&gt;</content><author><name></name></author><summary type="html">It has been a long time coming, but it is finally here! Lots of changes in this one…</summary></entry></feed>